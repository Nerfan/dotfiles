var Broadcaster={_onlyOnce:function(fn){var onceFn=function(){if(onceFn._broadcasterCalled){return}onceFn._broadcasterCalled=true;fn.apply(window,arguments)};onceFn._broadcasterCalled=false;return onceFn},onMessage:{_listeners:[],_call:function(msg,cb){var result=false;cb=cb||function(){};var sender={url:document.location.href,id:chrome.runtime.id};var args=[msg,sender];if(cb){args.push(cb)}for(var i=0;i!=this._listeners.length;i++){var callres=this._listeners[i].apply(window,args);if(callres===true||cb._broadcasterCalled){result=true}}return result},addListener:function(listener){if(this._listeners.indexOf(listener)!==-1){return}chrome.runtime.onMessage.addListener(listener)},removeListener:function(listener){var index=this._listeners.indexOf(listener);if(index!==-1){return}this._listeners.splice(index,0);chrome.runtime.onMessage.removeListener(listener)}},sendMessage:function(msg,cb){if(cb){cb=this._onlyOnce(cb)}var currentPageCallRes=this.onMessage._call(msg,cb);if(currentPageCallRes&&cb){return}var args=[msg];if(cb){args.push(cb)}chrome.runtime.sendMessage.apply(chrome.runtime,args)}};var fvdSpeedDial={};fvdSpeedDial._debug=true;(function(){var MAX_LOG_RECORDS=300;var MAX_LOG_SIZE=1024*1024;var STORAGE_KEY="_app_log";window.addEventListener("load",function(){fvdSpeedDial.AppLog.startWriteCheckInterval()},false);fvdSpeedDial.AppLog={_logUpdated:false,_log:[],_writeCheckInterval:null,_read:function(){this._log=[];if(localStorage[STORAGE_KEY]){try{this._log=JSON.parse(localStorage[STORAGE_KEY])}catch(ex){}}},getText:function(){return this._log.join("\n")},startWriteCheckInterval:function(){var self=this;this._writeCheckInterval=setInterval(function(){if(self._logUpdated){self._logUpdated=false;self.write()}},1e3)},write:function(){if(this._log.length>MAX_LOG_RECORDS){this._log.splice(0,this._log.length-MAX_LOG_RECORDS)}var logJSON=JSON.stringify(this._log);while(logJSON.length>MAX_LOG_SIZE){this._log.shift();logJSON=JSON.stringify(this._log)}localStorage[STORAGE_KEY]=logJSON},info:function(){var args=Array.prototype.slice.call(arguments);args.unshift("info");this.log.apply(this,args)},err:function(){var args=Array.prototype.slice.call(arguments);args.unshift("err");this.log.apply(this,args)},warn:function(){var args=Array.prototype.slice.call(arguments);args.unshift("warn");this.log.apply(this,args)},log:function(){var args=Array.prototype.slice.call(arguments);var level=args.shift();var logLine=[];logLine.push((new Date).toUTCString());logLine.push("_"+level+"_");for(var i=0;i!=args.length;i++){var elem=args[i];if(typeof elem==="object"){elem=JSON.stringify(elem)}logLine.push(elem)}logLine=logLine.join(" ");this._logUpdated=true;this._log.push(logLine)}};fvdSpeedDial.AppLog._read()})();(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement)cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close();d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)ca(a+"["+e+"]",b[e],c,d);else d(a,b)}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border")for(;g<h;g++)c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0;return d+"px"}d=bz(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;g<h;g++)d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0);return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i)for(d=0,e=i[c].length;d<e;d++)f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function T(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function K(){return!0}function J(){return!1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else d=b}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/gi,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return new Function("return "+b)();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H)return H.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++)g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++)if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var f=0;f<c.length;f++)if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return!c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return!d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return!!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({}),j;for(j in g)i[j]=g[j].fire,i[j+"With"]=g[j].fireWith;i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++)b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g;g||j.resolveWith(j,b)}else j!==a&&j.resolveWith(j,d?[a]:[]);return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent)for(o in{submit:1,change:1,focusin:1})n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p;k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div>"+"<table "+n+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b)return;n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c);g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c])return g.events;k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k])return;if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++)delete d[b[e]];if(!(c?m:f.isEmptyObject)(d))return}}if(!c){delete j[k].data;if(!m(j[k]))return}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++)g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]));f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object")return this.each(function(){f.data(this,a)});d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0))h++,l.add(m);m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,g=this[0];{if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get"in c&&(d=c.get(g,"value"))!==b)return d;d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0)return null;c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j)return b;h.push(b)}}if(j&&!h.length&&i.length)return f(i[g]).val();return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn)return f(a)[c](d);if(typeof a.getAttribute=="undefined")return f.prop(a,c,d);i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set"in h&&i&&(g=h.set(a,d,c))!==b)return g;a.setAttribute(c,""+d);return d}if(h&&"get"in h&&i&&(g=h.get(a,c))!==null)return g;g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++)e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button"))return w.get(a,b);

return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button"))return w.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set"in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get"in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1)a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o)f.event.remove(a,j+b[h],c,d,!0);continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++)s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s));r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered))return;h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h])return;c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j)j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1)return;r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode)r.push([m,s]),n=m;n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++)m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault();c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++)r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r);q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace))c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando])return a;var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;)e=i[--d],a[e]=g[e];a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event))return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d))a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b;return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form"))return!1;f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form"))return!1;f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))});return!1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a)this.on(i,c,d,a[i],g);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=J;else if(!e)return this;g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a)this.off(g,c,a[g]);return this}if(c===!1||typeof c=="function")d=c,c=b;d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b))if(w.length===2&&o.relative[w[0]])j=y(w[0]+w[1],d,f);else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length)b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length)q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}else k=w=[]}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]")if(!u)e.push.apply(e,k);else if(d&&d.nodeType===1)for(t=0;k[t]!=null;t++)k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t]);else for(t=0;k[t]!=null;t++)k[t]&&k[t].nodeType===1&&e.push(j[t]);else s(k,e);l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q)if(g==null)m.error(a);else break;q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=m(b[3],null,null,c);else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],e=b[3];if(c===1&&e===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return s(e.getElementsByTagName(b),f);if(h[2]&&o.find.CLASS&&e.getElementsByClassName)return s(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return s([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return s([],f);if(i.id===h[3])return s([i],f)}try{return s(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p)return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}catch(r){}finally{l||k.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)m[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++)f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h});g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){
return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g)e[g]&&bk(d[g],e[g])}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g)bj(d[g],e[g])}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof(r=k.length)=="number")for(i=0;i<r;i++)bn(k[i]);else bn(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()])continue;c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events)e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return bC(a,b,d);f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS)return bS.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bU,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2)w(-1,z);else throw z}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)ca(g,a[g],c,e);return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch)ch[a](0,1)}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);var d,e,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null)for(b in g)g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b);else g[b=a+".run"]&&g[b].stop&&h(this,g,b);for(b=e.length;b--;)e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1));(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(g=!1);if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;

return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);!function(a){function b(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function c(a,b){var c=d(a,b)?f:e;c(a,b)}var d,e,f;"classList"in document.documentElement?(d=function(a,b){return a.classList.contains(b)},e=function(a,b){a.classList.add(b)},f=function(a,b){a.classList.remove(b)}):(d=function(a,c){return b(c).test(a.className)},e=function(a,b){d(a,b)||(a.className=a.className+" "+b)},f=function(a,c){a.className=a.className.replace(b(c)," ")});var g={hasClass:d,addClass:e,removeClass:f,toggleClass:c,has:d,add:e,remove:f,toggle:c};"function"==typeof define&&define.amd?define("classie/classie",g):a.classie=g}(window),function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;d.getListeners=function(a){var b,c,d=this._getEvents();if("object"==typeof a){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if("object"===c)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],f=c.listener.apply(this,b||[]),(f===this._getOnceReturnValue()||c.once===!0)&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.EventEmitter=a}.call(this),function(a){var b=document.documentElement,c=function(){};b.addEventListener?c=function(a,b,c){a.addEventListener(b,c,!1)}:b.attachEvent&&(c=function(b,c,d){b[c+d]=d.handleEvent?function(){var b=a.event;b.target=b.target||b.srcElement,d.handleEvent.call(d,b)}:function(){var c=a.event;c.target=c.target||c.srcElement,d.call(b,c)},b.attachEvent("on"+c,b[c+d])});var d=function(){};b.removeEventListener?d=function(a,b,c){a.removeEventListener(b,c,!1)}:b.detachEvent&&(d=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c]}catch(d){a[b+c]=void 0}});var e={bind:c,unbind:d};"function"==typeof define&&define.amd?define("eventie/eventie",e):a.eventie=e}(this),function(a){function b(a){if(a){if("string"==typeof d[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b,e=0,f=c.length;f>e;e++)if(b=c[e]+a,"string"==typeof d[b])return b}}var c="Webkit Moz ms Ms O".split(" "),d=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return b}):a.getStyleProperty=b}(window),function(a){function b(a){var b=parseFloat(a),c=-1===a.indexOf("%")&&!isNaN(b);return c&&b}function c(){for(var a={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},b=0,c=g.length;c>b;b++){var d=g[b];a[d]=0}return a}function d(a){function d(a){if("string"==typeof a&&(a=document.querySelector(a)),a&&"object"==typeof a&&a.nodeType){var d=f(a);if("none"===d.display)return c();var i={};i.width=a.offsetWidth,i.height=a.offsetHeight;for(var j=i.isBorderBox=!(!h||!d[h]||"border-box"!==d[h]),k=0,l=g.length;l>k;k++){var m=g[k],n=d[m],o=parseFloat(n);i[m]=isNaN(o)?0:o}var p=i.paddingLeft+i.paddingRight,q=i.paddingTop+i.paddingBottom,r=i.marginLeft+i.marginRight,s=i.marginTop+i.marginBottom,t=i.borderLeftWidth+i.borderRightWidth,u=i.borderTopWidth+i.borderBottomWidth,v=j&&e,w=b(d.width);w!==!1&&(i.width=w+(v?0:p+t));var x=b(d.height);return x!==!1&&(i.height=x+(v?0:q+u)),i.innerWidth=i.width-(p+t),i.innerHeight=i.height-(q+u),i.outerWidth=i.width+r,i.outerHeight=i.height+s,i}}var e,h=a("boxSizing");return function(){if(h){var a=document.createElement("div");a.style.width="200px",a.style.padding="1px 2px 3px 4px",a.style.borderStyle="solid",a.style.borderWidth="1px 2px 3px 4px",a.style[h]="border-box";var c=document.body||document.documentElement;c.appendChild(a);var d=f(a);e=200===b(d.width),c.removeChild(a)}}(),d}var e=document.defaultView,f=e&&e.getComputedStyle?function(a){return e.getComputedStyle(a,null)}:function(a){return a.currentStyle},g=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],d):a.getSize=d(a.getStyleProperty)}(window),function(a){function b(a,b){for(var c in b)a[c]=b[c];return a}function c(){}function d(d,e,g,j,k){function m(a,c){this.element="string"==typeof a?f.querySelector(a):a,this.options=b({},this.options),b(this.options,c),this._create()}function n(){return!1}function o(a,b){a.x=void 0!==b.pageX?b.pageX:b.clientX,a.y=void 0!==b.pageY?b.pageY:b.clientY}function p(a,b,c){return c=c||"round",b?Math[c](a/b)*b:a}var q=j("transform"),r=!!j("perspective");b(m.prototype,e.prototype),m.prototype.options={},m.prototype._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=b({},this.position);var a=h(this.element);"relative"!==a.position&&"absolute"!==a.position&&(this.element.style.position="relative"),this.enable(),this.setHandles()},m.prototype.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles(!0)},m.prototype.bindHandles=function(b){var c;c=a.navigator.pointerEnabled?this.bindPointer:a.navigator.msPointerEnabled?this.bindMSPointer:this.bindMouseTouch,b=void 0===b?!0:!!b;for(var d=0,e=this.handles.length;e>d;d++){var f=this.handles[d];c.call(this,f,b)}},m.prototype.bindPointer=function(a,b){var c=b?"bind":"unbind";g[c](a,"pointerdown",this),a.style.touchAction=b?"none":""},m.prototype.bindMSPointer=function(a,b){var c=b?"bind":"unbind";g[c](a,"MSPointerDown",this),a.style.msTouchAction=b?"none":""},m.prototype.bindMouseTouch=function(a,b){var c=b?"bind":"unbind";g[c](a,"mousedown",this),g[c](a,"touchstart",this),b&&t(a)};var s="attachEvent"in f.documentElement,t=s?function(a){"IMG"===a.nodeName&&(a.ondragstart=n);for(var b=a.querySelectorAll("img"),c=0,d=b.length;d>c;c++){var e=b[c];e.ondragstart=n}}:c;m.prototype._getPosition=function(){var a=h(this.element),b=parseInt(a.left,10),c=parseInt(a.top,10);this.position.x=isNaN(b)?0:b,this.position.y=isNaN(c)?0:c,this._addTransformPosition(a)},m.prototype._addTransformPosition=function(a){if(q){var b=a[q];if(0===b.indexOf("matrix")){var c=b.split(","),d=0===b.indexOf("matrix3d")?12:4,e=parseInt(c[d],10),f=parseInt(c[d+1],10);this.position.x+=e,this.position.y+=f}}},m.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},m.prototype.getTouch=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(d.identifier===this.pointerIdentifier)return d}},m.prototype.onmousedown=function(a){var b=a.button;b&&0!==b&&1!==b||this.dragStart(a,a)},m.prototype.ontouchstart=function(a){this.isDragging||this.dragStart(a,a.changedTouches[0])},m.prototype.onMSPointerDown=m.prototype.onpointerdown=function(a){this.isDragging||this.dragStart(a,a)};var u={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"],MSPointerDown:["MSPointerMove","MSPointerUp","MSPointerCancel"]};m.prototype.dragStart=function(b,c){this.isEnabled&&(b.preventDefault?b.preventDefault():b.returnValue=!1,this.pointerIdentifier=void 0!==c.pointerId?c.pointerId:c.identifier,this._getPosition(),this.measureContainment(),o(this.startPoint,c),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this._bindEvents({events:u[b.type],node:b.preventDefault?a:f}),d.add(this.element,"is-dragging"),this.isDragging=!0,this.emitEvent("dragStart",[this,b,c]),this.animate())},m.prototype._bindEvents=function(a){for(var b=0,c=a.events.length;c>b;b++){var d=a.events[b];g.bind(a.node,d,this)}this._boundEvents=a},m.prototype._unbindEvents=function(){var a=this._boundEvents;if(a&&a.events){for(var b=0,c=a.events.length;c>b;b++){var d=a.events[b];g.unbind(a.node,d,this)}delete this._boundEvents}},m.prototype.measureContainment=function(){var a=this.options.containment;if(a){this.size=k(this.element);var b=this.element.getBoundingClientRect(),c=i(a)?a:"string"==typeof a?f.querySelector(a):this.element.parentNode;this.containerSize=k(c);var d=c.getBoundingClientRect();this.relativeStartPosition={x:b.left-d.left,y:b.top-d.top}}},m.prototype.onmousemove=function(a){this.dragMove(a,a)},m.prototype.onMSPointerMove=m.prototype.onpointermove=function(a){a.pointerId===this.pointerIdentifier&&this.dragMove(a,a)},m.prototype.ontouchmove=function(a){var b=this.getTouch(a.changedTouches);b&&this.dragMove(a,b)},m.prototype.dragMove=function(a,b){o(this.dragPoint,b);var c=this.dragPoint.x-this.startPoint.x,d=this.dragPoint.y-this.startPoint.y,e=this.options.grid,f=e&&e[0],g=e&&e[1];c=p(c,f),d=p(d,g),c=this.containDrag("x",c,f),d=this.containDrag("y",d,g),c="y"===this.options.axis?0:c,d="x"===this.options.axis?0:d,this.position.x=this.startPosition.x+c,this.position.y=this.startPosition.y+d,this.dragPoint.x=c,this.dragPoint.y=d,this.emitEvent("dragMove",[this,a,b])},m.prototype.containDrag=function(a,b,c){if(!this.options.containment)return b;var d="x"===a?"width":"height",e=this.relativeStartPosition[a],f=p(-e,c,"ceil"),g=this.containerSize[d]-e-this.size[d];return g=p(g,c,"floor"),Math.min(g,Math.max(f,b))},m.prototype.onmouseup=function(a){this.dragEnd(a,a)},m.prototype.onMSPointerUp=m.prototype.onpointerup=function(a){a.pointerId===this.pointerIdentifier&&this.dragEnd(a,a)},m.prototype.ontouchend=function(a){var b=this.getTouch(a.changedTouches);b&&this.dragEnd(a,b)},m.prototype.dragEnd=function(a,b){this.isDragging=!1,delete this.pointerIdentifier,q&&(this.element.style[q]="",this.setLeftTop()),this._unbindEvents(),d.remove(this.element,"is-dragging"),this.emitEvent("dragEnd",[this,a,b])},m.prototype.onMSPointerCancel=m.prototype.onpointercancel=function(a){a.pointerId===this.pointerIdentifier&&this.dragEnd(a,a)},m.prototype.ontouchcancel=function(a){var b=this.getTouch(a.changedTouches);this.dragEnd(a,b)},m.prototype.animate=function(){if(this.isDragging){this.positionDrag();var a=this;l(function(){a.animate()})}};var v=r?function(a,b){return"translate3d( "+a+"px, "+b+"px, 0)"}:function(a,b){return"translate( "+a+"px, "+b+"px)"};return m.prototype.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},m.prototype.positionDrag=q?function(){this.element.style[q]=v(this.dragPoint.x,this.dragPoint.y)}:m.prototype.setLeftTop,m.prototype.enable=function(){this.isEnabled=!0},m.prototype.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},m.prototype.destroy=function(){this.disable(),q&&(this.element.style[q]=""),this.element.style.left="",this.element.style.top="",this.element.style.position="",this.bindHandles(!1)},m}for(var e,f=a.document,g=f.defaultView,h=g&&g.getComputedStyle?function(a){return g.getComputedStyle(a,null)}:function(a){return a.currentStyle},i="object"==typeof HTMLElement?function(a){return a instanceof HTMLElement}:function(a){return a&&"object"==typeof a&&1===a.nodeType&&"string"==typeof a.nodeName},j=0,k="webkit moz ms o".split(" "),l=a.requestAnimationFrame,m=a.cancelAnimationFrame,n=0;n<k.length&&(!l||!m);n++)e=k[n],l=l||a[e+"RequestAnimationFrame"],m=m||a[e+"CancelAnimationFrame"]||a[e+"CancelRequestAnimationFrame"];l&&m||(l=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-j)),e=a.setTimeout(function(){b(c+d)},d);return j=c+d,e},m=function(b){a.clearTimeout(b)}),"function"==typeof define&&define.amd?define(["classie/classie","eventEmitter/EventEmitter","eventie/eventie","get-style-property/get-style-property","get-size/get-size"],d):"object"==typeof exports?module.exports=d(require("desandro-classie"),require("wolfy87-eventemitter"),require("eventie"),require("desandro-get-style-property"),require("get-size")):a.Draggabilly=d(a.classie,a.EventEmitter,a.eventie,a.getStyleProperty,a.getSize)}(window);(function(window){var slice=Array.prototype.slice;function noop(){}function defineBridget($){if(!$){return}function addOptionMethod(PluginClass){if(PluginClass.prototype.option){return}PluginClass.prototype.option=function(opts){if(!$.isPlainObject(opts)){return}this.options=$.extend(true,this.options,opts)}}var logError=typeof console==="undefined"?noop:function(message){console.error(message)};function bridge(namespace,PluginClass){$.fn[namespace]=function(options){if(typeof options==="string"){var args=slice.call(arguments,1);for(var i=0,len=this.length;i<len;i++){var elem=this[i];var instance=$.data(elem,namespace);if(!instance){logError("cannot call methods on "+namespace+" prior to initialization; "+"attempted to call '"+options+"'");continue}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+"' for "+namespace+" instance");continue}var returnValue=instance[options].apply(instance,args);if(returnValue!==undefined){return returnValue}}return this}else{return this.each(function(){var instance=$.data(this,namespace);if(instance){instance.option(options);instance._init()}else{instance=new PluginClass(this,options);$.data(this,namespace,instance)}})}}}$.bridget=function(namespace,PluginClass){addOptionMethod(PluginClass);bridge(namespace,PluginClass)};return $.bridget}if(typeof define==="function"&&define.amd){define("jquery-bridget/jquery.bridget",["jquery"],defineBridget)}else if(typeof exports==="object"){defineBridget(require("jquery"))}else{defineBridget(window.jQuery)}})(window);(function(window){function classReg(className){return new RegExp("(^|\\s+)"+className+"(\\s+|$)")}var hasClass,addClass,removeClass;if("classList"in document.documentElement){hasClass=function(elem,c){return elem.classList.contains(c)};addClass=function(elem,c){elem.classList.add(c)};removeClass=function(elem,c){elem.classList.remove(c)}}else{hasClass=function(elem,c){return classReg(c).test(elem.className)};addClass=function(elem,c){if(!hasClass(elem,c)){elem.className=elem.className+" "+c}};removeClass=function(elem,c){elem.className=elem.className.replace(classReg(c)," ")}}function toggleClass(elem,c){var fn=hasClass(elem,c)?removeClass:addClass;fn(elem,c)}var classie={hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,has:hasClass,add:addClass,remove:removeClass,toggle:toggleClass};if(typeof define==="function"&&define.amd){define("classie/classie",classie)}else if(typeof exports==="object"){module.exports=classie}else{window.classie=classie}})(window);(function(window){var prefixes="Webkit Moz ms Ms O".split(" ");var docElemStyle=document.documentElement.style;function getStyleProperty(propName){if(!propName){return}if(typeof docElemStyle[propName]==="string"){return propName}propName=propName.charAt(0).toUpperCase()+propName.slice(1);var prefixed;for(var i=0,len=prefixes.length;i<len;i++){prefixed=prefixes[i]+propName;if(typeof docElemStyle[prefixed]==="string"){return prefixed}}}if(typeof define==="function"&&define.amd){define("get-style-property/get-style-property",[],function(){return getStyleProperty})}else if(typeof exports==="object"){module.exports=getStyleProperty}else{window.getStyleProperty=getStyleProperty}})(window);(function(window,undefined){function getStyleSize(value){var num=parseFloat(value);var isValid=value.indexOf("%")===-1&&!isNaN(num);return isValid&&num}function noop(){}var logError=typeof console==="undefined"?noop:function(message){console.error(message)};var measurements=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];function getZeroSize(){var size={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};for(var i=0,len=measurements.length;i<len;i++){var measurement=measurements[i];size[measurement]=0}return size}function defineGetSize(getStyleProperty){var isSetup=false;var getStyle,boxSizingProp,isBoxSizeOuter;function setup(){if(isSetup){return}isSetup=true;var getComputedStyle=window.getComputedStyle;getStyle=function(){var getStyleFn=getComputedStyle?function(elem){return getComputedStyle(elem,null)}:function(elem){return elem.currentStyle};return function getStyle(elem){var style=getStyleFn(elem);if(!style){logError("Style returned "+style+". Are you running this code in a hidden iframe on Firefox? "+"See http://bit.ly/getsizebug1")}return style}}();boxSizingProp=getStyleProperty("boxSizing");if(boxSizingProp){var div=document.createElement("div");div.style.width="200px";div.style.padding="1px 2px 3px 4px";div.style.borderStyle="solid";div.style.borderWidth="1px 2px 3px 4px";div.style[boxSizingProp]="border-box";var body=document.body||document.documentElement;body.appendChild(div);var style=getStyle(div);isBoxSizeOuter=getStyleSize(style.width)===200;body.removeChild(div)}}function getSize(elem){setup();if(typeof elem==="string"){elem=document.querySelector(elem)}if(!elem||typeof elem!=="object"||!elem.nodeType){return}var style=getStyle(elem);if(style.display==="none"){return getZeroSize()}var size={};size.width=elem.offsetWidth;size.height=elem.offsetHeight;var isBorderBox=size.isBorderBox=!!(boxSizingProp&&style[boxSizingProp]&&style[boxSizingProp]==="border-box");for(var i=0,len=measurements.length;i<len;i++){var measurement=measurements[i];var value=style[measurement];value=mungeNonPixel(elem,value);var num=parseFloat(value);size[measurement]=!isNaN(num)?num:0}var paddingWidth=size.paddingLeft+size.paddingRight;var paddingHeight=size.paddingTop+size.paddingBottom;var marginWidth=size.marginLeft+size.marginRight;var marginHeight=size.marginTop+size.marginBottom;var borderWidth=size.borderLeftWidth+size.borderRightWidth;var borderHeight=size.borderTopWidth+size.borderBottomWidth;var isBorderBoxSizeOuter=isBorderBox&&isBoxSizeOuter;var styleWidth=getStyleSize(style.width);if(styleWidth!==false){size.width=styleWidth+(isBorderBoxSizeOuter?0:paddingWidth+borderWidth)}var styleHeight=getStyleSize(style.height);if(styleHeight!==false){size.height=styleHeight+(isBorderBoxSizeOuter?0:paddingHeight+borderHeight)}size.innerWidth=size.width-(paddingWidth+borderWidth);size.innerHeight=size.height-(paddingHeight+borderHeight);size.outerWidth=size.width+marginWidth;size.outerHeight=size.height+marginHeight;return size}function mungeNonPixel(elem,value){if(window.getComputedStyle||value.indexOf("%")===-1){return value}var style=elem.style;var left=style.left;var rs=elem.runtimeStyle;var rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}style.left=value;value=style.pixelLeft;style.left=left;if(rsLeft){rs.left=rsLeft}return value}return getSize}if(typeof define==="function"&&define.amd){define("get-size/get-size",["get-style-property/get-style-property"],defineGetSize)}else if(typeof exports==="object"){module.exports=defineGetSize(require("desandro-get-style-property"))}else{window.getSize=defineGetSize(window.getStyleProperty)}})(window);(function(window){var docElem=document.documentElement;var bind=function(){};function getIEEvent(obj){var event=window.event;event.target=event.target||event.srcElement||obj;return event}if(docElem.addEventListener){bind=function(obj,type,fn){obj.addEventListener(type,fn,false)}}else if(docElem.attachEvent){bind=function(obj,type,fn){obj[type+fn]=fn.handleEvent?function(){var event=getIEEvent(obj);fn.handleEvent.call(fn,event)}:function(){var event=getIEEvent(obj);fn.call(obj,event)};obj.attachEvent("on"+type,obj[type+fn])}}var unbind=function(){};if(docElem.removeEventListener){unbind=function(obj,type,fn){obj.removeEventListener(type,fn,false)}}else if(docElem.detachEvent){unbind=function(obj,type,fn){obj.detachEvent("on"+type,obj[type+fn]);try{delete obj[type+fn]}catch(err){obj[type+fn]=undefined}}}var eventie={bind:bind,unbind:unbind};if(typeof define==="function"&&define.amd){define("eventie/eventie",eventie)}else if(typeof exports==="object"){module.exports=eventie}else{window.eventie=eventie}})(window);(function(window){var document=window.document;var queue=[];function docReady(fn){if(typeof fn!=="function"){return}if(docReady.isReady){fn()}else{queue.push(fn)}}docReady.isReady=false;function onReady(event){var isIE8NotReady=event.type==="readystatechange"&&document.readyState!=="complete";if(docReady.isReady||isIE8NotReady){return}trigger()}function trigger(){docReady.isReady=true;for(var i=0,len=queue.length;i<len;i++){var fn=queue[i];fn()}}function defineDocReady(eventie){if(document.readyState==="complete"){trigger()}else{eventie.bind(document,"DOMContentLoaded",onReady);eventie.bind(document,"readystatechange",onReady);eventie.bind(window,"load",onReady)}return docReady}if(typeof define==="function"&&define.amd){define("doc-ready/doc-ready",["eventie/eventie"],defineDocReady)}else if(typeof exports==="object"){module.exports=defineDocReady(require("eventie"))}else{window.docReady=defineDocReady(window.eventie)}})(window);(function(){function EventEmitter(){}var proto=EventEmitter.prototype;var exports=this;var originalGlobalValue=exports.EventEmitter;function indexOfListener(listeners,listener){var i=listeners.length;while(i--){if(listeners[i].listener===listener){return i}}return-1}function alias(name){return function aliasClosure(){return this[name].apply(this,arguments)}}proto.getListeners=function getListeners(evt){var events=this._getEvents();var response;var key;if(evt instanceof RegExp){response={};for(key in events){if(events.hasOwnProperty(key)&&evt.test(key)){response[key]=events[key]}}}else{response=events[evt]||(events[evt]=[])}return response};proto.flattenListeners=function flattenListeners(listeners){var flatListeners=[];var i;for(i=0;i<listeners.length;i+=1){flatListeners.push(listeners[i].listener)}return flatListeners};proto.getListenersAsObject=function getListenersAsObject(evt){var listeners=this.getListeners(evt);var response;if(listeners instanceof Array){response={};response[evt]=listeners}return response||listeners};proto.addListener=function addListener(evt,listener){var listeners=this.getListenersAsObject(evt);var listenerIsWrapped=typeof listener==="object";var key;for(key in listeners){if(listeners.hasOwnProperty(key)&&indexOfListener(listeners[key],listener)===-1){listeners[key].push(listenerIsWrapped?listener:{listener:listener,once:false})}}return this};proto.on=alias("addListener");proto.addOnceListener=function addOnceListener(evt,listener){return this.addListener(evt,{listener:listener,once:true})};proto.once=alias("addOnceListener");proto.defineEvent=function defineEvent(evt){this.getListeners(evt);return this};proto.defineEvents=function defineEvents(evts){for(var i=0;i<evts.length;i+=1){this.defineEvent(evts[i])}return this};proto.removeListener=function removeListener(evt,listener){var listeners=this.getListenersAsObject(evt);var index;var key;for(key in listeners){if(listeners.hasOwnProperty(key)){index=indexOfListener(listeners[key],listener);if(index!==-1){listeners[key].splice(index,1)}}}return this};proto.off=alias("removeListener");proto.addListeners=function addListeners(evt,listeners){return this.manipulateListeners(false,evt,listeners)};proto.removeListeners=function removeListeners(evt,listeners){return this.manipulateListeners(true,evt,listeners)};proto.manipulateListeners=function manipulateListeners(remove,evt,listeners){var i;var value;var single=remove?this.removeListener:this.addListener;var multiple=remove?this.removeListeners:this.addListeners;if(typeof evt==="object"&&!(evt instanceof RegExp)){for(i in evt){if(evt.hasOwnProperty(i)&&(value=evt[i])){if(typeof value==="function"){single.call(this,i,value)}else{multiple.call(this,i,value)}}}}else{i=listeners.length;while(i--){single.call(this,evt,listeners[i])}}return this};proto.removeEvent=function removeEvent(evt){var type=typeof evt;var events=this._getEvents();var key;if(type==="string"){delete events[evt]}else if(evt instanceof RegExp){for(key in events){if(events.hasOwnProperty(key)&&evt.test(key)){delete events[key]}}}else{delete this._events}return this};proto.removeAllListeners=alias("removeEvent");proto.emitEvent=function emitEvent(evt,args){var listeners=this.getListenersAsObject(evt);var listener;var i;var key;var response;for(key in listeners){if(listeners.hasOwnProperty(key)){i=listeners[key].length;while(i--){listener=listeners[key][i];if(listener.once===true){this.removeListener(evt,listener.listener)}response=listener.listener.apply(this,args||[]);if(response===this._getOnceReturnValue()){this.removeListener(evt,listener.listener)}}}}return this};proto.trigger=alias("emitEvent");proto.emit=function emit(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)};proto.setOnceReturnValue=function setOnceReturnValue(value){this._onceReturnValue=value;return this};proto._getOnceReturnValue=function _getOnceReturnValue(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue}else{return true}};proto._getEvents=function _getEvents(){return this._events||(this._events={})};EventEmitter.noConflict=function noConflict(){exports.EventEmitter=originalGlobalValue;return EventEmitter};if(typeof define==="function"&&define.amd){define("eventEmitter/EventEmitter",[],function(){return EventEmitter})}else if(typeof module==="object"&&module.exports){module.exports=EventEmitter}else{exports.EventEmitter=EventEmitter}}).call(this);(function(ElemProto){var matchesMethod=function(){if(ElemProto.matchesSelector){return"matchesSelector"}var prefixes=["webkit","moz","ms","o"];for(var i=0,len=prefixes.length;i<len;i++){var prefix=prefixes[i];var method=prefix+"MatchesSelector";if(ElemProto[method]){return method}}}();function match(elem,selector){return elem[matchesMethod](selector)}function checkParent(elem){if(elem.parentNode){return}var fragment=document.createDocumentFragment();fragment.appendChild(elem)}function query(elem,selector){checkParent(elem);var elems=elem.parentNode.querySelectorAll(selector);for(var i=0,len=elems.length;i<len;i++){if(elems[i]===elem){return true}}return false}function matchChild(elem,selector){checkParent(elem);return match(elem,selector)}var matchesSelector;if(matchesMethod){var div=document.createElement("div");var supportsOrphans=match(div,"div");matchesSelector=supportsOrphans?match:matchChild}else{matchesSelector=query}if(typeof define==="function"&&define.amd){define("matches-selector/matches-selector",[],function(){return matchesSelector})}else if(typeof exports==="object"){module.exports=matchesSelector}else{window.matchesSelector=matchesSelector}})(Element.prototype);(function(window){var getComputedStyle=window.getComputedStyle;var getStyle=getComputedStyle?function(elem){return getComputedStyle(elem,null)}:function(elem){return elem.currentStyle};function extend(a,b){for(var prop in b){a[prop]=b[prop]}return a}function isEmptyObj(obj){for(var prop in obj){return false}prop=null;return true}function toDash(str){return str.replace(/([A-Z])/g,function($1){return"-"+$1.toLowerCase()})}function outlayerItemDefinition(EventEmitter,getSize,getStyleProperty){var transitionProperty=getStyleProperty("transition");var transformProperty=getStyleProperty("transform");var supportsCSS3=transitionProperty&&transformProperty;var is3d=!!getStyleProperty("perspective");var transitionEndEvent={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[transitionProperty];var prefixableProperties=["transform","transition","transitionDuration","transitionProperty"];var vendorProperties=function(){var cache={};for(var i=0,len=prefixableProperties.length;i<len;i++){var prop=prefixableProperties[i];var supportedProp=getStyleProperty(prop);if(supportedProp&&supportedProp!==prop){cache[prop]=supportedProp}}return cache}();function Item(element,layout){if(!element){return}this.element=element;this.layout=layout;this.position={x:0,y:0};this._create()}extend(Item.prototype,EventEmitter.prototype);Item.prototype._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}};this.css({position:"absolute"})};Item.prototype.handleEvent=function(event){var method="on"+event.type;if(this[method]){this[method](event)}};Item.prototype.getSize=function(){this.size=getSize(this.element)};Item.prototype.css=function(style){var elemStyle=this.element.style;for(var prop in style){var supportedProp=vendorProperties[prop]||prop;elemStyle[supportedProp]=style[prop]}};Item.prototype.getPosition=function(){var style=getStyle(this.element);var layoutOptions=this.layout.options;var isOriginLeft=layoutOptions.isOriginLeft;var isOriginTop=layoutOptions.isOriginTop;var x=parseInt(style[isOriginLeft?"left":"right"],10);var y=parseInt(style[isOriginTop?"top":"bottom"],10);x=isNaN(x)?0:x;y=isNaN(y)?0:y;var layoutSize=this.layout.size;x-=isOriginLeft?layoutSize.paddingLeft:layoutSize.paddingRight;y-=isOriginTop?layoutSize.paddingTop:layoutSize.paddingBottom;this.position.x=x;this.position.y=y};Item.prototype.layoutPosition=function(){var layoutSize=this.layout.size;var layoutOptions=this.layout.options;var style={};if(layoutOptions.isOriginLeft){style.left=this.position.x+layoutSize.paddingLeft+"px";style.right=""}else{style.right=this.position.x+layoutSize.paddingRight+"px";style.left=""}if(layoutOptions.isOriginTop){style.top=this.position.y+layoutSize.paddingTop+"px";style.bottom=""}else{style.bottom=this.position.y+layoutSize.paddingBottom+"px";style.top=""}this.css(style);this.emitEvent("layout",[this])};var translate=is3d?function(x,y){return"translate3d("+x+"px, "+y+"px, 0)";

}:function(x,y){return"translate("+x+"px, "+y+"px)"};Item.prototype._transitionTo=function(x,y){this.getPosition();var curX=this.position.x;var curY=this.position.y;var compareX=parseInt(x,10);var compareY=parseInt(y,10);var didNotMove=compareX===this.position.x&&compareY===this.position.y;this.setPosition(x,y);if(didNotMove&&!this.isTransitioning){this.layoutPosition();return}var transX=x-curX;var transY=y-curY;var transitionStyle={};var layoutOptions=this.layout.options;transX=layoutOptions.isOriginLeft?transX:-transX;transY=layoutOptions.isOriginTop?transY:-transY;transitionStyle.transform=translate(transX,transY);this.transition({to:transitionStyle,onTransitionEnd:{transform:this.layoutPosition},isCleaning:true})};Item.prototype.goTo=function(x,y){this.setPosition(x,y);this.layoutPosition()};Item.prototype.moveTo=supportsCSS3?Item.prototype._transitionTo:Item.prototype.goTo;Item.prototype.setPosition=function(x,y){this.position.x=parseInt(x,10);this.position.y=parseInt(y,10)};Item.prototype._nonTransition=function(args){this.css(args.to);if(args.isCleaning){this._removeStyles(args.to)}for(var prop in args.onTransitionEnd){args.onTransitionEnd[prop].call(this)}};Item.prototype._transition=function(args){if(!parseFloat(this.layout.options.transitionDuration)){this._nonTransition(args);return}var _transition=this._transn;for(var prop in args.onTransitionEnd){_transition.onEnd[prop]=args.onTransitionEnd[prop]}for(prop in args.to){_transition.ingProperties[prop]=true;if(args.isCleaning){_transition.clean[prop]=true}}if(args.from){this.css(args.from);var h=this.element.offsetHeight;h=null}this.enableTransition(args.to);this.css(args.to);this.isTransitioning=true};var itemTransitionProperties=transformProperty&&toDash(transformProperty)+",opacity";Item.prototype.enableTransition=function(){if(this.isTransitioning){return}this.css({transitionProperty:itemTransitionProperties,transitionDuration:this.layout.options.transitionDuration});this.element.addEventListener(transitionEndEvent,this,false)};Item.prototype.transition=Item.prototype[transitionProperty?"_transition":"_nonTransition"];Item.prototype.onwebkitTransitionEnd=function(event){this.ontransitionend(event)};Item.prototype.onotransitionend=function(event){this.ontransitionend(event)};var dashedVendorProperties={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};Item.prototype.ontransitionend=function(event){if(event.target!==this.element){return}var _transition=this._transn;var propertyName=dashedVendorProperties[event.propertyName]||event.propertyName;delete _transition.ingProperties[propertyName];if(isEmptyObj(_transition.ingProperties)){this.disableTransition()}if(propertyName in _transition.clean){this.element.style[event.propertyName]="";delete _transition.clean[propertyName]}if(propertyName in _transition.onEnd){var onTransitionEnd=_transition.onEnd[propertyName];onTransitionEnd.call(this);delete _transition.onEnd[propertyName]}this.emitEvent("transitionEnd",[this])};Item.prototype.disableTransition=function(){this.removeTransitionStyles();this.element.removeEventListener(transitionEndEvent,this,false);this.isTransitioning=false};Item.prototype._removeStyles=function(style){var cleanStyle={};for(var prop in style){cleanStyle[prop]=""}this.css(cleanStyle)};var cleanTransitionStyle={transitionProperty:"",transitionDuration:""};Item.prototype.removeTransitionStyles=function(){this.css(cleanTransitionStyle)};Item.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);this.emitEvent("remove",[this])};Item.prototype.remove=function(){if(!transitionProperty||!parseFloat(this.layout.options.transitionDuration)){this.removeElem();return}var _this=this;this.on("transitionEnd",function(){_this.removeElem();return true});this.hide()};Item.prototype.reveal=function(){delete this.isHidden;this.css({display:""});var options=this.layout.options;this.transition({from:options.hiddenStyle,to:options.visibleStyle,isCleaning:true})};Item.prototype.hide=function(){this.isHidden=true;this.css({display:""});var options=this.layout.options;this.transition({from:options.visibleStyle,to:options.hiddenStyle,isCleaning:true,onTransitionEnd:{opacity:function(){if(this.isHidden){this.css({display:"none"})}}}})};Item.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})};return Item}if(typeof define==="function"&&define.amd){define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],outlayerItemDefinition)}else if(typeof exports==="object"){module.exports=outlayerItemDefinition(require("wolfy87-eventemitter"),require("get-size"),require("desandro-get-style-property"))}else{window.Outlayer={};window.Outlayer.Item=outlayerItemDefinition(window.EventEmitter,window.getSize,window.getStyleProperty)}})(window);(function(window){var document=window.document;var console=window.console;var jQuery=window.jQuery;var noop=function(){};function extend(a,b){for(var prop in b){a[prop]=b[prop]}return a}var objToString=Object.prototype.toString;function isArray(obj){return objToString.call(obj)==="[object Array]"}function makeArray(obj){var ary=[];if(isArray(obj)){ary=obj}else if(obj&&typeof obj.length==="number"){for(var i=0,len=obj.length;i<len;i++){ary.push(obj[i])}}else{ary.push(obj)}return ary}var isElement=typeof HTMLElement==="function"||typeof HTMLElement==="object"?function isElementDOM2(obj){return obj instanceof HTMLElement}:function isElementQuirky(obj){return obj&&typeof obj==="object"&&obj.nodeType===1&&typeof obj.nodeName==="string"};var indexOf=Array.prototype.indexOf?function(ary,obj){return ary.indexOf(obj)}:function(ary,obj){for(var i=0,len=ary.length;i<len;i++){if(ary[i]===obj){return i}}return-1};function removeFrom(obj,ary){var index=indexOf(ary,obj);if(index!==-1){ary.splice(index,1)}}function toDashed(str){return str.replace(/(.)([A-Z])/g,function(match,$1,$2){return $1+"-"+$2}).toLowerCase()}function outlayerDefinition(eventie,docReady,EventEmitter,getSize,matchesSelector,Item){var GUID=0;var instances={};function Outlayer(element,options){if(typeof element==="string"){element=document.querySelector(element)}if(!element||!isElement(element)){if(console){console.error("Bad "+this.constructor.namespace+" element: "+element)}return}this.element=element;this.options=extend({},this.constructor.defaults);this.option(options);var id=++GUID;this.element.outlayerGUID=id;instances[id]=this;this._create();if(this.options.isInitLayout){this.layout()}}Outlayer.namespace="outlayer";Outlayer.Item=Item;Outlayer.defaults={containerStyle:{position:"relative"},isInitLayout:true,isOriginLeft:true,isOriginTop:true,isResizeBound:true,isResizingContainer:true,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};extend(Outlayer.prototype,EventEmitter.prototype);Outlayer.prototype.option=function(opts){extend(this.options,opts)};Outlayer.prototype._create=function(){this.reloadItems();this.stamps=[];this.stamp(this.options.stamp);extend(this.element.style,this.options.containerStyle);if(this.options.isResizeBound){this.bindResize()}};Outlayer.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)};Outlayer.prototype._itemize=function(elems){var itemElems=this._filterFindItemElements(elems);var Item=this.constructor.Item;var items=[];for(var i=0,len=itemElems.length;i<len;i++){var elem=itemElems[i];var item=new Item(elem,this);items.push(item)}return items};Outlayer.prototype._filterFindItemElements=function(elems){elems=makeArray(elems);var itemSelector=this.options.itemSelector;var itemElems=[];for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];if(!isElement(elem)){continue}if(itemSelector){if(matchesSelector(elem,itemSelector)){itemElems.push(elem)}var childElems=elem.querySelectorAll(itemSelector);for(var j=0,jLen=childElems.length;j<jLen;j++){itemElems.push(childElems[j])}}else{itemElems.push(elem)}}return itemElems};Outlayer.prototype.getItemElements=function(){var elems=[];for(var i=0,len=this.items.length;i<len;i++){elems.push(this.items[i].element)}return elems};Outlayer.prototype.layout=function(){this._resetLayout();this._manageStamps();var isInstant=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,isInstant);this._isLayoutInited=true};Outlayer.prototype._init=Outlayer.prototype.layout;Outlayer.prototype._resetLayout=function(){this.getSize()};Outlayer.prototype.getSize=function(){this.size=getSize(this.element)};Outlayer.prototype._getMeasurement=function(measurement,size){var option=this.options[measurement];var elem;if(!option){this[measurement]=0}else{if(typeof option==="string"){elem=this.element.querySelector(option)}else if(isElement(option)){elem=option}this[measurement]=elem?getSize(elem)[size]:option}};Outlayer.prototype.layoutItems=function(items,isInstant){items=this._getItemsForLayout(items);this._layoutItems(items,isInstant);this._postLayout()};Outlayer.prototype._getItemsForLayout=function(items){var layoutItems=[];for(var i=0,len=items.length;i<len;i++){var item=items[i];if(!item.isIgnored){layoutItems.push(item)}}return layoutItems};Outlayer.prototype._layoutItems=function(items,isInstant){var _this=this;function onItemsLayout(){_this.emitEvent("layoutComplete",[_this,items])}if(!items||!items.length){onItemsLayout();return}this._itemsOn(items,"layout",onItemsLayout);var queue=[];for(var i=0,len=items.length;i<len;i++){var item=items[i];var position=this._getItemLayoutPosition(item);position.item=item;position.isInstant=isInstant||item.isLayoutInstant;queue.push(position)}this._processLayoutQueue(queue)};Outlayer.prototype._getItemLayoutPosition=function(){return{x:0,y:0}};Outlayer.prototype._processLayoutQueue=function(queue){for(var i=0,len=queue.length;i<len;i++){var obj=queue[i];this._positionItem(obj.item,obj.x,obj.y,obj.isInstant)}};Outlayer.prototype._positionItem=function(item,x,y,isInstant){if(isInstant){item.goTo(x,y)}else{item.moveTo(x,y)}};Outlayer.prototype._postLayout=function(){this.resizeContainer()};Outlayer.prototype.resizeContainer=function(){if(!this.options.isResizingContainer){return}var size=this._getContainerSize();if(size){this._setContainerMeasure(size.width,true);this._setContainerMeasure(size.height,false)}};Outlayer.prototype._getContainerSize=noop;Outlayer.prototype._setContainerMeasure=function(measure,isWidth){if(measure===undefined){return}var elemSize=this.size;if(elemSize.isBorderBox){measure+=isWidth?elemSize.paddingLeft+elemSize.paddingRight+elemSize.borderLeftWidth+elemSize.borderRightWidth:elemSize.paddingBottom+elemSize.paddingTop+elemSize.borderTopWidth+elemSize.borderBottomWidth}measure=Math.max(measure,0);this.element.style[isWidth?"width":"height"]=measure+"px"};Outlayer.prototype._itemsOn=function(items,eventName,callback){var doneCount=0;var count=items.length;var _this=this;function tick(){doneCount++;if(doneCount===count){callback.call(_this)}return true}for(var i=0,len=items.length;i<len;i++){var item=items[i];item.on(eventName,tick)}};Outlayer.prototype.ignore=function(elem){var item=this.getItem(elem);if(item){item.isIgnored=true}};Outlayer.prototype.unignore=function(elem){var item=this.getItem(elem);if(item){delete item.isIgnored}};Outlayer.prototype.stamp=function(elems){elems=this._find(elems);if(!elems){return}this.stamps=this.stamps.concat(elems);for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];this.ignore(elem)}};Outlayer.prototype.unstamp=function(elems){elems=this._find(elems);if(!elems){return}for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];removeFrom(elem,this.stamps);this.unignore(elem)}};Outlayer.prototype._find=function(elems){if(!elems){return}if(typeof elems==="string"){elems=this.element.querySelectorAll(elems)}elems=makeArray(elems);return elems};Outlayer.prototype._manageStamps=function(){if(!this.stamps||!this.stamps.length){return}this._getBoundingRect();for(var i=0,len=this.stamps.length;i<len;i++){var stamp=this.stamps[i];this._manageStamp(stamp)}};Outlayer.prototype._getBoundingRect=function(){var boundingRect=this.element.getBoundingClientRect();var size=this.size;this._boundingRect={left:boundingRect.left+size.paddingLeft+size.borderLeftWidth,top:boundingRect.top+size.paddingTop+size.borderTopWidth,right:boundingRect.right-(size.paddingRight+size.borderRightWidth),bottom:boundingRect.bottom-(size.paddingBottom+size.borderBottomWidth)}};Outlayer.prototype._manageStamp=noop;Outlayer.prototype._getElementOffset=function(elem){var boundingRect=elem.getBoundingClientRect();var thisRect=this._boundingRect;var size=getSize(elem);var offset={left:boundingRect.left-thisRect.left-size.marginLeft,top:boundingRect.top-thisRect.top-size.marginTop,right:thisRect.right-boundingRect.right-size.marginRight,bottom:thisRect.bottom-boundingRect.bottom-size.marginBottom};return offset};Outlayer.prototype.handleEvent=function(event){var method="on"+event.type;if(this[method]){this[method](event)}};Outlayer.prototype.bindResize=function(){if(this.isResizeBound){return}eventie.bind(window,"resize",this);this.isResizeBound=true};Outlayer.prototype.unbindResize=function(){if(this.isResizeBound){eventie.unbind(window,"resize",this)}this.isResizeBound=false};Outlayer.prototype.onresize=function(){if(this.resizeTimeout){clearTimeout(this.resizeTimeout)}var _this=this;function delayed(){_this.resize();delete _this.resizeTimeout}this.resizeTimeout=setTimeout(delayed,100)};Outlayer.prototype.resize=function(){if(!this.isResizeBound||!this.needsResizeLayout()){return}this.layout()};Outlayer.prototype.needsResizeLayout=function(){var size=getSize(this.element);var hasSizes=this.size&&size;return hasSizes&&size.innerWidth!==this.size.innerWidth};Outlayer.prototype.addItems=function(elems){var items=this._itemize(elems);if(items.length){this.items=this.items.concat(items)}return items};Outlayer.prototype.appended=function(elems){var items=this.addItems(elems);if(!items.length){return}this.layoutItems(items,true);this.reveal(items)};Outlayer.prototype.prepended=function(elems){var items=this._itemize(elems);if(!items.length){return}var previousItems=this.items.slice(0);this.items=items.concat(previousItems);this._resetLayout();this._manageStamps();this.layoutItems(items,true);this.reveal(items);this.layoutItems(previousItems)};Outlayer.prototype.reveal=function(items){var len=items&&items.length;if(!len){return}for(var i=0;i<len;i++){var item=items[i];item.reveal()}};Outlayer.prototype.hide=function(items){var len=items&&items.length;if(!len){return}for(var i=0;i<len;i++){var item=items[i];item.hide()}};Outlayer.prototype.getItem=function(elem){for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i];if(item.element===elem){return item}}};Outlayer.prototype.getItems=function(elems){if(!elems||!elems.length){return}var items=[];for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];var item=this.getItem(elem);if(item){items.push(item)}}return items};Outlayer.prototype.remove=function(elems){elems=makeArray(elems);var removeItems=this.getItems(elems);if(!removeItems||!removeItems.length){return}this._itemsOn(removeItems,"remove",function(){this.emitEvent("removeComplete",[this,removeItems])});for(var i=0,len=removeItems.length;i<len;i++){var item=removeItems[i];item.remove();removeFrom(item,this.items)}};Outlayer.prototype.destroy=function(){var style=this.element.style;style.height="";style.position="";style.width="";for(var i=0,len=this.items.length;i<len;i++){var item=this.items[i];item.destroy()}this.unbindResize();var id=this.element.outlayerGUID;delete instances[id];delete this.element.outlayerGUID;if(jQuery){jQuery.removeData(this.element,this.constructor.namespace)}};Outlayer.data=function(elem){var id=elem&&elem.outlayerGUID;return id&&instances[id]};Outlayer.create=function(namespace,options){function Layout(){Outlayer.apply(this,arguments)}if(Object.create){Layout.prototype=Object.create(Outlayer.prototype)}else{extend(Layout.prototype,Outlayer.prototype)}Layout.prototype.constructor=Layout;Layout.defaults=extend({},Outlayer.defaults);extend(Layout.defaults,options);Layout.prototype.settings={};Layout.namespace=namespace;Layout.data=Outlayer.data;Layout.Item=function LayoutItem(){Item.apply(this,arguments)};Layout.Item.prototype=new Item;docReady(function(){var dashedNamespace=toDashed(namespace);var elems=document.querySelectorAll(".js-"+dashedNamespace);var dataAttr="data-"+dashedNamespace+"-options";for(var i=0,len=elems.length;i<len;i++){var elem=elems[i];var attr=elem.getAttribute(dataAttr);var options;try{options=attr&&JSON.parse(attr)}catch(error){if(console){console.error("Error parsing "+dataAttr+" on "+elem.nodeName.toLowerCase()+(elem.id?"#"+elem.id:"")+": "+error)}continue}var instance=new Layout(elem,options);if(jQuery){jQuery.data(elem,namespace,instance)}}});if(jQuery&&jQuery.bridget){jQuery.bridget(namespace,Layout)}return Layout};Outlayer.Item=Item;return Outlayer}if(typeof define==="function"&&define.amd){define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],outlayerDefinition)}else if(typeof exports==="object"){module.exports=outlayerDefinition(require("eventie"),require("doc-ready"),require("wolfy87-eventemitter"),require("get-size"),require("desandro-matches-selector"),require("./item"))}else{window.Outlayer=outlayerDefinition(window.eventie,window.docReady,window.EventEmitter,window.getSize,window.matchesSelector,window.Outlayer.Item)}})(window);(function(window){var Packery=window.Packery=function(){};function rectDefinition(){function Rect(props){for(var prop in Rect.defaults){this[prop]=Rect.defaults[prop]}for(prop in props){this[prop]=props[prop]}}Packery.Rect=Rect;Rect.defaults={x:0,y:0,width:0,height:0};Rect.prototype.contains=function(rect){var otherWidth=rect.width||0;var otherHeight=rect.height||0;return this.x<=rect.x&&this.y<=rect.y&&this.x+this.width>=rect.x+otherWidth&&this.y+this.height>=rect.y+otherHeight};Rect.prototype.overlaps=function(rect){var thisRight=this.x+this.width;var thisBottom=this.y+this.height;var rectRight=rect.x+rect.width;var rectBottom=rect.y+rect.height;return this.x<rectRight&&thisRight>rect.x&&this.y<rectBottom&&thisBottom>rect.y};Rect.prototype.getMaximalFreeRects=function(rect){if(!this.overlaps(rect)){return false}var freeRects=[];var freeRect;var thisRight=this.x+this.width;var thisBottom=this.y+this.height;var rectRight=rect.x+rect.width;var rectBottom=rect.y+rect.height;if(this.y<rect.y){freeRect=new Rect({x:this.x,y:this.y,width:this.width,height:rect.y-this.y});freeRects.push(freeRect)}if(thisRight>rectRight){freeRect=new Rect({x:rectRight,y:this.y,width:thisRight-rectRight,height:this.height});freeRects.push(freeRect)}if(thisBottom>rectBottom){freeRect=new Rect({x:this.x,y:rectBottom,width:this.width,height:thisBottom-rectBottom});freeRects.push(freeRect)}if(this.x<rect.x){freeRect=new Rect({x:this.x,y:this.y,width:rect.x-this.x,height:this.height});freeRects.push(freeRect)}return freeRects};Rect.prototype.canFit=function(rect){return this.width>=rect.width&&this.height>=rect.height};return Rect}if(typeof define==="function"&&define.amd){define("packery/js/rect",rectDefinition)}else if(typeof exports==="object"){module.exports=rectDefinition()}else{window.Packery=window.Packery||{};window.Packery.Rect=rectDefinition()}})(window);(function(window){function packerDefinition(Rect){function Packer(width,height,sortDirection){this.width=width||0;this.height=height||0;this.sortDirection=sortDirection||"downwardLeftToRight";this.reset()}Packer.prototype.reset=function(){this.spaces=[];this.newSpaces=[];var initialSpace=new Rect({x:0,y:0,width:this.width,height:this.height});this.spaces.push(initialSpace);this.sorter=sorters[this.sortDirection]||sorters.downwardLeftToRight};Packer.prototype.pack=function(rect){for(var i=0,len=this.spaces.length;i<len;i++){var space=this.spaces[i];if(space.canFit(rect)){this.placeInSpace(rect,space);break}}};Packer.prototype.placeInSpace=function(rect,space){rect.x=space.x;rect.y=space.y;this.placed(rect)};Packer.prototype.placed=function(rect){var revisedSpaces=[];for(var i=0,len=this.spaces.length;i<len;i++){var space=this.spaces[i];var newSpaces=space.getMaximalFreeRects(rect);if(newSpaces){revisedSpaces.push.apply(revisedSpaces,newSpaces)}else{revisedSpaces.push(space)}}this.spaces=revisedSpaces;this.mergeSortSpaces()};Packer.prototype.mergeSortSpaces=function(){Packer.mergeRects(this.spaces);this.spaces.sort(this.sorter)};Packer.prototype.addSpace=function(rect){this.spaces.push(rect);this.mergeSortSpaces()};Packer.mergeRects=function(rects){for(var i=0,len=rects.length;i<len;i++){var rect=rects[i];if(!rect){continue}var compareRects=rects.slice(0);compareRects.splice(i,1);var removedCount=0;for(var j=0,jLen=compareRects.length;j<jLen;j++){var compareRect=compareRects[j];var indexAdjust=i>j?0:1;if(rect.contains(compareRect)){rects.splice(j+indexAdjust-removedCount,1);removedCount++}}}return rects};var sorters={downwardLeftToRight:function(a,b){return a.y-b.y||a.x-b.x},rightwardTopToBottom:function(a,b){return a.x-b.x||a.y-b.y}};return Packer}if(typeof define==="function"&&define.amd){define("packery/js/packer",["./rect"],packerDefinition)}else if(typeof exports==="object"){module.exports=packerDefinition(require("./rect"))}else{var Packery=window.Packery=window.Packery||{};Packery.Packer=packerDefinition(Packery.Rect)}})(window);(function(window){function itemDefinition(getStyleProperty,Outlayer,Rect){var transformProperty=getStyleProperty("transform");var Item=function PackeryItem(){Outlayer.Item.apply(this,arguments)};Item.prototype=new Outlayer.Item;var protoCreate=Item.prototype._create;Item.prototype._create=function(){protoCreate.call(this);this.rect=new Rect;this.placeRect=new Rect};Item.prototype.dragStart=function(){this.getPosition();this.removeTransitionStyles();if(this.isTransitioning&&transformProperty){this.element.style[transformProperty]="none"}this.getSize();this.isPlacing=true;this.needsPositioning=false;this.positionPlaceRect(this.position.x,this.position.y);this.isTransitioning=false;this.didDrag=false};Item.prototype.dragMove=function(x,y){this.didDrag=true;var packerySize=this.layout.size;x-=packerySize.paddingLeft;y-=packerySize.paddingTop;this.positionPlaceRect(x,y)};Item.prototype.dragStop=function(){this.getPosition();var isDiffX=this.position.x!==this.placeRect.x;var isDiffY=this.position.y!==this.placeRect.y;this.needsPositioning=isDiffX||isDiffY;this.didDrag=false};Item.prototype.positionPlaceRect=function(x,y,isMaxYOpen){this.placeRect.x=this.getPlaceRectCoord(x,true);this.placeRect.y=this.getPlaceRectCoord(y,false,isMaxYOpen)};Item.prototype.getPlaceRectCoord=function(coord,isX,isMaxOpen){var measure=isX?"Width":"Height";var size=this.size["outer"+measure];var segment=this.layout[isX?"columnWidth":"rowHeight"];var parentSize=this.layout.size["inner"+measure];if(!isX){parentSize=Math.max(parentSize,this.layout.maxY);if(!this.layout.rowHeight){parentSize-=this.layout.gutter}}var max;if(segment){segment+=this.layout.gutter;parentSize+=isX?this.layout.gutter:0;coord=Math.round(coord/segment);var mathMethod;if(this.layout.options.isHorizontal){mathMethod=!isX?"floor":"ceil"}else{mathMethod=isX?"floor":"ceil"}var maxSegments=Math[mathMethod](parentSize/segment);maxSegments-=Math.ceil(size/segment);max=maxSegments}else{max=parentSize-size}coord=isMaxOpen?coord:Math.min(coord,max);coord*=segment||1;return Math.max(0,coord)};Item.prototype.copyPlaceRectPosition=function(){this.rect.x=this.placeRect.x;this.rect.y=this.placeRect.y};Item.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element);this.layout.packer.addSpace(this.rect);this.emitEvent("remove",[this])};return Item}if(typeof define==="function"&&define.amd){define("packery/js/item",["get-style-property/get-style-property","outlayer/outlayer","./rect"],itemDefinition)}else if(typeof exports==="object"){module.exports=itemDefinition(require("desandro-get-style-property"),require("outlayer"),require("./rect"))}else{window.Packery.Item=itemDefinition(window.getStyleProperty,window.Outlayer,window.Packery.Rect)}})(window);(function(window){function packeryDefinition(classie,getSize,Outlayer,Rect,Packer,Item){Rect.prototype.canFit=function(rect){return this.width>=rect.width-1&&this.height>=rect.height-1};var Packery=Outlayer.create("packery");Packery.Item=Item;Packery.prototype._create=function(){Outlayer.prototype._create.call(this);this.packer=new Packer;this.stamp(this.options.stamped);var _this=this;this.handleDraggabilly={dragStart:function(draggie){_this.itemDragStart(draggie.element)},dragMove:function(draggie){_this.itemDragMove(draggie.element,draggie.position.x,draggie.position.y)},dragEnd:function(draggie){_this.itemDragEnd(draggie.element)}};this.handleUIDraggable={start:function handleUIDraggableStart(event){_this.itemDragStart(event.currentTarget)},drag:function handleUIDraggableDrag(event,ui){_this.itemDragMove(event.currentTarget,ui.position.left,ui.position.top)},stop:function handleUIDraggableStop(event){_this.itemDragEnd(event.currentTarget)}}};Packery.prototype._resetLayout=function(){this.getSize();this._getMeasurements();var packer=this.packer;if(this.options.isHorizontal){packer.width=Number.POSITIVE_INFINITY;packer.height=this.size.innerHeight+this.gutter;packer.sortDirection="rightwardTopToBottom"}else{packer.width=this.size.innerWidth+this.gutter;packer.height=Number.POSITIVE_INFINITY;packer.sortDirection="downwardLeftToRight"}packer.reset();this.maxY=0;this.maxX=0};Packery.prototype._getMeasurements=function(){this._getMeasurement("columnWidth","width");this._getMeasurement("rowHeight","height");this._getMeasurement("gutter","width")};Packery.prototype._getItemLayoutPosition=function(item){this._packItem(item);return item.rect};Packery.prototype._packItem=function(item){this._setRectSize(item.element,item.rect);this.packer.pack(item.rect);this._setMaxXY(item.rect)};Packery.prototype._setMaxXY=function(rect){this.maxX=Math.max(rect.x+rect.width,this.maxX);this.maxY=Math.max(rect.y+rect.height,this.maxY)};Packery.prototype._setRectSize=function(elem,rect){var size=getSize(elem);var w=size.outerWidth;var h=size.outerHeight;if(w||h){w=this._applyGridGutter(w,this.columnWidth);h=this._applyGridGutter(h,this.rowHeight)}rect.width=Math.min(w,this.packer.width);rect.height=Math.min(h,this.packer.height)};Packery.prototype._applyGridGutter=function(measurement,gridSize){if(!gridSize){return measurement+this.gutter}gridSize+=this.gutter;var remainder=measurement%gridSize;var mathMethod=remainder&&remainder<1?"round":"ceil";measurement=Math[mathMethod](measurement/gridSize)*gridSize;return measurement};Packery.prototype._getContainerSize=function(){if(this.options.isHorizontal){return{width:this.maxX-this.gutter}}else{return{height:this.maxY-this.gutter}}};Packery.prototype._manageStamp=function(elem){var item=this.getItem(elem);var rect;if(item&&item.isPlacing){rect=item.placeRect}else{var offset=this._getElementOffset(elem);rect=new Rect({x:this.options.isOriginLeft?offset.left:offset.right,y:this.options.isOriginTop?offset.top:offset.bottom})}this._setRectSize(elem,rect);this.packer.placed(rect);this._setMaxXY(rect)};function verticalSorter(a,b){return a.position.y-b.position.y||a.position.x-b.position.x}function horizontalSorter(a,b){return a.position.x-b.position.x||a.position.y-b.position.y}Packery.prototype.sortItemsByPosition=function(){var sorter=this.options.isHorizontal?horizontalSorter:verticalSorter;this.items.sort(sorter)};Packery.prototype.fit=function(elem,x,y){var item=this.getItem(elem);if(!item){return}this._getMeasurements();this.stamp(item.element);item.getSize();item.isPlacing=true;x=x===undefined?item.rect.x:x;y=y===undefined?item.rect.y:y;item.positionPlaceRect(x,y,true);this._bindFitEvents(item);item.moveTo(item.placeRect.x,item.placeRect.y);this.layout();this.unstamp(item.element);this.sortItemsByPosition();item.isPlacing=false;item.copyPlaceRectPosition()};Packery.prototype._bindFitEvents=function(item){var _this=this;var ticks=0;function tick(){ticks++;if(ticks!==2){return}_this.emitEvent("fitComplete",[_this,item])}item.on("layout",function(){tick();return true});this.on("layoutComplete",function(){tick();return true})};Packery.prototype.resize=function(){var size=getSize(this.element);var hasSizes=this.size&&size;var innerSize=this.options.isHorizontal?"innerHeight":"innerWidth";if(hasSizes&&size[innerSize]===this.size[innerSize]){return}this.layout()};Packery.prototype.itemDragStart=function(elem){this.stamp(elem);var item=this.getItem(elem);if(item){item.dragStart()}};Packery.prototype.itemDragMove=function(elem,x,y){var item=this.getItem(elem);if(item){item.dragMove(x,y)}var _this=this;function delayed(){_this.layout();delete _this.dragTimeout}this.clearDragTimeout();this.dragTimeout=setTimeout(delayed,40)};Packery.prototype.clearDragTimeout=function(){if(this.dragTimeout){clearTimeout(this.dragTimeout)}};Packery.prototype.itemDragEnd=function(elem){var item=this.getItem(elem);var itemDidDrag;if(item){itemDidDrag=item.didDrag;item.dragStop()}if(!item||!itemDidDrag&&!item.needsPositioning){this.unstamp(elem);return}classie.add(item.element,"is-positioning-post-drag");var onLayoutComplete=this._getDragEndLayoutComplete(elem,item);if(item.needsPositioning){item.on("layout",onLayoutComplete);item.moveTo(item.placeRect.x,item.placeRect.y)}else if(item){item.copyPlaceRectPosition()}this.clearDragTimeout();this.on("layoutComplete",onLayoutComplete);this.layout()};Packery.prototype._getDragEndLayoutComplete=function(elem,item){var itemNeedsPositioning=item&&item.needsPositioning;var completeCount=0;var asyncCount=itemNeedsPositioning?2:1;var _this=this;return function onLayoutComplete(){completeCount++;if(completeCount!==asyncCount){return true}if(item){classie.remove(item.element,"is-positioning-post-drag");item.isPlacing=false;item.copyPlaceRectPosition()}_this.unstamp(elem);_this.sortItemsByPosition();if(itemNeedsPositioning){_this.emitEvent("dragItemPositioned",[_this,item])}return true}};Packery.prototype.bindDraggabillyEvents=function(draggie){draggie.on("dragStart",this.handleDraggabilly.dragStart);draggie.on("dragMove",this.handleDraggabilly.dragMove);draggie.on("dragEnd",this.handleDraggabilly.dragEnd)};Packery.prototype.bindUIDraggableEvents=function($elems){$elems.on("dragstart",this.handleUIDraggable.start).on("drag",this.handleUIDraggable.drag).on("dragstop",this.handleUIDraggable.stop)};Packery.Rect=Rect;Packery.Packer=Packer;return Packery}if(typeof define==="function"&&define.amd){define(["classie/classie","get-size/get-size","outlayer/outlayer","packery/js/rect","packery/js/packer","packery/js/item"],packeryDefinition)}else if(typeof exports==="object"){module.exports=packeryDefinition(require("desandro-classie"),require("get-size"),require("outlayer"),require("./rect"),require("./packer"),require("./item"))}else{window.Packery=packeryDefinition(window.classie,window.getSize,window.Outlayer,window.Packery.Rect,window.Packery.Packer,window.Packery.Item)}})(window);(function(window,document,undefined){"use strict";var NAME="Parallax";var MAGIC_NUMBER=30;var DEFAULTS={relativeInput:false,clipRelativeInput:false,calibrationThreshold:100,calibrationDelay:500,supportDelay:500,calibrateX:false,calibrateY:true,invertX:true,invertY:true,limitX:false,limitY:false,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,originX:.5,originY:.5};function Parallax(element,options){this.element=element;this.layers=element.getElementsByClassName("layer");var data={calibrateX:this.data(this.element,"calibrate-x"),calibrateY:this.data(this.element,"calibrate-y"),invertX:this.data(this.element,"invert-x"),invertY:this.data(this.element,"invert-y"),limitX:this.data(this.element,"limit-x"),
limitY:this.data(this.element,"limit-y"),scalarX:this.data(this.element,"scalar-x"),scalarY:this.data(this.element,"scalar-y"),frictionX:this.data(this.element,"friction-x"),frictionY:this.data(this.element,"friction-y"),originX:this.data(this.element,"origin-x"),originY:this.data(this.element,"origin-y")};for(var key in data){if(data[key]===null)delete data[key]}this.extend(this,DEFAULTS,options,data);this.calibrationTimer=null;this.calibrationFlag=true;this.enabled=false;this.depths=[];this.raf=null;this.bounds=null;this.ex=0;this.ey=0;this.ew=0;this.eh=0;this.ecx=0;this.ecy=0;this.erx=0;this.ery=0;this.cx=0;this.cy=0;this.ix=0;this.iy=0;this.mx=0;this.my=0;this.vx=0;this.vy=0;this.onMouseMove=this.onMouseMove.bind(this);this.onDeviceOrientation=this.onDeviceOrientation.bind(this);this.onOrientationTimer=this.onOrientationTimer.bind(this);this.onCalibrationTimer=this.onCalibrationTimer.bind(this);this.onAnimationFrame=this.onAnimationFrame.bind(this);this.onWindowResize=this.onWindowResize.bind(this);this.initialise()}Parallax.prototype.extend=function(){if(arguments.length>1){var master=arguments[0];for(var i=1,l=arguments.length;i<l;i++){var object=arguments[i];for(var key in object){master[key]=object[key]}}}};Parallax.prototype.data=function(element,name){return this.deserialize(element.getAttribute("data-"+name))};Parallax.prototype.deserialize=function(value){if(value==="true"){return true}else if(value==="false"){return false}else if(value==="null"){return null}else if(!isNaN(parseFloat(value))&&isFinite(value)){return parseFloat(value)}else{return value}};Parallax.prototype.camelCase=function(value){return value.replace(/-+(.)?/g,function(match,character){return character?character.toUpperCase():""})};Parallax.prototype.transformSupport=function(value){var element=document.createElement("div");var propertySupport=false;var propertyValue=null;var featureSupport=false;var cssProperty=null;var jsProperty=null;for(var i=0,l=this.vendors.length;i<l;i++){if(this.vendors[i]!==null){cssProperty=this.vendors[i][0]+"transform";jsProperty=this.vendors[i][1]+"Transform"}else{cssProperty="transform";jsProperty="transform"}if(element.style[jsProperty]!==undefined){propertySupport=true;break}}switch(value){case"2D":featureSupport=propertySupport;break;case"3D":if(propertySupport){var body=document.body||document.createElement("body");var documentElement=document.documentElement;var documentOverflow=documentElement.style.overflow;if(!document.body){documentElement.style.overflow="hidden";documentElement.appendChild(body);body.style.overflow="hidden";body.style.background=""}body.appendChild(element);element.style[jsProperty]="translate3d(1px,1px,1px)";propertyValue=window.getComputedStyle(element).getPropertyValue(cssProperty);featureSupport=propertyValue!==undefined&&propertyValue.length>0&&propertyValue!=="none";documentElement.style.overflow=documentOverflow;body.removeChild(element)}break}return featureSupport};Parallax.prototype.ww=null;Parallax.prototype.wh=null;Parallax.prototype.wcx=null;Parallax.prototype.wcy=null;Parallax.prototype.wrx=null;Parallax.prototype.wry=null;Parallax.prototype.portrait=null;Parallax.prototype.desktop=!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|BB10|mobi|tablet|opera mini|nexus 7)/i);Parallax.prototype.vendors=[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]];Parallax.prototype.motionSupport=!!window.DeviceMotionEvent;Parallax.prototype.orientationSupport=!!window.DeviceOrientationEvent;Parallax.prototype.orientationStatus=0;Parallax.prototype.transform2DSupport=true;Parallax.prototype.transform3DSupport=true;Parallax.prototype.propertyCache={};Parallax.prototype.initialise=function(){if(this.transform3DSupport)this.accelerate(this.element);var style=window.getComputedStyle(this.element);if(style.getPropertyValue("position")==="static"){this.element.style.position="relative"}this.updateLayers();this.updateDimensions();this.enable();this.queueCalibration(this.calibrationDelay)};Parallax.prototype.updateLayers=function(){this.layers=this.element.getElementsByClassName("layer");this.depths=[];for(var i=0,l=this.layers.length;i<l;i++){var layer=this.layers[i];if(this.transform3DSupport)this.accelerate(layer);layer.style.position=i?"absolute":"relative";layer.style.display="block";layer.style.left=0;layer.style.top=0;this.depths.push(this.data(layer,"depth")||0)}};Parallax.prototype.updateDimensions=function(){this.ww=window.innerWidth;this.wh=window.innerHeight;this.wcx=this.ww*this.originX;this.wcy=this.wh*this.originY;this.wrx=Math.max(this.wcx,this.ww-this.wcx);this.wry=Math.max(this.wcy,this.wh-this.wcy)};Parallax.prototype.updateBounds=function(){this.bounds=this.element.getBoundingClientRect();this.ex=this.bounds.left;this.ey=this.bounds.top;this.ew=this.bounds.width;this.eh=this.bounds.height;this.ecx=this.ew*this.originX;this.ecy=this.eh*this.originY;this.erx=Math.max(this.ecx,this.ew-this.ecx);this.ery=Math.max(this.ecy,this.eh-this.ecy)};Parallax.prototype.queueCalibration=function(delay){clearTimeout(this.calibrationTimer);this.calibrationTimer=setTimeout(this.onCalibrationTimer,delay)};Parallax.prototype.enable=function(){if(!this.enabled){this.enabled=true;if(this.orientationSupport){this.portrait=null;window.addEventListener("deviceorientation",this.onDeviceOrientation);setTimeout(this.onOrientationTimer,this.supportDelay)}else{this.cx=0;this.cy=0;this.portrait=false;window.addEventListener("mousemove",this.onMouseMove)}window.addEventListener("resize",this.onWindowResize);this.raf=requestAnimationFrame(this.onAnimationFrame)}};Parallax.prototype.disable=function(){if(this.enabled){this.enabled=false;if(this.orientationSupport){window.removeEventListener("deviceorientation",this.onDeviceOrientation)}else{window.removeEventListener("mousemove",this.onMouseMove)}window.removeEventListener("resize",this.onWindowResize);cancelAnimationFrame(this.raf)}};Parallax.prototype.calibrate=function(x,y){this.calibrateX=x===undefined?this.calibrateX:x;this.calibrateY=y===undefined?this.calibrateY:y};Parallax.prototype.invert=function(x,y){this.invertX=x===undefined?this.invertX:x;this.invertY=y===undefined?this.invertY:y};Parallax.prototype.friction=function(x,y){this.frictionX=x===undefined?this.frictionX:x;this.frictionY=y===undefined?this.frictionY:y};Parallax.prototype.scalar=function(x,y){this.scalarX=x===undefined?this.scalarX:x;this.scalarY=y===undefined?this.scalarY:y};Parallax.prototype.limit=function(x,y){this.limitX=x===undefined?this.limitX:x;this.limitY=y===undefined?this.limitY:y};Parallax.prototype.origin=function(x,y){this.originX=x===undefined?this.originX:x;this.originY=y===undefined?this.originY:y};Parallax.prototype.clamp=function(value,min,max){value=Math.max(value,min);value=Math.min(value,max);return value};Parallax.prototype.css=function(element,property,value){var jsProperty=this.propertyCache[property];if(!jsProperty){for(var i=0,l=this.vendors.length;i<l;i++){if(this.vendors[i]!==null){jsProperty=this.camelCase(this.vendors[i][1]+"-"+property)}else{jsProperty=property}if(element.style[jsProperty]!==undefined){this.propertyCache[property]=jsProperty;break}}}element.style[jsProperty]=value};Parallax.prototype.accelerate=function(element){this.css(element,"transform","translate3d(0,0,0)");this.css(element,"transform-style","preserve-3d");this.css(element,"backface-visibility","hidden")};Parallax.prototype.setPosition=function(element,x,y){x+="px";y+="px";if(this.transform3DSupport){this.css(element,"transform","translate3d("+x+","+y+",0)")}else if(this.transform2DSupport){this.css(element,"transform","translate("+x+","+y+")")}else{element.style.left=x;element.style.top=y}};Parallax.prototype.onOrientationTimer=function(event){if(this.orientationSupport&&this.orientationStatus===0){this.disable();this.orientationSupport=false;this.enable()}};Parallax.prototype.onCalibrationTimer=function(event){this.calibrationFlag=true};Parallax.prototype.onWindowResize=function(event){this.updateDimensions()};Parallax.prototype.onAnimationFrame=function(){this.updateBounds();var dx=this.ix-this.cx;var dy=this.iy-this.cy;if(Math.abs(dx)>this.calibrationThreshold||Math.abs(dy)>this.calibrationThreshold){this.queueCalibration(0)}if(this.portrait){this.mx=this.calibrateX?dy:this.iy;this.my=this.calibrateY?dx:this.ix}else{this.mx=this.calibrateX?dx:this.ix;this.my=this.calibrateY?dy:this.iy}this.mx*=this.ew*(this.scalarX/100);this.my*=this.eh*(this.scalarY/100);if(!isNaN(parseFloat(this.limitX))){this.mx=this.clamp(this.mx,-this.limitX,this.limitX)}if(!isNaN(parseFloat(this.limitY))){this.my=this.clamp(this.my,-this.limitY,this.limitY)}this.vx+=(this.mx-this.vx)*this.frictionX;this.vy+=(this.my-this.vy)*this.frictionY;for(var i=0,l=this.layers.length;i<l;i++){var layer=this.layers[i];var depth=this.depths[i];var xOffset=this.vx*depth*(this.invertX?-1:1);var yOffset=this.vy*depth*(this.invertY?-1:1);this.setPosition(layer,xOffset,yOffset)}this.raf=requestAnimationFrame(this.onAnimationFrame)};Parallax.prototype.onDeviceOrientation=function(event){if(!this.desktop&&event.beta!==null&&event.gamma!==null){this.orientationStatus=1;var x=(event.beta||0)/MAGIC_NUMBER;var y=(event.gamma||0)/MAGIC_NUMBER;var portrait=this.wh>this.ww;if(this.portrait!==portrait){this.portrait=portrait;this.calibrationFlag=true}if(this.calibrationFlag){this.calibrationFlag=false;this.cx=x;this.cy=y}this.ix=x;this.iy=y}};Parallax.prototype.onMouseMove=function(event){var clientX=event.clientX;var clientY=event.clientY;if(!this.orientationSupport&&this.relativeInput){if(this.clipRelativeInput){clientX=Math.max(clientX,this.ex);clientX=Math.min(clientX,this.ex+this.ew);clientY=Math.max(clientY,this.ey);clientY=Math.min(clientY,this.ey+this.eh)}this.ix=(clientX-this.ex-this.ecx)/this.erx;this.iy=(clientY-this.ey-this.ecy)/this.ery}else{this.ix=(clientX-this.wcx)/this.wrx;this.iy=(clientY-this.wcy)/this.wry}};window[NAME]=Parallax})(window,document);(function(){var lastTime=0;var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=(new Date).getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id)}}})();(function(){this.Const={LOCAL_FILE_URL:"<customFile>"}}).apply(fvdSpeedDial);function _b(v){if(typeof v=="boolean"){return v}if(v=="true"){return true}return false}function _isb(v){if(typeof v=="boolean"){return true}if(v=="true"||v=="false"){return true}return false}function _r(v){if(_isb(v)){return _b(v)}return v}function _array(list){var result=[];for(var i=0;i!=list.length;i++){result.push(list[i])}return result}Element.prototype.insertAfter=function(newElem,targetElem){if(this.lastChild==targetElem){this.appendChild(newElem)}else{this.insertBefore(newElem,targetElem.nextSibling)}};function FVDEventEmitter(){var callbacks=[];this.addListener=function(listener){callbacks.push(listener)};this.removeListener=function(listener){var index=callbacks.indexOf(listener);if(index!=-1){callbacks.splice(index,1)}};this.callListeners=function(){var args=arguments;var toRemove=[];callbacks.forEach(function(callback){try{callback.apply(window,args)}catch(ex){toRemove.push(callback)}});toRemove.forEach(function(callback){var index=callbacks.indexOf(callback);if(index>-1){callbacks.splice(index,1)}})}}(function(){var Utils=function(){};Utils.prototype={_isVersionChanged:false,getChromeVersion:function(){var match=navigator.userAgent.match(/Chrome\/([0-9\.]+)/i);if(!match){return null}return match[1]},isActiveTab:function(cb){chrome.tabs.getCurrent(function(tab){if(tab){cb(tab.active)}})},getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},clone:function(obj){return JSON.parse(JSON.stringify(obj))},shuffle:function(inputArr){var valArr=[],k="",i=0,strictForIn=false,populateArr=[];for(k in inputArr){if(inputArr.hasOwnProperty(k)){valArr.push(inputArr[k]);if(strictForIn){delete inputArr[k]}}}valArr.sort(function(){return.5-Math.random()});this.php_js=this.php_js||{};this.php_js.ini=this.php_js.ini||{};strictForIn=this.php_js.ini["phpjs.strictForIn"]&&this.php_js.ini["phpjs.strictForIn"].local_value&&this.php_js.ini["phpjs.strictForIn"].local_value!=="off";populateArr=strictForIn?inputArr:populateArr;for(i=0;i<valArr.length;i++){populateArr[i]=valArr[i]}return strictForIn||populateArr},getUserCountry:function(cb){var xhr=new XMLHttpRequest;xhr.open("GET","http://everhelper.me/spec/country.php");xhr.onload=function(){cb(xhr.responseText)};xhr.send(null)},hasEqualElements:function(a,b){for(var i=0;i!=a.length;i++){if(b.indexOf(a[i])!=-1){return true}}return false},validateText:function(type,text){switch(type){case"email":var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(text);break}},getQueryValue:function(variable){var query=window.location.hash.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(decodeURIComponent(pair[0])==variable){return decodeURIComponent(pair[1])}}return null},arrayDiff:function(a1,a2){return a1.filter(function(i){return!(a2.indexOf(i)>-1)})},urlToCompareForm:function(url){url=url.toLowerCase();url=url.replace(/https?:\/\//i,"");url=url.replace(/^www\./i,"");url=url.replace(/\/+$/i,"");return url},isValidUrl:function(url){if(url.indexOf("file:///")===0){return true}try{var parsed=this.parseUrl(url);if(!parsed.host){return false}if(parsed.host.length<2){return false}return true}catch(ex){return false}},getMainDomain:function(domain){var parts=domain.split("."),result="",countParts=parts.length;if(parts.length>1){result=parts[countParts-2]+"."+parts[countParts-1]}else{result=parts[countParts-1]}return result},isIdenticalUrls:function(url1,url2){url1=this.urlToCompareForm(url1);url2=this.urlToCompareForm(url2);return url1==url2},isIdenticalHosts:function(host1,host2,params){params=params||{};if(params.ignoreSubDomains){host1=this.getMainDomain(host1);host2=this.getMainDomain(host2)}host1=this.urlToCompareForm(host1);host2=this.urlToCompareForm(host2);return host1==host2},buildUrlFromParsed:function(parsed){var url=parsed.scheme+"://";if(parsed.user&&parsed.pass){url+=parsed.user+":"+parsed.pass+"@"}else if(parsed.user){url+=parsed.user+"@"}url+=parsed.host;if(parsed.path){url+=parsed.path}if(parsed.query){url+="?"+parsed.query}if(parsed.fragment){url+="#"+parsed.query}return url},typeToExt:function(type){switch(type){case"image/png":return"png";break;case"image/jpeg":return"jpg";break;case"image/gif":return"gif";break}},b64toBlob:function(b64Data,contentType,sliceSize){contentType=contentType||"";sliceSize=sliceSize||512;var byteCharacters=atob(b64Data);var byteArrays=[];for(var offset=0;offset<byteCharacters.length;offset+=sliceSize){var slice=byteCharacters.slice(offset,offset+sliceSize);var byteNumbers=new Array(slice.length);for(var i=0;i<slice.length;i++){byteNumbers[i]=slice.charCodeAt(i)}var byteArray=new Uint8Array(byteNumbers);byteArrays.push(byteArray)}var blob=new Blob(byteArrays,{type:contentType});return blob},dataURIToBlob:function(url){url=url.replace(/^data:/,"");var tmp=url.split(";"),contentType=tmp[0];url=tmp[1].split(",")[1];console.log(contentType);return this.b64toBlob(url,contentType)},parseUrl:function(str,component){var key=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],ini=this.php_js&&this.php_js.ini||{},mode=ini["phpjs.parse_url.mode"]&&ini["phpjs.parse_url.mode"].local_value||"php",parser={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};var m=parser[mode].exec(str),uri={},i=14;while(i--){if(m[i]){uri[key[i]]=m[i]}}if(component){return uri[component.replace("PHP_URL_","").toLowerCase()]}if(mode!=="php"){var name=ini["phpjs.parse_url.queryKey"]&&ini["phpjs.parse_url.queryKey"].local_value||"queryKey";parser=/(?:^|&)([^&=]*)=?([^&]*)/g;uri[name]={};uri[key[12]].replace(parser,function($0,$1,$2){if($1){uri[name][$1]=$2}})}delete uri.source;return uri},isVisibleElem:function(elem){var viewportHeight=window.innerHeight;var currentTopStart=document.body.scrollTop;var currentTopEnd=currentTopStart+viewportHeight;var elemOffset=this.getOffset(elem);if(elemOffset.top>currentTopStart&&elemOffset.top+elem.offsetHeight<currentTopEnd){return true}return false},isVersionChanged:function(){var app=chrome.app.getDetails();if(fvdSpeedDial.Prefs.get("last_run_version")!=app.version){this._isVersionChanged=true;fvdSpeedDial.Prefs.set("last_run_version",app.version)}return this._isVersionChanged},scrollToElem:function(elem){var viewportHeight=window.innerHeight;var currentTopStart=document.body.scrollTop;var currentTopEnd=currentTopStart+viewportHeight;var elemOffset=this.getOffset(elem);if(elemOffset.top>currentTopStart&&elemOffset.top+elem.offsetHeight<currentTopEnd){return}var scrollAmount=0;if(elemOffset.top<currentTopStart){scrollAmount=elemOffset.top}else{scrollAmount=elemOffset.top+elem.offsetHeight-viewportHeight}document.body.scrollTop=scrollAmount},getOffset:function(obj){var curleft=0,curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent)}return{left:curleft,top:curtop}},isChildOf:function(elem,parent){while(true){if(elem==parent){return true}if(elem.parentNode){elem=elem.parentNode}else{return false}}},copyToClipboard:function(text){var clipboardholder=document.createElement("textarea");clipboardholder.style.width="0px";clipboardholder.style.height="0px";clipboardholder.style.opacity=0;document.body.appendChild(clipboardholder);clipboardholder.value=text;clipboardholder.select();document.execCommand("Copy");document.body.removeChild(clipboardholder)},ucfirst:function(str){var firstLetter=str.slice(0,1);return firstLetter.toUpperCase()+str.substring(1)},cropLength:function(str,len){if(str.length<=len){return str}return str.substring(0,len)+"..."},setScreenPreview:function(elem,screen,nocache){if(typeof screen=="string"&&screen.indexOf("filesystem:")===0){if(nocache){screen+="?"+nocache}}elem.style.background="";elem.style.background="url("+screen+")";elem.style.backgroundSize="100%";elem.style.backgroundPosition="top left";elem.style.backgroundRepeat="no-repeat"},removeScreenPreview:function(elem){if(elem){elem.style.background="";elem.style.backgroundSize="";elem.style.backgroundPosition="";elem.style.backgroundRepeat=""}},setUrlPreview:function(elemParams,picParams,nocache){if(typeof picParams.url=="string"&&picParams.url.indexOf("filesystem:")===0){if(nocache){picParams.url+="?"+nocache}}this.Async.chain([function(callback2){if(!picParams.size){var img=new Image;img.onload=function(){picParams.size={width:img.width,height:img.height};callback2()};img.onerror=function(){picParams.size={width:0,height:0};callback2()};img.src=picParams.url}else{callback2()}},function(){elemParams.elem.style.background="url("+picParams.url+")";elemParams.elem.style.backgroundPosition="center center";if(picParams.size.width&&picParams.size.height&&picParams.size.width<elemParams.size.width&&picParams.size.height<elemParams.size.height){elemParams.elem.style.backgroundSize=""}else{elemParams.elem.style.backgroundSize="contain"}elemParams.elem.style.backgroundRepeat="no-repeat"}])},imageUrlToDataUrl:function(url,callback,format,quality){var img=new Image;img.onload=function(){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");canvas.width=img.width;canvas.height=img.height;ctx.drawImage(img,0,0,img.width,img.height);if(img.width*img.height<1024*1024){format="image/png"}format=format||"image/jpeg";quality=quality||90;callback(canvas.toDataURL(format,quality),{width:img.width,height:img.height})};img.onerror=function(){callback(null)};img.src=url},getUrlContent:function(url,callback){var req=new XMLHttpRequest;req.open("GET",url);req.onload=function(){callback(req.responseText)};req.onerror=function(){callback(null)};req.send()},getTitleForUrl:function(url,callback){var req=new XMLHttpRequest;req.open("GET",url);req.onload=function(){var tmp=document.createElement("div");tmp.innerHTML=req.responseText;try{var title=tmp.getElementsByTagName("title")[0];callback(title.textContent)}catch(ex){callback(null)}};req.onerror=function(){callback(null)};req.send()},setAutoTextForTextField:function(elem,text){elem.addEventListener("focus",function(){if(elem.hasAttribute("autoText")){elem.removeAttribute("autoText");elem.value=""}},false);elem.addEventListener("blur",function(){if(elem.value==""){elem.setAttribute("autoText",1);elem.value=text}},false);if(elem.value==""){elem.setAttribute("autoText",1);elem.value=text}},Async:{chain:function(callbacksChain){var dataObject={};var f=function(){if(callbacksChain.length>0){var nextCallback=callbacksChain.shift();nextCallback(f,dataObject)}};f()},arrayProcess:function(dataArray,callback,finishCallback,noTimeout){var iterationsWithoutTimeout=0;var f=function(i){if(i>=dataArray.length){finishCallback()}else{if(noTimeout){callback(dataArray[i],function(){f(i+1)})}else{if(iterationsWithoutTimeout<20){iterationsWithoutTimeout++;callback(dataArray[i],function(){f(i+1)})}else{iterationsWithoutTimeout=0;setTimeout(function(){callback(dataArray[i],function(){f(i+1)})},0)}}}};f(0)},cc:function(stateFunction){var rf=function(result){if(result=="break"){return}stateFunction(rf)};stateFunction(rf)}},UI:{showAndHide:function(elem,timeout){timeout=timeout|3e3;elem.style.opacity=1;setTimeout(function(){elem.style.opacity=0},timeout)}},Opener:{asClicked:function(url,def,event){var action=def;if(event.button==0){if(event.ctrlKey){if(event.shiftKey){action="new"}else{action="background"}}}else if(event.button==1){action="background"}this.byAction(action,url);return action},byAction:function(action,url){switch(action){case"current":this.currentTab(url);break;case"new":this.newTab(url);break;case"background":this.backgroundTab(url);break}},activeTab:function(url){chrome.tabs.query({active:true},function(tabs){chrome.tabs.update(tabs[0].id,{url:url})})},currentTab:function(url){chrome.tabs.getCurrent(function(tab){chrome.tabs.update(tab.id,{url:url})})},newTab:function(url){chrome.tabs.create({url:url,active:true})},backgroundTab:function(url){chrome.tabs.create({url:url,active:false})}}};fvdSpeedDial.Utils=new Utils;(function(){var DD=function(){};var _dragAndDropElem=function(params){var that=this;var placeHolder=null;var _preserveMargins={left:null,top:null};this._elem=params.elem;this._ddTargets=params.targets;this._initParams=params;this._lastMousePos=null;this._ddTargetsList=null;this._lastMouseMoveEvent=null;this._mouseMoved=false;function _elParent(){return that._elem.parentNode}function _childIndex(child){var p=_elParent();for(var i=0;i!=p.childNodes;i++){if(child==p.childNodes[i]){return i}}return-1}function _createPlaceHolder(){placeHolder=document.createElement("div");placeHolder.style.width=that._elem.offsetWidth+"px";placeHolder.style.height=that._elem.offsetHeight+"px";placeHolder.className=that._elem.className;_elParent().insertBefore(placeHolder,that._elem)}function _removePlaceHolder(){_elParent().removeChild(placeHolder)}this.event=function(type){var args=[];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}if(that._initParams["callback"+type]){that._initParams["callback"+type].apply(window,args)}};this.init=function(){this._elem.addEventListener("mousedown",function(event){if(event.button!=0){return}that._mouseMoved=false;that._draggingStartCursorPosition=that._mousePos(event);document.addEventListener("mousemove",that._mouseMove,false);document.addEventListener("mouseup",that._mouseUp,false);document.addEventListener("mouseout",that._cancelIfNoMove,false);that.event("MouseDownReal")},false)};this.adjustPos=function(mouse){mouse=mouse||that._lastMousePos;that._lastMousePos=mouse;var marginLeft=mouse.x-that._draggingStartCursorPosition.x;var marginTop=mouse.y-that._draggingStartCursorPosition.y;that._elem.style.webkitTransition="none";var newMargins=that._initParams.changePos(marginLeft,marginTop,that);marginLeft=newMargins.left;marginTop=newMargins.top;if(marginLeft!==false){that._elem.style.marginLeft=marginLeft+"px"}if(marginTop!==false){that._elem.style.marginTop=marginTop+"px"}var elemOffset=fvdSpeedDial.Utils.getOffset(that._elem);var centerPos={left:elemOffset.left+that._elem.offsetWidth/2,top:elemOffset.top+that._elem.offsetHeight/2};var nowDraggedOn=[];var nowDraggedOnElems=[];for(var i=0;i!=that._ddTargetsList.length;i++){var targetOffset=fvdSpeedDial.Utils.getOffset(that._ddTargetsList[i]);if(centerPos.left>=targetOffset.left&&centerPos.left<=targetOffset.left+that._ddTargetsList[i].offsetWidth&&centerPos.top>=targetOffset.top&&centerPos.top<=targetOffset.top+that._ddTargetsList[i].offsetHeight){var cursor={left:centerPos.left-targetOffset.left,top:centerPos.top-targetOffset.top};var draggedOnData={cursor:cursor,el:that._ddTargetsList[i],width:that._ddTargetsList[i].offsetWidth,height:that._ddTargetsList[i].offsetHeight};nowDraggedOn.push(draggedOnData);nowDraggedOnElems.push(draggedOnData.el)}}for(var i=0;i!=nowDraggedOn.length;i++){if(params.alwaysPropatateDragOn){that.event("Dragon",nowDraggedOn[i].el,nowDraggedOn[i])}else{if(that._nowDraggedOn.indexOf(nowDraggedOn[i].el)==-1){that.event("Dragon",nowDraggedOn[i].el,nowDraggedOn[i])}}}for(var i=0;i!=that._nowDraggedOn.length;i++){if(nowDraggedOnElems.indexOf(that._nowDraggedOn[i])==-1){that.event("Dragleave",that._nowDraggedOn[i])}}that._nowDraggedOn=nowDraggedOnElems;return{left:marginLeft,top:marginTop}},this._mouseMove=function(event){that._mouseMoved=true;event=event||that._lastMouseMoveEvent;that._lastMouseMoveEvent=event;if(params.usePlaceHolder){if(!that._startEventSent){_createPlaceHolder();that._elem.style.position="absolute";if(that._elem.style.marginTop){_preserveMargins.top=that._elem.style.marginTop}if(that._elem.style.marginLeft){_preserveMargins.left=that._elem.style.marginLeft}that._startEventSent=true;that.event("Start")}}if(!that._nowDragging){that._nowDragging=true;that.event("MouseDown")}if(that._ddTargetsList==null){var targets=document.querySelectorAll("*[dd_class~="+that._ddTargets+"]");that._ddTargetsList=[];for(var i=0;i!=targets.length;i++){if(targets[i]==that._elem){continue}that._ddTargetsList.push(targets[i])}}var mouse=that._mousePos(event);var margins=that.adjustPos(mouse);if(!params.usePlaceHolder){if(!that._startEventSent){if(margins.left!=0||margins.top!=0){that._startEventSent=true;that.event("Start")}}}};this._cancelIfNoMove=function(){if(!that._mouseMoved){that._mouseUp()}};this._mouseUp=function(event){if(params.usePlaceHolder){_removePlaceHolder();that._elem.style.position=""}document.removeEventListener("mousemove",that._mouseMove,false);document.removeEventListener("mouseup",that._mouseUp,false);try{document.removeEventListener("mouseout",that._cancelIfNoMove,false)}catch(ex){}that._elem.style.webkitTransition="";if(_preserveMargins.top){that._elem.style.marginTop=_preserveMargins.top}else{that._elem.style.marginTop=""}if(_preserveMargins.left){that._elem.style.marginLeft=_preserveMargins.left}else{that._elem.style.marginLeft=""}if(params.constantStyle){for(var k in params.constantStyle){that._elem.style[k]=params.constantStyle[k]}}else{}that._nowDragging=false;that._startEventSent=false;that._ddTargetsList=null;that.event("End",{elements:that._ddTargetsList})};this._mousePos=function(event){var scrollTop=document.body.scrollTop;if(this._initParams.scrollingNotMean){scrollTop=0}return{x:event.x,y:event.y+scrollTop}};this.init()};_dragAndDropElem.prototype={_initParams:null,_elem:null,_ddTargets:null,_ddTargetsList:null,_nowDragging:false,_draggingStartCursorPosition:{x:null,y:null},_nowDraggedOn:[],_startEventSent:false};DD.prototype={create:function(params){return new _dragAndDropElem(params)}};this.DD=new DD}).apply(fvdSpeedDial.Utils)})();(function(){var proxyMethods=["resetAllDialsClicks","groupsList","setMisc","getMisc","dump","clearDeny","editDeny","isDenyUrl","deny","denyList","removeDeny","Apps.get","Apps.storePositions","countDials","searchDials","listDials","insertDialUpdateStorage","dialExists","addDial","deleteDial","getDial","updateDial","moveDial","clearDials","dialGlobalId","resetAutoDialsForGroup","setAutoPreviewGlobally","turnOffAutoUpdateGlobally","setAutoUpdateGlobally","groupExists","groupUpdate","groupAdd","getGroup","groupCanSyncById","clearGroups","groupsCount","groupDelete","MostVisited.getAvailableCount","MostVisited.getData","MostVisited.getDataByHost","MostVisited.extendData","MostVisited.getById","MostVisited.updateData","MostVisited.deleteId","MostVisited.invalidateCache","MostVisited.restoreRemoved","RecentlyClosed.getAvailableCount","RecentlyClosed.getData","RecentlyClosed.remove","RecentlyClosed.removeAll"];var StorageProxy=function(){};var p=new StorageProxy;proxyMethods.forEach(function(methodName){function _processMethod(){var args=Array.prototype.slice.call(arguments),lastIndex=args.length-1,cb=null;if(typeof args[lastIndex]=="function"){cb=args[lastIndex];args.splice(lastIndex,1)}var request={action:"proxy:storage",method:methodName,args:args,wantResponse:cb!==null};chrome.runtime.sendMessage(request,function(data){if(cb){cb.apply(window,data.args)}})}var parts=methodName.split(".");var m=parts.pop(),obj=p;parts.forEach(function(part){if(typeof obj[part]=="undefined"){obj[part]={}}obj=obj[part]});obj[m]=_processMethod});fvdSpeedDial.Storage=p})();fvdSpeedDial.Config={FANCY_SIDE_DIALS_MAX_SCALE:5,FANCY_SIDE_DIALS_MIN_SCALE:1.3,DISPLAY_AD_EVERY:(Math.floor(Math.random()*3)+3)*24*3600*1e3,FS_DIALS_PREVIEW_DIR:"sd_previews",FS_MOSTVISITED_PREVIEW_DIR:"mostvisited_previews",FS_MISC_DIR:"misc",AUTOUPDATE_PREVIEW_ENABLED:true,UNINSTALL_URL:"http://fvdmedia.com/to/s/chrsdun",NEWTAB_URL:"chrome://newtab/",MIN_DIALS_SEARCH_QUERY_LENGTH:2,MOD_SEARCH_ALIEXPRESS:false,DIAL_PREVIEW_OVERRIDE:{"2060fdd1":{url:"http://amazon.com"},d70b5c2:{url:"http://ebay.com"},"341b4e7":{url:"http://www.tripadvisor.com"},"7958f8e8":{url:"http://booking.com"},"454734a7":{url:"http://aliexpress.com"},"5c3c7096":{url:"http://wayfair.com"},"3840ec48":{url:"http://groupon.com"}}};(function(){var ToolTip=function(){};ToolTip.prototype={_container:null,_arrowLeftOffset:10,_arrowTopOffset:19,_currentElement:null,displayImage:function(elem,imageSrc,event){var html='<img src="'+imageSrc+'"/>';this.display(elem,html,event)},display:function(elem,html,event,isText){event.stopPropagation();if(this._currentElement==elem){return}this._currentElement=elem;var that=this;var setFunction=function(){var toolTipContainer=fvdSpeedDial.Templates.clone("tiptip_holder");that._container=toolTipContainer;var offset=fvdSpeedDial.Utils.getOffset(elem);toolTipContainer.style.left=offset.left+elem.offsetWidth/2-that._arrowLeftOffset-1+"px";toolTipContainer.style.top=offset.top+elem.offsetHeight+that._arrowTopOffset+"px";document.body.appendChild(that._container);var contentContainer=document.getElementById("tiptip_content");if(isText){contentContainer.classList.add("textTip")}if(html.tagName){
contentContainer.appendChild(html)}else{contentContainer.innerHTML=html}setTimeout(function(){toolTipContainer.setAttribute("active",1);that._assignClickListener()},0)};if(this._container){this.close(setFunction)}else{setFunction()}},close:function(callback){fvdSpeedDial.ToolTip._container.setAttribute("active",0);fvdSpeedDial.ToolTip._container.addEventListener("webkitTransitionEnd",function(){try{fvdSpeedDial.ToolTip._container.parentNode.removeChild(fvdSpeedDial.ToolTip._container);fvdSpeedDial.ToolTip._container=null;fvdSpeedDial.ToolTip._currentElement=null;fvdSpeedDial.ToolTip._removeClickListener();if(callback){callback()}}catch(ex){}},false)},_clickListener:function(event){if(fvdSpeedDial.ToolTip._container){var el=event.target;do{if(el==fvdSpeedDial.ToolTip._container){return}el=el.parentNode}while(el)}fvdSpeedDial.ToolTip.close()},_assignClickListener:function(){document.addEventListener("click",fvdSpeedDial.ToolTip._clickListener,false)},_removeClickListener:function(){document.removeEventListener("click",fvdSpeedDial.ToolTip._clickListener)}};this.ToolTip=new ToolTip}).apply(fvdSpeedDial);(function(){fvdSpeedDial.ThumbMaker={getImageDataPath:function(params,cb){chrome.runtime.sendMessage({action:"thumbmaker:getimagedatapath",params:params},function(res){cb(res.imgUrl,res.size)})},screenTab:function(params){chrome.runtime.sendMessage({action:"thumbmaker:screentab",params:params})}}})();(function(){var Dialogs=function(){};Dialogs.prototype={_erroredFields:[],alert:function(title,text,callback){var btns={};btns[_("dlg_alert_ok")]=function(){dlg.close();if(callback){callback()}};var dlg=new Dialog({width:400,title:title,content:text,buttons:btns})},alertCheck:function(title,text,cbText,cbInitState,callback,params){params=params||{};params.width=params.width||400;if(document.getElementById("dialogAlertCheck_text")){return}var btns={};btns[_("dlg_alert_ok")]=function(){dlg.close();if(callback){callback(document.getElementById("dialogAlertCheck_checkbox").checked)}};var dlg=new Dialog({className:"alertDialog",width:params.width,title:title,content:fvdSpeedDial.Templates.getHTML("prototype_dialogAlertCheck"),buttons:btns,onShow:function(){document.getElementById("dialogAlertCheck_text").innerHTML=text;document.getElementById("dialogAlertCheck_checkBoxLabel").innerHTML=cbText;document.getElementById("dialogAlertCheck_checkbox").checked=cbInitState}})},confirmCheck:function(title,text,cbText,cbInitState,callback){if(document.getElementById("dialogAlertCheck_text")){return}var btns={};btns[_("dlg_confirm_ok")]=function(){dlg.close();if(callback){callback(true,document.getElementById("dialogAlertCheck_checkbox").checked)}};btns[_("dlg_confirm_cancel")]=function(){dlg.close();if(callback){callback(false,document.getElementById("dialogAlertCheck_checkbox").checked)}};var dlg=new Dialog({className:"alertDialog",width:400,title:title,content:fvdSpeedDial.Templates.getHTML("prototype_dialogAlertCheck"),buttons:btns,onShow:function(){document.getElementById("dialogAlertCheck_text").innerHTML=text;document.getElementById("dialogAlertCheck_checkBoxLabel").innerHTML=cbText;document.getElementById("dialogAlertCheck_checkbox").checked=cbInitState}})},confirm:function(title,text,callback){var btns={};btns[_("dlg_confirm_ok")]=function(){dlg.close();callback(true)};btns[_("dlg_confirm_cancel")]=function(){dlg.close();callback(false)};var dlg=new Dialog({width:400,enterOnButton:_("dlg_confirm_ok"),title:title,content:text,buttons:btns})},initPrototypes:function(){},errorToField:function(field,prnt,errorMessage){var dialogErrorBox=document.getElementById("dialogErrorBox");if(!dialogErrorBox){dialogErrorBox=document.createElement("div");dialogErrorBox.className="dialog-errorBox";dialogErrorBox.setAttribute("id","dialogErrorBox");var span=document.createElement("div");dialogErrorBox.appendChild(span);prnt.appendChild(dialogErrorBox)}field.setAttribute("error","1");this._erroredFields.push(field);var span=dialogErrorBox.getElementsByTagName("div")[0];span.textContent=errorMessage;var pos=fvdSpeedDial.Utils.getOffset(field);dialogErrorBox.style.left=pos.left+"px";dialogErrorBox.style.top=pos.top-1+field.offsetHeight+"px";dialogErrorBox.style.width=field.offsetWidth-2+"px";dialogErrorBox.setAttribute("active",1)},hideErrorBox:function(){try{var dialogErrorBox=document.getElementById("dialogErrorBox");if(dialogErrorBox){dialogErrorBox.setAttribute("active",0)}for(var i=0;i!=this._erroredFields.length;i++){this._erroredFields[i].setAttribute("error",0)}}catch(ex){}},PicsUserPics:{SDPREVIEW_URL_PREFIX:"https://everhelper.me/sdpreviews",currentXHR:[],buildElem:function(preview,callbacks,dlg){var resultCallback=callbacks.resultCallback;var _report=callbacks._report;var previewElem=document.createElement("div");previewElem.className="item";var img=document.createElement("div");img.className="preview";var tmpImg=new Image;tmpImg.onload=function(){try{img.style.background='url("'+preview.url+'") no-repeat center center ';if(tmpImg.width>img.offsetWidth||tmpImg.height>img.offsetHeight){img.style.backgroundSize="contain"}}catch(ex){}};tmpImg.src=preview.url;var report=document.createElement("div");report.className="report";report.setAttribute("title",_("dialog_pick_user_pics_report"));if(_report){previewElem.appendChild(report)}var reportContainer=document.createElement("div");reportContainer.className="reportContainer";var buttonInappropriate=document.createElement("button");var buttonDuplicate=document.createElement("button");buttonInappropriate.className="fvdButton inappropriate";buttonDuplicate.className="fvdButton duplicate";buttonInappropriate.textContent=_("dialog_pick_user_pics_report_innop");buttonDuplicate.textContent=_("dialog_pick_user_pics_report_duplicate");var closeReport=document.createElement("div");closeReport.className="close";reportContainer.appendChild(buttonInappropriate);reportContainer.appendChild(closeReport);var thankYouReport=document.createElement("div");thankYouReport.textContent=_("dialog_pick_user_pics_report_thanks");thankYouReport.className="thanks";reportContainer.appendChild(thankYouReport);previewElem.appendChild(img);previewElem.appendChild(reportContainer);closeReport.addEventListener("click",function(event){previewElem.removeAttribute("report");event.stopPropagation()});report.addEventListener("click",function(){previewElem.setAttribute("report",1);event.stopPropagation()});previewElem.addEventListener("click",function(){resultCallback(preview);resultCallback=null;if(dlg){dlg.close()}},false);function _okReport(){setTimeout(function(){previewElem.removeAttribute("report");setTimeout(function(){reportContainer.removeAttribute("thanks")},500)},1e3)}reportContainer.addEventListener("click",function(event){event.stopPropagation()},false);buttonInappropriate.addEventListener("click",function(){_report(preview.id,"inappropriate",function(){reportContainer.setAttribute("thanks",1);_okReport()})});buttonDuplicate.addEventListener("click",function(){_report(preview.id,"duplicate",function(){reportContainer.setAttribute("thanks",1);_okReport()})});setTimeout(function(){previewElem.setAttribute("appear",1)},0);return previewElem},rate:function(sdPreviewId,callback){callback=callback||function(){};this.request("rating.php",{sdpreview_id:sdPreviewId},callback)},cancelCurrentRequests:function(){this.currentXHR.forEach(function(xhr){xhr.abort()});this.currentXHR=[]},request:function(file,params,callback){var url=this.SDPREVIEW_URL_PREFIX+"/"+file;var that=this;var queryStr=[];for(var k in params){queryStr.push(k+"="+encodeURIComponent(params[k]))}url+="?"+queryStr.join("&");var xhr=new XMLHttpRequest;that.currentXHR.push(xhr);xhr.open("GET",url);xhr.onload=function(){var index=that.currentXHR.indexOf(xhr);if(index!=-1){that.currentXHR.splice(index,1)}try{var response=JSON.parse(xhr.responseText);if(response.errorCode){return callback(new Error("Server returns error "+response.errorCode))}}catch(ex){return callback(new Error("Fail parse server response"))}callback(null,response.body)};xhr.onerror=function(){var index=that.currentXHR.indexOf(xhr);if(index!=-1){that.currentXHR.splice(index,1)}callback(new Error("Fail make request"))};xhr.send(null)}},pickUserPics:function(params,resultCallback){var btns={};btns[_("dlg_button_cancel")]=function(){dlg.close()};const ADDITIONAL_SEARCH=[{title:"Google Images",url:"http://www.google.com/search?hl=en&site=imghp&tbm=isch&source=hp&q={simplehost}"},{title:"Icon Finder",url:" https://www.iconfinder.com/search/?q={simplehost}+icon"},{title:"Find Icons",url:"http://findicons.com/search/{simplehost}"},{title:"Icon Archive",url:"http://www.iconarchive.com/search?q={simplehost}"},{title:"Icons Pedia",url:"http://www.iconspedia.com/search/{simplehost}/"}];var currentOrder="best";var currentPage=0;var currentTotalPages=0;var that=this;function _request(file,params,callback){that.PicsUserPics.request(file,params,callback)}function _listImages(pageNum,order,callback){_request("listing.php",{p:pageNum,order:order,host:params.host},callback)}function _report(sdPreviewId,type,callback){_request("report.php",{sdpreview_id:sdPreviewId,type:type},callback)}function _setOrder(order){if(fvdSpeedDial.Dialogs.PicsUserPics.currentXHR.length>0){fvdSpeedDial.Dialogs.PicsUserPics.currentXHR.forEach(function(xhr){xhr.abort()});fvdSpeedDial.Dialogs.PicsUserPics.currentXHR=[]}currentOrder=order;currentPage=0;var container=document.querySelector("#dialogPicUserPics .picsContainer");var elems=document.querySelectorAll("#dialogPicUserPics .head .order");while(container.firstChild){container.removeChild(container.firstChild)}for(var i=0;i!=elems.length;i++){var el=elems[i];el.removeAttribute("active")}document.querySelector("#dialogPicUserPics .head .order."+order).setAttribute("active",1);_buildList()}function _showAdditionalSearch(found){var container=document.querySelector("#dialogPicUserPics .picsContainer");if(!found){var notFoundElem=document.createElement("div");notFoundElem.className="notFound";notFoundElem.textContent=_("dialog_pick_user_pics_not_found");container.appendChild(notFoundElem)}var additionalSearch=document.createElement("div");additionalSearch.className="additionalSearch";var title=document.createElement("div");title.textContent=_("dialog_pick_user_pics_not_found_title").replace("{host}",params.host);title.className="title";additionalSearch.appendChild(title);var tmp=params.host.split(".");var hostSimple=params.host;if(tmp.length>=2){hostSimple=tmp[tmp.length-2];if(hostSimple=="co"&&tmp.length>2){hostSimple=tmp[tmp.length-3]}}ADDITIONAL_SEARCH.forEach(function(item){var elem=document.createElement("div");var a=document.createElement("a");a.textContent=item.title;a.setAttribute("href",item.url.replace("{host}",params.host).replace("{simplehost}",hostSimple));a.setAttribute("target","_blank");elem.appendChild(a);additionalSearch.appendChild(elem)});container.appendChild(additionalSearch);var additionalHelpMessage=document.createElement("div");additionalHelpMessage.className="additionalHelpMessage";var text=document.createElement("span");text.textContent=_("dialog_pick_user_pics_not_found_enter_in");additionalHelpMessage.appendChild(text);var img=document.createElement("div");img.className="img";additionalHelpMessage.appendChild(img);container.appendChild(additionalHelpMessage)}function _buildList(){var container=document.querySelector("#dialogPicUserPics .picsContainer");if(container.querySelector("div.loading")){return}var loading=document.createElement("div");loading.className="loading";container.appendChild(loading);_listImages(currentPage,currentOrder,function(error,data){currentTotalPages=data.totalPages;container.removeChild(loading);if(error){fvdSpeedDial.Dialogs.alert(_("dlg_alert_fail_obtain_user_pics_title"),_("dlg_alert_fail_obtain_user_pics_text"));return}if(data.previews.length==0){_showAdditionalSearch(false)}data.previews.forEach(function(preview){var previewElem=that.PicsUserPics.buildElem(preview,{resultCallback:resultCallback,_report:_report},dlg);container.appendChild(previewElem)});if(currentPage==currentTotalPages-1){_showAdditionalSearch(true)}})}var dlg=new Dialog({width:735,title:this._title("pick_user_images"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogPickUserPics"),buttons:btns,closeCallback:function(){if(resultCallback){resultCallback(null)}},onShow:function(dlg){["best","new"].forEach(function(order){var elem=document.querySelector("#dialogPicUserPics .head .order."+order);elem.addEventListener("click",function(){_setOrder(order)})});_setOrder(currentOrder);var container=document.querySelector("#dialogPicUserPics .picsContainer");container.addEventListener("scroll",function(){var remainScroll=container.scrollHeight-container.scrollTop-container.offsetHeight;if(remainScroll<50&&currentPage<currentTotalPages-1){if(container.querySelector("div.loading")){return}currentPage++;_buildList()}});var bottomActions=dlg.container.querySelector(".dialog-actions");var reportBottomDesc=document.createElement("div");reportBottomDesc.setAttribute("id","dialogPicUserPics_reportBottomDesc");var span1=document.createElement("span");span1.textContent=_("dialog_pick_user_pics_bottom_desc_1");var span2=document.createElement("span");span2.textContent=_("dialog_pick_user_pics_bottom_desc_2");var alertImg=document.createElement("img");alertImg.setAttribute("src","/images/screamer.png");reportBottomDesc.appendChild(span1);reportBottomDesc.appendChild(alertImg);reportBottomDesc.appendChild(span2);bottomActions.insertBefore(reportBottomDesc,bottomActions.firstChild)}})},setAutoUpdateBatch:function(){var btns={};btns[_("dlg_button_save")]=function(){var interval=document.getElementById("dialogSetAutoUpdate_autoupdate_preview_interval").value+"|"+document.getElementById("dialogSetAutoUpdate_autoupdate_preview_interval_type").value;fvdSpeedDial.Storage.setAutoUpdateGlobally({interval:interval},function(){dlg.close();fvdSpeedDial.Dialogs.alert(_("dlg_alert_dials_autoupdate_updated_title"),_("dlg_alert_dials_autoupdate_updated_text"))})};btns[_("dlg_button_cancel")]=function(){dlg.close()};var dlg=new Dialog({width:300,title:this._title("set_autoupdate_batch"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogSetAutoUpdate"),buttons:btns})},manageDeny:function(){var that=this;var btns={};btns[_("dlg_button_add_deny_rule")]=function(){that.deny()};btns[_("dlg_button_close")]=function(){dlg.close()};var dlg=new Dialog({width:600,title:that._title("manage_deny"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogManageDeny"),buttons:btns,onShow:function(){that.ManageDeny.refresh()}})},ManageDeny:{refresh:function(){var oldContainer=document.getElementById("denyUrlsContainer");if(!oldContainer){return}var container=oldContainer.cloneNode(true);while(container.firstChild){container.removeChild(container.firstChild)}fvdSpeedDial.Storage.denyList(function(data){for(var i=0;i!=data.length;i++){var d=data[i];var tr=document.createElement("tr");var tdSign=document.createElement("td");var divSign=document.createElement("div");var tdType=document.createElement("td");var divType=document.createElement("div");var tdActions=document.createElement("td");var divActions=document.createElement("div");divSign.textContent=d.sign;tdType.textContent=d.type=="host"?"domain":d.type;var iconEdit=document.createElement("div");var iconRemove=document.createElement("div");iconEdit.className="icon edit";iconRemove.className="icon remove";divActions.className="speedDialIcons";divActions.appendChild(iconEdit);divActions.appendChild(iconRemove);tdSign.appendChild(divSign);tdType.appendChild(divType);tdActions.appendChild(divActions);tr.appendChild(tdSign);tr.appendChild(tdType);tr.appendChild(tdActions);(function(d){iconRemove.addEventListener("click",function(){fvdSpeedDial.Storage.removeDeny(d.id)},false);iconEdit.addEventListener("click",function(){fvdSpeedDial.Dialogs.deny(d)},false)})(d);container.appendChild(tr)}oldContainer.parentNode.replaceChild(container,oldContainer)})}},importExport:function(params){var that=this;if(params.type=="export"){var btns={};btns[_("dlg_button_copy_to_clipboard")]=function(){fvdSpeedDial.Utils.copyToClipboard(document.getElementById("importExportTextArea").value);dlg.showActionMessage(_("sah_copied"))};btns[_("dlg_button_close")]=function(){dlg.close()};var dlg=new Dialog({width:400,title:that._title("export"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogExport"),buttons:btns,onShow:function(){document.getElementById("dialogImportExportContainer").setAttribute("type","export");fvdSpeedDial.Utils.Async.chain([function(callback,dataObject){fvdSpeedDial.Storage.dump(function(data){dataObject.db=data;callback()})},function(callback,dataObject){fvdSpeedDial.Prefs.dump(function(data){dataObject.prefs=data;callback()})},function(callback,dataObject){document.getElementById("importExportTextArea").value=JSON.stringify(dataObject)}])}})}else if(params.type=="import"){var btns={};var importInProcess=false;btns[_("dlg_button_import")]=function(){that.confirm(_("dlg_confirm_import_title"),_("dlg_confirm_import_text"),function(r){if(r){var importExportTextArea=document.getElementById("importExportTextArea");var text=importExportTextArea.value.trim();if(text==""){that.errorToField(importExportTextArea,document.body,_("error_must_be_filled"));return}var importData=null;try{importData=JSON.parse(text);importData.db.dials;importData.db.groups;importData.db.deny;if(!importData.prefs){throw""}}catch(ex){try{importData=fvdSpeedDial.importTranslate.translate(JSON.parse(text));if(!importData){throw""}}catch(ex){that.errorToField(importExportTextArea,document.body,_("error_wrong_import_data"));return}}var importContainer=document.getElementById("dialogImportExportContainer");importContainer.setAttribute("type","importing");var statusTextContainer=document.getElementById("importingProcessState");var groupsRelations={};var countGroupsImported=0;var countDialsImported=0;fvdSpeedDial.RuntimeStore.set("importing_in_process",true);fvdSpeedDial.Utils.Async.chain([function(callback){importInProcess=true;statusTextContainer.textContent=_("dlg_importing_step1");fvdSpeedDial.Utils.Async.chain([function(callback2){fvdSpeedDial.Storage.clearDials(callback2)},function(callback2){fvdSpeedDial.Storage.clearDeny(callback2)},function(callback2){fvdSpeedDial.Storage.clearGroups(callback2)},function(){callback()}])},function(callback){statusTextContainer.textContent=_("dlg_importing_step2");for(var k in importData.prefs){fvdSpeedDial.Prefs.set(k,importData.prefs[k])}fvdSpeedDial.Options.refreshOptionValues(function(){fvdSpeedDial.Options.applyChanges(function(){callback()})})},function(callback){statusTextContainer.textContent=_("dlg_importing_step3");if(importData.db.deny.length==0){callback();return}fvdSpeedDial.Utils.Async.arrayProcess(importData.db.deny,function(denyData,callback2){try{fvdSpeedDial.Storage.deny(denyData.type,denyData.sign,function(){callback2()})}catch(ex){callback2()}},function(){callback()})},function(callback){statusTextContainer.textContent=_("dlg_importing_step4");fvdSpeedDial.Utils.Async.arrayProcess(importData.db.groups,function(group,callback2){try{fvdSpeedDial.Storage.groupExists({name:group.name},function(exists){if(exists){callback2()}else{if(group.name&&group.position){fvdSpeedDial.Storage.groupAdd({name:group.name,position:group.position,sync:1,global_id:group.global_id},function(result){if(result.result){countGroupsImported++;groupsRelations[group.id]=result.id}callback2()})}else{callback2()}}})}catch(ex){callback2()}},function(){callback()})},function(callback){statusTextContainer.textContent=_("dlg_importing_step5");fvdSpeedDial.Utils.Async.arrayProcess(importData.db.dials,function(dial,callback2){if(dial.url&&dial.thumb_source_type&&dial.group_id&&dial.position&&groupsRelations[dial.group_id]){try{var dialData={};dial.group_id=groupsRelations[dial.group_id];if(dial.screen_maked==1){dial.screen_maked=0}fvdSpeedDial.Storage.addDial(dial,function(result){if(result.result){countDialsImported++;if(dial.thumb_source_type=="url"&&dial.thumb_url){fvdSpeedDial.ThumbMaker.getImageDataPath({imgUrl:dial.thumb_url,screenWidth:fvdSpeedDial.SpeedDial.getMaxCellWidth()},function(dataUrl){fvdSpeedDial.Storage.updateDial(result.id,{thumb:dataUrl},function(){callback2()})})}else{callback2()}}else{callback2()}})}catch(ex){callback2()}}else{callback2()}},function(){callback()})},function(){statusTextContainer.textContent=_("dlg_importing_finished").replace("%groups%",countGroupsImported).replace("%dials%",countDialsImported);importContainer.setAttribute("type","success");importInProcess=false;fvdSpeedDial.RuntimeStore.set("importing_in_process",false);fvdSpeedDial.Sync.importFinished()}])}})};btns[_("dlg_button_close")]=function(){if(!importInProcess){dlg.close()}else{fvdSpeedDial.Dialogs.alert(_("dlg_alert_wait_importing_title"),_("dlg_alert_wait_importing_text"))}};var dlg=new Dialog({width:400,title:that._title("import"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogExport"),buttons:btns,onShow:function(){document.getElementById("dialogImportExportContainer").setAttribute("type","import")},clickCallback:function(){that.hideErrorBox()},closeCallback:function(){that.hideErrorBox()}})}},viewGroup:function(host){var that=this;that.ViewGroup.currentHost=host;var btns={};btns[_("dlg_button_close")]=function(){dlg.close()};var dlg=new Dialog({width:400,title:that._title("view_group"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogViewGroup"),buttons:btns,onShow:function(){that.ViewGroup.rebuild();document.getElementById("dialogViewGroup_typeTitle").addEventListener("click",function(){fvdSpeedDial.Dialogs.ViewGroup.changeType()},false);document.getElementById("dialogViewGroup_typeUrl").addEventListener("click",function(){fvdSpeedDial.Dialogs.ViewGroup.changeType()},false)}});that.ViewGroup.currentDlg=dlg},ViewGroup:{currentHost:null,currentDlg:null,rebuild:function(){var that=this;fvdSpeedDial.Storage.MostVisited.getDataByHost(fvdSpeedDial.SpeedDial.currentGroupId(),this.currentHost,function(data){var container=document.getElementById("dialogViewGroup_urlContainer");while(container.firstChild){container.removeChild(container.firstChild)}for(var i=0;i!=data.length;i++){var url=document.createElement("a");url.setAttribute("class","url");url.setAttribute("_url",data[i].url);url.setAttribute("href",data[i].url);url.setAttribute("_title",data[i].title);url.setAttribute("id","mostvisitedInGroupUrl_"+data[i].id);var favicon=document.createElement("img");favicon.setAttribute("src","chrome://favicon/"+data[i].url);favicon.setAttribute("width",16);var divText=document.createElement("div");divText.className="text";divText.textContent=data[i].title;var divHits=document.createElement("div");divHits.className="hits";divHits.textContent=data[i].visitCount;url.appendChild(favicon);url.appendChild(divText);url.appendChild(divHits);fvdSpeedDial.ContextMenus.assignToElem(url,"mostvisitedGroupUrl");container.appendChild(url)}document.querySelector("[name=dialogViewGroup_viewType][value="+fvdSpeedDial.Prefs.get("sd.most_visited.group_view_type")+"]").checked=true;that.changeType()})},changeType:function(){var container=document.getElementById("dialogViewGroup_urlContainer");var type=document.querySelector("[name=dialogViewGroup_viewType]:checked").value;var altType=type=="url"?"title":"url";fvdSpeedDial.Prefs.set("sd.most_visited.group_view_type",type);var elems=container.getElementsByClassName("url");for(var i=0;i!=elems.length;i++){var textItem=elems[i].getElementsByClassName("text")[0];var item=elems[i];textItem.textContent=item.getAttribute("_"+type);item.setAttribute("title",item.getAttribute("_"+altType))}}},deny:function(settings){settings=settings||{type:"host",sign:""};var that=this;var btns={};btns[_("dlg_button_deny")]=function(){var type=that.Deny.currentType();var signBox=document.getElementById("dialogDeny_sign");var sign=signBox.value;if(!sign){that.errorToField(signBox,document.body,_("error_must_be_filled"));return false}if(type=="url"){if(!fvdSpeedDial.Utils.isValidUrl(sign)){sign="http://"+sign}}if(settings.id){fvdSpeedDial.Storage.editDeny(settings.id,{sign:sign,type:type},function(result){if(result.result){dlg.close()}else{if(result.error=="deny_already_exists"){that.errorToField(signBox,document.body,_("error_already_exists"))}}})}else{fvdSpeedDial.Storage.deny(type,sign,function(result){if(result.result){dlg.close()}else{if(result.error=="deny_already_exists"){that.errorToField(signBox,document.body,_("error_already_exists"))}}})}};btns[_("dlg_button_cancel")]=function(){dlg.close()};var historyComplete=null;var dlg=new Dialog({width:400,title:settings.id?that._title("edit_deny"):that._title("deny"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogDeny"),buttons:btns,enterOnButton:_("dlg_button_deny"),clickCallback:function(){that.hideErrorBox()},closeCallback:function(){historyComplete.destroy();that.hideErrorBox()},onShow:function(){var denyHostRadio=document.getElementById("dialogDeny_denyHost");var denyURLRadio=document.getElementById("dialogDeny_denyURL");var signBox=document.getElementById("dialogDeny_sign");historyComplete=fvdSpeedDial.HistoryComplete.create(signBox);if(settings.type=="host"){denyHostRadio.setAttribute("checked",true)}else if(settings.type=="url"){denyURLRadio.setAttribute("checked",true)}signBox.setAttribute("value",settings.sign);that.Deny.changeType();document.getElementById("dialogDeny_denyHost").addEventListener("click",function(){fvdSpeedDial.Dialogs.Deny.changeType()},false);document.getElementById("dialogDeny_denyURL").addEventListener("click",function(){fvdSpeedDial.Dialogs.Deny.changeType()},false);document.getElementById("dialogDeny_sign").focus()}})},Deny:{currentType:function(){var denyHostRadio=document.getElementById("dialogDeny_denyHost");var denyURLRadio=document.getElementById("dialogDeny_denyURL");var currentType=null;if(denyHostRadio.checked){currentType="host"}else if(denyURLRadio.checked){currentType="url"}return currentType},changeType:function(){var currentType=this.currentType();var signBox=document.getElementById("dialogDeny_sign");var currUrl=signBox.value;if(currentType=="url"){if(signBox.hasAttribute("urlValue")&&signBox.getAttribute("urlValue")){currUrl=signBox.getAttribute("urlValue")}signBox.value=currUrl}else if(currentType=="host"){signBox.setAttribute("urlValue",currUrl);var host=fvdSpeedDial.Utils.parseUrl(currUrl,"host");if(!host){host=signBox.value}signBox.value=host}}},manageGroups:function(dialogParams){dialogParams=dialogParams||{};var that=this;var btns={};btns[_("dlg_button_save")]=function(){dlg.getMainButton().setAttribute("loading",1);var groups=fvdSpeedDial.Dialogs.ManageGroups.currentGroupsList();var groupIds=[];for(var i=0;i!=groups.length;i++){groupIds.push(parseInt(groups[i].id))}fvdSpeedDial.Storage.groupsList(function(currentGroups){var positionsFunction=function(){fvdSpeedDial.Utils.Async.arrayProcess(groups,function(group,arrayProcessCallback){if(group.id.toString().indexOf("new_")==0){console.log("add group",group);fvdSpeedDial.Storage.groupAdd({name:group.name,sync:group.sync,position:group.position},function(result){console.log("added group",group);if(result.result){fvdSpeedDial.Sync.addDataToSync({category:["groups","newGroups"],data:result.id,translate:"group"})}arrayProcessCallback()})}else{fvdSpeedDial.Storage.groupUpdate(group.id,{position:group.position,name:group.name,sync:group.sync},function(){fvdSpeedDial.Sync.addDataToSync({category:"groups",data:group.id,translate:"group"});arrayProcessCallback()})}},function(){fvdSpeedDial.SpeedDial.sheduleRebuildGroupsList();if(dialogParams.callback){dialogParams.callback(true)}dlg.getMainButton().setAttribute("loading",0);dlg.close()})};var groupsIdsToRemove=[];for(var i=0;i!=currentGroups.length;i++){var currentGroup=currentGroups[i];if(groupIds.indexOf(currentGroup.id)==-1){groupsIdsToRemove.push(currentGroup.id)}}if(groupsIdsToRemove.length>0){for(var i=0;i!=groupsIdsToRemove.length;i++){(function(i){fvdSpeedDial.SpeedDial.removeGroup(groupsIdsToRemove[i],function(){if(i==groupsIdsToRemove.length-1){positionsFunction()}},{noConfirmIfHaveDials:true})})(i)}}else{positionsFunction()}})};btns[_("dlg_button_cancel")]=function(){if(dialogParams.callback){dialogParams.callback(false)}dlg.close()};var leftBtns={};leftBtns[_("dlg_manage_groups_add_group")]=function(){fvdSpeedDial.Dialogs.ManageGroups.addGroup()};var dlg=new Dialog({width:400,title:that._title("manage_groups"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogManageGroups"),buttons:btns,leftButtons:leftBtns,clickCallback:function(){that.hideErrorBox()},closeCallback:function(){that.hideErrorBox()},onShow:function(){fvdSpeedDial.Storage.groupsList(function(groups){var container=document.getElementById("dialogManageGroups_groupsList");for(var i=0;i!=groups.length;i++){var dbGroup=groups[i];var group=fvdSpeedDial.Dialogs.ManageGroups.buildGroupItem(dbGroup);container.appendChild(group)}setTimeout(function(){fvdSpeedDial.Dialogs.ManageGroups.refreshGroupsListDrag()},0)})}})},ManageGroups:{newIdNum:0,buildGroupItem:function(dbGroup){var group=document.createElement("div");var textDiv=document.createElement("div");var spanName=document.createElement("span");spanName.className="groupName";spanName.textContent=dbGroup.name;var spanCount=document.createElement("span");spanCount.className="groupDialsCount";spanCount.textContent=" ("+dbGroup.count_dials+")";textDiv.appendChild(spanName);textDiv.appendChild(spanCount);textDiv.className="text";group.appendChild(textDiv);var divIcons=document.createElement("div");divIcons.className="icons";var iconRemove=document.createElement("div");iconRemove.className="iconRemove";var iconEdit=document.createElement("div");iconEdit.className="iconEdit";divIcons.appendChild(iconRemove);divIcons.appendChild(iconEdit);group.appendChild(divIcons);(function(group,dbGroup){iconRemove.addEventListener("mousedown",function(event){fvdSpeedDial.Dialogs.ManageGroups.removeFromList(group);event.stopPropagation()},false);iconEdit.addEventListener("mousedown",function(event){fvdSpeedDial.Dialogs.ManageGroups.editGroupById(dbGroup.id);event.stopPropagation()},false)})(group,dbGroup);group.id="group_"+dbGroup.id;group.setAttribute("sync",dbGroup.sync);group.className="group";fvdSpeedDial.ContextMenus.assignToElem(group,"speeddialManageGroups");return group},addGroup:function(){var currentGroups=fvdSpeedDial.Dialogs.ManageGroups.currentGroupsList();var groupsNames=[];for(var i=0;i!=currentGroups.length;i++){groupsNames.push(currentGroups[i].name)}fvdSpeedDial.Dialogs.addGroup(null,{commitToCallback:function(dialogResult){if(dialogResult.result){fvdSpeedDial.Dialogs.ManageGroups.addGroupToList(dialogResult.data)}},existsGroupsNames:groupsNames})},addGroupToList:function(dbGroup){this.newIdNum++;dbGroup.count_dials=0;dbGroup.id="new_"+this.newIdNum;var group=this.buildGroupItem(dbGroup);var container=document.getElementById("dialogManageGroups_groupsList");container.appendChild(group);this.refreshGroupsListDrag()},refreshGroupsListDrag:function(){var container=document.getElementById("dialogManageGroups_groupsList");var items=[];var els=document.querySelectorAll("#dialogManageGroups_groupsList .group");for(var i=0;i!=els.length;i++){var el=els[i];items.push(el)}fvdSpeedDial.DragLists.startDragFor(container,items,null,"group")},editGroupById:function(groupId){var currentGroups=fvdSpeedDial.Dialogs.ManageGroups.currentGroupsList();var groupsNames=[];var initData={};for(var i=0;i!=currentGroups.length;i++){if(currentGroups[i].id!=groupId){groupsNames.push(currentGroups[i].name)}else{initData=currentGroups[i]}}fvdSpeedDial.Dialogs.addGroup(groupId,{commitToCallback:function(dialogResult){if(dialogResult.result){fvdSpeedDial.Dialogs.ManageGroups.setGroup(groupId,dialogResult.data)}},existsGroupsNames:groupsNames,initData:initData})},setGroup:function(groupId,group){var groupElem=document.getElementById("group_"+groupId);var spanName=groupElem.getElementsByClassName("groupName")[0];

spanName.textContent=group.name;groupElem.setAttribute("sync",group.sync)},removeFromList:function(group){var groups=group.parentNode.getElementsByClassName("group");if(groups.length==1){fvdSpeedDial.Dialogs.alert(_("dlg_alert_cannot_remove_group_title"),_("dlg_alert_cannot_remove_group_text"));return false}function hide(){group.style.webkitTransitionDuration="200ms";group.style.webkitTransitionProperty="opacity";group.style.opacity=0;group.addEventListener("webkitTransitionEnd",function(event){group.parentNode.removeChild(group)},false)}var groupId=group.getAttribute("id").replace("group_","");fvdSpeedDial.Storage.getGroup(groupId,function(group){if(group!=null){if(group.count_dials==0){hide()}else{fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_group_title"),_("dlg_confirm_remove_group_text").replace("%count%",group.count_dials),function(result){if(result){hide()}})}}else{hide()}})},currentGroupsList:function(){var groups=[];var elems=document.getElementById("dialogManageGroups_groupsList").getElementsByClassName("group");for(var i=0;i!=elems.length;i++){var id=elems[i].getAttribute("id").replace("group_","");var name=elems[i].getElementsByClassName("groupName")[0].textContent;var position=i+1;groups.push({id:id,name:name,position:position,sync:elems[i].getAttribute("sync")})}return groups}},setGroupNoSyncDialog:function(callback){if(_b(fvdSpeedDial.Prefs.get("sd.display_nosync_group_dialog"))){fvdSpeedDial.Dialogs.confirmCheck(_("dlg_nosync_group_title"),_("dlg_nosync_group_text"),_("dlg_dont_show_it_again"),false,function(r,state){if(r){if(state){fvdSpeedDial.Prefs.set("sd.display_nosync_group_dialog",false)}}callback(r)})}else{callback(true)}},moveDialToNoSyncGroupDialog:function(callback){fvdSpeedDial.Utils.Async.chain([function(chainCallback){fvdSpeedDial.Sync.syncAddonExists(function(exists){if(exists){chainCallback()}else{callback(true)}})},function(){if(_b(fvdSpeedDial.Prefs.get("sd.display_move_to_nosync_group_dialog"))){fvdSpeedDial.Dialogs.confirmCheck(_("dlg_move_to_nosync_group_title"),_("dlg_move_to_nosync_group_text"),_("dlg_dont_show_it_again"),false,function(r,state){if(r){if(state){fvdSpeedDial.Prefs.set("sd.display_move_to_nosync_group_dialog",false)}}callback(r)})}else{callback(true)}}])},addGroup:function(groupId,dialogParams){var btns={};var initData={};var buttonAddModifyText=_("dlg_button_add_group");if(groupId){var buttonAddModifyText=_("dlg_button_modify_group")}btns[buttonAddModifyText]=function(){var nameElem=document.getElementById("addGroup_name");var name=nameElem.value.trim();if(!name){that.errorToField(nameElem,document.body,_("error_must_be_filled"));return false}var sync=document.getElementById("addGroup_sync").checked?1:0;if(dialogParams&&dialogParams.commitToCallback){if(dialogParams.existsGroupsNames){var nameLC=name.toLowerCase();for(var i=0;i!=dialogParams.existsGroupsNames.length;i++){if(dialogParams.existsGroupsNames[i].toLowerCase()==nameLC){that.errorToField(nameElem,document.body,_("error_already_exists"));return false}}}dialogParams.commitToCallback({result:true,data:{name:name,sync:sync}});dlg.close()}else{fvdSpeedDial.Storage.groupExists({name:name,excludeIds:groupId?[groupId]:null},function(exists){if(exists){that.errorToField(nameElem,document.body,_("error_already_exists"));return false}else{if(groupId){fvdSpeedDial.Utils.Async.chain([function(chainCallback){if(sync==1||initData.sync==0){chainCallback();return}fvdSpeedDial.Dialogs.setGroupNoSyncDialog(function(set){if(set){chainCallback()}})},function(){fvdSpeedDial.Storage.groupUpdate(groupId,{name:name,sync:sync},function(){fvdSpeedDial.SpeedDial.sheduleRebuildGroupsList();dlg.close()});fvdSpeedDial.Sync.addDataToSync({category:"groups",data:groupId,translate:"group"})}])}else{fvdSpeedDial.Storage.groupAdd({name:name,sync:sync},function(result){if(result.result){fvdSpeedDial.Sync.addDataToSync({category:["groups","newGroups"],data:result.id,translate:"group"});fvdSpeedDial.SpeedDial.setCurrentGroupId(result.id);dlg.close()}})}}})}};btns[_("dlg_button_cancel")]=function(){if(dialogParams&&dialogParams.commitToCallback){dialogParams.commitToCallback({result:false})}dlg.close()};var that=this;var dlg=new Dialog({width:400,title:groupId?this._title("modify_group"):this._title("add_group"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogAddGroup"),buttons:btns,clickCallback:function(){that.hideErrorBox()},closeCallback:function(){that.hideErrorBox()},onShow:function(){if(groupId){fvdSpeedDial.Utils.Async.chain([function(chainCallback){if(dialogParams&&dialogParams.initData){initData=dialogParams.initData;chainCallback()}else{fvdSpeedDial.Storage.getGroup(groupId,function(group){initData=group;chainCallback()})}},function(){document.getElementById("addGroup_name").value=initData.name;if(initData.sync==1){document.getElementById("addGroup_sync").checked=true}}])}document.getElementById("addGroup_name").focus()},enterOnButton:buttonAddModifyText})},AddGroup:{clickSync:function(){fvdSpeedDial.Sync.syncAddonExists(function(exists){if(!exists){var cb=document.getElementById("addGroup_sync");cb.checked=!cb.checked;fvdSpeedDial.Dialogs.installFVDSync()}})}},installFVDSync:function(){var btns={};btns[_("dlg_button_close")]=function(){dlg.close()};var dlg=new Dialog({width:400,title:this._title("install_fvd_sync"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogInstallSync"),buttons:btns,enterOnButton:_("dlg_button_close")})},addDial:function(dialData,type,forceAdd,_callback){var dialId=null;type=type||"speeddial";if(type=="speeddial"&&!forceAdd&&dialData){dialId=dialData.id}if(type=="mostvisited"&&!forceAdd){dialId=dialData.id}var btns={};var that=this;var buttonAddModifyText=_("dlg_button_add_dial");if(dialId){var buttonAddModifyText=_("dlg_button_modify_dial")}function setupPickFrom(){function buildUrlsListing(urls){var listingContianer=document.createElement("div");listingContianer.className="toolTipUrlsList";urls.forEach(function(item){var u=document.createElement("div");u.className="elem";var uUrl=document.createElement("div");uUrl.className="url";var uTitle=document.createElement("div");uTitle.className="title";uTitle.textContent=item.title;uUrl.textContent=item.url;u.appendChild(uTitle);u.appendChild(uUrl);u.addEventListener("click",function(){document.getElementById("addDialog_url").value=item.url;document.getElementById("addDialog_title").value=item.title;document.getElementById("addDialog_title").removeAttribute("autotext");fvdSpeedDial.ToolTip.close()});listingContianer.appendChild(u)});return listingContianer}var pickFromTabs=document.getElementById("addDialog_pickFromOpenedTabs");var pickFromMostvisited=document.getElementById("addDialog_pickFromMostVisited");var pickFromMostPopular=document.getElementById("addDialog_pickFromMostPopular");pickFromMostPopular.addEventListener("click",function(event){that.PicsUserPics.request("country_top.php",{},function(error,data){if(error){return}var items=[];data.domains.forEach(function(domain){items.push({url:"http://"+domain,title:domain})});fvdSpeedDial.ToolTip.display(pickFromMostPopular,buildUrlsListing(items),event)})});pickFromTabs.addEventListener("click",function(event){chrome.tabs.query({},function(_tabs){var tabs=[];_tabs.forEach(function(tab){if(tab.url.indexOf("http")!==0){return}if(!tab.title){tab.title="..."}tabs.push(tab)});if(tabs.length>0){fvdSpeedDial.ToolTip.display(pickFromTabs,buildUrlsListing(tabs),event)}})});pickFromMostvisited.addEventListener("click",function(event){fvdSpeedDial.Storage.MostVisited.getData({interval:"month",type:"host",count:25},function(_tabs){var tabs=[];_tabs.forEach(function(tab){if(!tab.title){return}tabs.push(tab)});if(tabs.length>0){fvdSpeedDial.ToolTip.display(pickFromMostvisited,buildUrlsListing(tabs),event)}})})}btns[buttonAddModifyText]=function(){var backgroundUrl="";if(!document.getElementById("addDialog_image_url").hasAttribute("autoText")){backgroundUrl=document.getElementById("addDialog_image_url").value}var url=document.getElementById("addDialog_url").value.trim();var title=document.getElementById("addDialog_title").value.trim();var groupValue=document.getElementById("addDialog_group").value;var groupNameNode=document.getElementById("addDialog_groupName");var groupName=groupNameNode.value.trim();var customPreviewCheckbox=document.getElementById("addDialog_useCustomPreview");var manualPreviewRadio=document.getElementById("addDialog_useManualPreview");var autoPreviewRadio=document.getElementById("addDialog_useAutoPreview");var autoPreviewUpdateEnabled=document.getElementById("addDialog_autoupdate_preview_enable").checked;var autoPreviewUpdateInterval=parseInt(document.getElementById("addDialog_autoupdate_preview_interval").value,10);var autoPreviewUpdateIntervalType=document.getElementById("addDialog_autoupdate_preview_interval_type").value;var updateInterval="";if(!autoPreviewRadio.checked||isNaN(autoPreviewUpdateInterval)){autoPreviewUpdateEnabled=false}if(autoPreviewUpdateEnabled){updateInterval=autoPreviewUpdateInterval+"|"+autoPreviewUpdateIntervalType}var screenDelay=0;if(!url){that.errorToField(document.getElementById("addDialog_url"),document.body,_("error_must_be_filled"));return false}if(!fvdSpeedDial.Utils.isValidUrl(url)){url="http://"+url;if(!fvdSpeedDial.Utils.isValidUrl(url)){that.errorToField(document.getElementById("addDialog_url"),document.body,_("error_invalid_url"));return false}}var getScreenMethod="auto";if(customPreviewCheckbox.checked){getScreenMethod="custom"}else if(manualPreviewRadio.checked){getScreenMethod="manual"}function sdUserPicsPreviewsAfterAdd(){if(getScreenMethod=="custom"&&fvdSpeedDial.Dialogs.AddDial.pickedUserPreview){if(fvdSpeedDial.Dialogs.AddDial.pickedUserPreview.url==backgroundUrl){fvdSpeedDial.Dialogs.PicsUserPics.rate(fvdSpeedDial.Dialogs.AddDial.pickedUserPreview.id)}}}var afterTitle=function(){if(type=="speeddial"){if(groupValue==0&&!groupName){that.errorToField(groupNameNode,document.body,_("error_must_be_filled"));return false}var getGroupValue=function(callback){if(groupValue==0){fvdSpeedDial.Storage.groupExists({name:groupName},function(exists){if(exists){that.errorToField(groupNameNode,document.body,_("error_already_exists"))}else{fvdSpeedDial.Storage.groupAdd({name:groupName,sync:1},function(result){if(result.result){fvdSpeedDial.Sync.addDataToSync({category:["groups","newGroups"],data:result.id,translate:"group"});callback(result.id)}})}})}else{callback(groupValue)}};fvdSpeedDial.Storage.isDenyUrl(url,function(deny,denyDetails){if(deny){that.errorToField(document.getElementById("addDialog_url"),document.body,_("error_url_deny_"+denyDetails.deny.type))}else{fvdSpeedDial.Storage.dialExists({url:url,excludeIds:dialId?[dialId]:null},function(exists){function afterCheck(){var thumb_source_type="screen";var addDial=function(dataUrl,thumbSize,need_sync_screen){need_sync_screen=need_sync_screen?1:0;dataUrl=dataUrl||"";if(dialId){fvdSpeedDial.Storage.getDial(dialId,function(dialDataOld){getGroupValue(function(groupValue){var updateData={title:title,url:url,thumb_source_type:thumb_source_type,thumb_url:backgroundUrl,group_id:groupValue,screen_delay:screenDelay,get_screen_method:getScreenMethod,need_sync_screen:need_sync_screen,update_interval:updateInterval};if(thumbSize){updateData.thumb_width=thumbSize.width;updateData.thumb_height=thumbSize.height}if(dialDataOld.url!=url){updateData.auto_title=""}if(dialDataOld.thumb_source_type=="url"){if(thumb_source_type=="screen"){dataUrl="";updateData.screen_maked=0}}else if(thumb_source_type=="screen"){if(dialDataOld.url!=url){updateData.screen_maked=0}else if(getScreenMethod!=dialDataOld.get_screen_method){dataUrl="";updateData.screen_maked=0}else{dataUrl=dialDataOld.thumb}}else if(thumb_source_type=="local_file"){}updateData.thumb=dataUrl;fvdSpeedDial.Storage.updateDial(dialId,updateData,function(){fvdSpeedDial.Sync.addDataToSync({category:"dials",data:dialId,translate:"dial"});fvdSpeedDial.SpeedDial.sheduleFullRebuild();sdUserPicsPreviewsAfterAdd();if(_callback){_callback()}dlg.close()})})})}else{getGroupValue(function(groupValue){if(!dataUrl){var screen=document.getElementById("addDialog_previewCell");if(screen.hasAttribute("screen")){dataUrl=screen.getAttribute("screen")}}var addData={url:url,title:title,thumb_source_type:thumb_source_type,thumb_url:backgroundUrl,group_id:groupValue,thumb:dataUrl,screen_delay:screenDelay,get_screen_method:getScreenMethod,need_sync_screen:need_sync_screen,update_interval:updateInterval};if(thumbSize){addData.thumb_width=thumbSize.width;addData.thumb_height=thumbSize.height}fvdSpeedDial.Storage.addDial(addData,function(result){if(result.result){fvdSpeedDial.Sync.addDataToSync({category:["dials","newDials"],data:result.id,translate:"dial"});fvdSpeedDial.SpeedDial.justAddedId=result.id;setTimeout(function(){if(fvdSpeedDial.SpeedDial.currentDisplayType()!="speeddial"){fvdSpeedDial.SpeedDial.setCurrentDisplayType("speeddial")}if(fvdSpeedDial.SpeedDial.currentGroupId()!=groupValue){fvdSpeedDial.SpeedDial.setCurrentGroupId(groupValue)}fvdSpeedDial.SpeedDial.sheduleFullRebuild()},200)}sdUserPicsPreviewsAfterAdd();dlg.close();if(_callback){_callback()}})})}};if(backgroundUrl&&customPreviewCheckbox.checked){thumb_source_type="url";if(backgroundUrl!=fvdSpeedDial.Const.LOCAL_FILE_URL){fvdSpeedDial.ThumbMaker.getImageDataPath({imgUrl:backgroundUrl,screenWidth:fvdSpeedDial.SpeedDial.getMaxCellWidth()},function(dataUrl,thumbSize){addDial(dataUrl,thumbSize)})}else{thumb_source_type="local_file";var previewCell=document.getElementById("addDialog_previewCell");var dataUrl=previewCell.getAttribute("syncScreen");var thumbSize={width:previewCell.getAttribute("syncScreenWidth"),height:previewCell.getAttribute("syncScreenHeight")};addDial(dataUrl,thumbSize,fvdSpeedDial.Dialogs.AddDial.localFileChanged())}}else{addDial()}}if(exists&&!dialId){if(_b(fvdSpeedDial.Prefs.get("sd.display_dial_already_exists_dialog"))){that.confirmCheck(_("dlg_confirm_dial_exists_title"),_("dlg_confirm_dial_exists_text"),_("newtab_do_not_display_migrate"),false,function(result,cbResult){if(cbResult){fvdSpeedDial.Prefs.set("sd.display_dial_already_exists_dialog",false)}if(result){afterCheck()}})}else{afterCheck()}}else{afterCheck()}})}})}else if(type=="mostvisited"){if(dialId){var thumb_source_type="screen";var screen=document.getElementById("addDialog_previewCell");var modifyMostVisited=function(dataUrl,thumbSize){if(typeof dataUrl=="undefined"){if(screen.hasAttribute("screen")){dataUrl=screen.getAttribute("screen")}}dataUrl=dataUrl||"";var updateData={thumb:dataUrl,title:title,thumb_source_type:thumb_source_type,thumb_url:backgroundUrl,screen_delay:screenDelay,get_screen_method:getScreenMethod};if(thumbSize){updateData.thumb_width=thumbSize.width;updateData.thumb_height=thumbSize.height}if(thumb_source_type=="screen"&&!dataUrl){updateData.screen_maked=0}fvdSpeedDial.Storage.MostVisited.updateData(dialId,updateData,function(){fvdSpeedDial.SpeedDial.sheduleFullRebuild();sdUserPicsPreviewsAfterAdd();dlg.close()})};if(backgroundUrl&&customPreviewCheckbox.checked){thumb_source_type="url";if(backgroundUrl==fvdSpeedDial.Const.LOCAL_FILE_URL&&screen.hasAttribute("syncscreen")){thumb_source_type="local_file";backgroundUrl=screen.getAttribute("syncscreen")}fvdSpeedDial.ThumbMaker.getImageDataPath({imgUrl:backgroundUrl,screenWidth:fvdSpeedDial.SpeedDial.getMaxCellWidth()},function(dataUrl,thumbSize){modifyMostVisited(dataUrl,thumbSize)})}else{modifyMostVisited()}}}};if(document.getElementById("addDialog_title").hasAttribute("autoText")){title="";afterTitle()}else{if(!title){that.errorToField(document.getElementById("addDialog_title"),document.body,_("error_must_be_filled"));return false}afterTitle()}};btns[_("dlg_button_cancel")]=function(){dlg.close()};var historyComplete=null;fvdSpeedDial.Dialogs.AddDial.pickedUserPreview=null;var _testInputUrlValue={oldValue:"",interval:null,listener:null,start:function(){var that=this;this.interval=setInterval(function(){var value=document.getElementById("addDialog_url").value;if(value!=that.oldValue){that.oldValue=value;if(that.listener){that.listener()}}},100)},end:function(){clearInterval(this.interval)}};var dlg=new Dialog({width:414,title:dialId?this._title("modify_dial"):this._title("add_dial"),content:fvdSpeedDial.Templates.getHTML("prototype_dialogAddDial"),buttons:btns,enterOnButton:buttonAddModifyText,clickCallback:function(){that.hideErrorBox()},closeCallback:function(){_testInputUrlValue.end();if(historyComplete){historyComplete.destroy()}that.hideErrorBox()},onShow:function(){var pickLocalFile=document.querySelector("#addDialog_PickLocalFileContainer a");pickLocalFile.addEventListener("click",function(event){var text=_("bg_dialog_adddial_pick_local_file_desc");if(navigator.userAgent.toLowerCase().indexOf("windows")!=-1){text=text.replace("{examples}",_("bg_dialog_adddial_pick_local_file_desc_win"))}else{text=text.replace("{examples}",_("bg_dialog_adddial_pick_local_file_desc_linux"))}fvdSpeedDial.ToolTip.display(pickLocalFile,text,event,true);event.preventDefault()},false);_testInputUrlValue.listener=function(){setTimeout(function(){fvdSpeedDial.Dialogs.AddDial.showFastUserPics()},0)};_testInputUrlValue.start();setTimeout(function(){dlg._wrapper.setAttribute("id","addDialog_wrapper")},0);setupPickFrom();document.querySelector("#addDialogPickImages .showMoreContainer button").addEventListener("click",function(){document.getElementById("addDialog_pickUserPic").click()},false);document.getElementById("addDialog_pickUserPic").addEventListener("click",function(){var url=document.getElementById("addDialog_url").value.toLowerCase();if(url.indexOf("http")!==0){url="http://"+url}var host=fvdSpeedDial.Utils.parseUrl(url,"host");dlg.container.style.display="none";fvdSpeedDial.Dialogs.pickUserPics({host:host},function(result){dlg.container.style.display="";if(result){fvdSpeedDial.Dialogs.AddDial.setPickedUserPreview(result)}})},false);document.getElementById("addDialog_autoupdate_preview_enable").addEventListener("change",function(){fvdSpeedDial.Dialogs.AddDial.applyAutoPreviewEnabled()});if(!dialData&&type=="speeddial"){document.getElementById("addDialog_PickFromContainer").removeAttribute("hidden")}var afterAll=function(){fvdSpeedDial.Utils.setAutoTextForTextField(document.getElementById("addDialog_title"),_("dialog_add_dial_dynamic_title"));fvdSpeedDial.Utils.setAutoTextForTextField(document.getElementById("addDialog_image_url"),_("dialog_add_dial_enter_image_url"))};if(type=="speeddial"){historyComplete=fvdSpeedDial.HistoryComplete.create(document.getElementById("addDialog_url"));var fillGroups=function(selectGroup){fvdSpeedDial.Storage.groupsList(function(groups){var selectGroups=document.getElementById("addDialog_group");selectGroups.options.length=0;for(var i=0;i!=groups.length;i++){var option=document.createElement("option");option.textContent=groups[i].name;option.value=groups[i].id;selectGroups.appendChild(option)}var option=document.createElement("option");option.textContent=_("dlg_adddial_create_group");option.value=0;option.className="createNewGroup";selectGroups.appendChild(option);if(selectGroup){selectGroups.value=selectGroup}else{selectGroups.selectedIndex=0}that.AddDial.changeGroup()})};document.getElementById("addDialog_url").focus()}if(dialData){document.getElementById("addDialog_url").value=dialData.url;document.getElementById("addDialog_title").value=dialData.title;var customPreviewCheckbox=document.getElementById("addDialog_useCustomPreview");if(dialData.thumb_source_type=="url"){var isDefaultPreview=false;var select=document.getElementById("addDialog_default_image");for(var i=0;i!=select.options.length;i++){var option=select.options[i];if(option.value.indexOf(dialData.thumb_url)!=-1){isDefaultPreview=true;select.value=option.value;that.AddDial.selectDefaultPreview(select);if(select.value.indexOf("|")!=-1){var extSelect=document.getElementById("addDialog_default_image_ext");extSelect.value=dialData.thumb_url;that.AddDial.selectDefaultPreview(extSelect)}break}}if(!isDefaultPreview){document.getElementById("addDialog_image_url").value=dialData.thumb_url;that.AddDial.refreshPreview()}customPreviewCheckbox.checked=true}else if(dialData.thumb_source_type=="local_file"){document.getElementById("addDialog_image_url").value=fvdSpeedDial.Const.LOCAL_FILE_URL;customPreviewCheckbox.checked=true;document.getElementById("addDialog_previewCell").setAttribute("syncScreen",dialData.thumb);document.getElementById("addDialog_previewCell").setAttribute("syncScreenWidth",dialData.thumb_width);document.getElementById("addDialog_previewCell").setAttribute("syncScreenHeight",dialData.thumb_height);that.AddDial.refreshPreview()}else if(dialData.thumb_source_type=="screen"){if(dialData.screen_maked==1){document.getElementById("addDialog_previewCell").setAttribute("screen",dialData.thumb);that.AddDial.refreshPreview()}customPreviewCheckbox.checked=false;if(dialData.get_screen_method=="manual"){document.getElementById("addDialog_useManualPreview").checked=true}else{document.getElementById("addDialog_useAutoPreview").checked=true}}if(type=="speeddial"){fillGroups(dialData.group_id);if(dialData.update_interval){var tmp=dialData.update_interval.split("|");if(tmp.length==2){document.getElementById("addDialog_autoupdate_preview_enable").checked=true;document.getElementById("addDialog_autoupdate_preview_interval").value=tmp[0];document.getElementById("addDialog_autoupdate_preview_interval_type").value=tmp[1]}}}else if(type=="mostvisited"){var selectGroups=document.getElementById("addDialog_group");selectGroups.parentNode.parentNode.setAttribute("hidden",true);document.getElementById("addDialog_url").setAttribute("disabled",true)}afterAll()}else{var groupId=fvdSpeedDial.SpeedDial.currentGroupId();if(groupId==0){groupId=fvdSpeedDial.Prefs.get("sd.default_group");if(groupId==0||groupId==-1){fvdSpeedDial.Storage.groupsList(function(groups){if(groups.length>0){groupId=groups[0].id}fillGroups(groupId);afterAll()})}else{fillGroups(groupId);afterAll()}}else{fillGroups(groupId);afterAll()}}fvdSpeedDial.Dialogs.AddDial.refreshCustomPreviewState();document.getElementById("addDialog_title").addEventListener("focus",function(){fvdSpeedDial.Dialogs.AddDial.focusTitle()},false);document.getElementById("addDialog_group").addEventListener("change",function(){fvdSpeedDial.Dialogs.AddDial.changeGroup()},false);var radioButtonsPreviewType=document.querySelectorAll(".addDialog_selectPreviewTypeBlock input");for(var i=0;i!=radioButtonsPreviewType.length;i++){radioButtonsPreviewType[i].addEventListener("click",function(){fvdSpeedDial.Dialogs.AddDial.refreshCustomPreviewState()},false)}document.getElementById("addDialog_uploadFile").addEventListener("change",function(){fvdSpeedDial.Dialogs.AddDial.selectLocalFile()},false);document.getElementById("addDialog_default_image").addEventListener("change",function(){fvdSpeedDial.Dialogs.AddDial.selectDefaultPreview(document.getElementById("addDialog_default_image"))},false);document.getElementById("addDialog_default_image_ext").addEventListener("change",function(){fvdSpeedDial.Dialogs.AddDial.selectDefaultPreview(document.getElementById("addDialog_default_image_ext"))},false);document.getElementById("addDialog_uploadFileContainer").addEventListener("click",function(){document.getElementById("addDialog_uploadFileContainer").getElementsByTagName("input")[0].click()},false);document.getElementById("addDialog_refreshPreview").addEventListener("click",function(){fvdSpeedDial.Dialogs.AddDial.refreshPreview()},false);that.AddDial.applyAutoPreviewEnabled()}})},AddDial:{pickedUserPreview:null,setPickedUserPreview:function(pickedUserPreview){var cb=document.getElementById("addDialog_useCustomPreview");if(!cb.checked){cb.click()}this.pickedUserPreview=pickedUserPreview;document.getElementById("addDialog_image_url").value=pickedUserPreview.url;document.getElementById("addDialog_image_url").removeAttribute("autotext");this.refreshPreview()},applyAutoPreviewEnabled:function(){var enabled=document.getElementById("addDialog_autoupdate_preview_enable").checked;var interval=document.getElementById("addDialog_autoupdate_preview_interval");var intervalType=document.getElementById("addDialog_autoupdate_preview_interval_type");if(enabled){interval.removeAttribute("disabled");intervalType.removeAttribute("disabled")}else{interval.setAttribute("disabled",1);intervalType.setAttribute("disabled",1)}},showFastUserPics:function(){var wrapper=document.getElementById("addDialog_wrapper");if(!wrapper){return}wrapper.removeAttribute("withPreview");var that=fvdSpeedDial.Dialogs;var url=document.getElementById("addDialog_url").value;var urlLower=url.toLowerCase();if(urlLower.indexOf("http://")==-1&&urlLower.indexOf("https://")==-1){url="http://"+url}var parsed=fvdSpeedDial.Utils.parseUrl(url);if(!parsed||!parsed.host){return}var tmp=parsed.host.split(".");if(tmp.length<2){return}var zone=tmp[tmp.length-1];if(zone.length<2){return}that.PicsUserPics.cancelCurrentRequests();that.PicsUserPics.request("listing.php",{p:0,order:"rating",host:parsed.host,on_page:10},function(error,data){if(error){console.log("Fail get preview pics",error);return}if(data.previews.length>0){wrapper.setAttribute("withPreview",1);document.getElementById("addDialogPickImages").scrollTop=0;var container=document.querySelector("#addDialogPickImages .picsContainer");while(container.firstChild){container.removeChild(container.firstChild)}data.previews.forEach(function(preview){var previewElem=that.PicsUserPics.buildElem(preview,{resultCallback:function(preview){fvdSpeedDial.Dialogs.AddDial.setPickedUserPreview(preview)}},{close:function(){wrapper.removeAttribute("withPreview")}});container.appendChild(previewElem)})}else{console.log("Not found previews")}})},refreshCustomPreviewState:function(){var useCustomPreview=document.getElementById("addDialog_useCustomPreview").checked;var useAutoPreview=document.getElementById("addDialog_useAutoPreview").checked;var customPreviewBlock=document.getElementById("addDialog_customPreviewBlock");var autoPreviewBlock=document.getElementById("addDialog_autoPreviewBlock");if(useCustomPreview){customPreviewBlock.removeAttribute("hidden")}else{customPreviewBlock.setAttribute("hidden",true)}if(useAutoPreview&&fvdSpeedDial.Config.AUTOUPDATE_PREVIEW_ENABLED&&fvdSpeedDial.SpeedDial.currentDisplayType()=="speeddial"){autoPreviewBlock.removeAttribute("hidden")}else{autoPreviewBlock.setAttribute("hidden",true)}},getTitle:function(callback){var link=document.getElementById("addDialog_getTitle");link.setAttribute("loading",1);link.getElementsByTagName("div")[0].textContent=_("bg_dialog_loading");var url=document.getElementById("addDialog_url").value;if(!fvdSpeedDial.Utils.isValidUrl(url)){url="http://"+url}fvdSpeedDial.Utils.getTitleForUrl(url,function(title){if(title){document.getElementById("addDialog_title").value=title;document.getElementById("addDialog_title").removeAttribute("autoText")}link.getElementsByTagName("div")[0].textContent=_("bg_dialog_adddial_click_to_get_title");link.removeAttribute("loading");if(callback){callback(title)}})},changeGroup:function(){var groupValue=document.getElementById("addDialog_group").value;var groupName=document.getElementById("addDialog_groupName").parentNode.parentNode;if(groupValue==0){groupName.removeAttribute("hidden");document.getElementById("addDialog_groupName").focus()}else{groupName.setAttribute("hidden",true)}},focusTitle:function(){try{var title=document.getElementById("addDialog_title").value;if(!title){var url=document.getElementById("addDialog_url").value;var host=fvdSpeedDial.Utils.parseUrl(url,"host");if(host){host=host.charAt(0).toUpperCase()+host.slice(1);document.getElementById("addDialog_title").value=host}}}catch(ex){}},localFileChanged:function(){return document.querySelector("#addDialog_uploadFileContainer input").getAttribute("fvdsd-changed")},selectLocalFile:function(){var that=this;try{var file=document.querySelector("#addDialog_uploadFileContainer input").files[0];if(file.type.indexOf("image/")!==0){fvdSpeedDial.Dialogs.errorToField(document.getElementById("addDialog_image_url"),document.body,_("error_not_image"))}else{document.querySelector("#addDialog_uploadFileContainer input").setAttribute("fvdsd-changed",1);var reader=new FileReader;reader.onload=function(){fvdSpeedDial.ThumbMaker.getImageDataPath({imgUrl:reader.result,screenWidth:fvdSpeedDial.SpeedDial.getMaxCellWidth()},function(dataUrl,thumbSize){var img=new Image;img.onload=function(){var previewCell=document.getElementById("addDialog_previewCell");previewCell.setAttribute("syncScreen",dataUrl);previewCell.setAttribute("syncScreenWidth",img.width);previewCell.setAttribute("syncScreenHeight",img.height);that.refreshPreview()};img.src=dataUrl;document.getElementById("addDialog_image_url").removeAttribute("autoText");document.getElementById("addDialog_image_url").value=fvdSpeedDial.Const.LOCAL_FILE_URL})};reader.readAsDataURL(file)}}catch(ex){}},refreshPreview:function(){var previewCell=document.getElementById("addDialog_previewCell");var screen=previewCell.getElementsByClassName("preview-image")[0];var backgroundUrl=document.getElementById("addDialog_image_url").value;if(backgroundUrl==fvdSpeedDial.Const.LOCAL_FILE_URL){var screen=previewCell.getElementsByClassName("preview-image")[0];previewCell.setAttribute("filled",1);fvdSpeedDial.Utils.setUrlPreview({elem:screen,size:{width:screen.offsetWidth,height:screen.offsetHeight}},{url:previewCell.getAttribute("syncScreen")})}else if(backgroundUrl){previewCell.setAttribute("filled",1);var screen=previewCell.getElementsByClassName("preview-image")[0];fvdSpeedDial.Utils.setUrlPreview({elem:screen,size:{width:screen.offsetWidth,height:screen.offsetHeight}},{url:backgroundUrl})}else{if(previewCell.hasAttribute("screen")){fvdSpeedDial.Utils.setScreenPreview(document.getElementById("addDialog_previewCell").getElementsByClassName("preview-image")[0],previewCell.getAttribute("screen"));previewCell.setAttribute("filled",1)}else{previewCell.setAttribute("filled",0);screen.style.background=""}}},selectDefaultPreview:function(fromSelect){var url=fromSelect.value;var extSelectContainer=document.getElementById("addDialog_default_image_extContainer");var extSelect=document.getElementById("addDialog_default_image_ext");var select=document.getElementById("addDialog_default_image");if(url.indexOf("|")==-1){document.getElementById("addDialog_image_url").removeAttribute("autoText");document.getElementById("addDialog_image_url").value=url;if(fromSelect!=extSelect){extSelectContainer.setAttribute("hidden",true)}this.refreshPreview()}else{var selectedText=select.options[select.selectedIndex].text;var urls=url.split("|");extSelect.options.length=0;for(var i=0;i!=urls.length;i++){extSelect.options[extSelect.options.length]=new Option(selectedText+" #"+(i+1),urls[i])}extSelectContainer.removeAttribute("hidden");this.selectDefaultPreview(extSelect)}}},_title:function(code){return _("dialog_title_"+code)}};fvdSpeedDial.Dialogs=new Dialogs;Broadcaster.onMessage.addListener(function(msg){if(msg.action=="deny:changed"){fvdSpeedDial.Dialogs.ManageDeny.refresh(msg.data)}})})();(function(){var _HistoryComplete=function(elem){this._elem=elem;this._init()};_HistoryComplete.prototype={_elem:null,_completionContainer:null,_maxResults:25,_focusedIndex:-1,_completeElements:[],_document:null,_bodyClickListener:null,destroy:function(){try{this._completionContainer.parentNode.removeChild(this._completionContainer)}catch(ex){}},_displayed:function(){if(this._completionContainer&&this._completionContainer.getAttribute("appear")==1){return true}return false},_init:function(){this._document=this._elem.ownerDocument;var that=this;this._elem.addEventListener("blur",function(){that._hideContainer()},false);this._elem.addEventListener("keydown",function(event){if(event.keyCode==40){if(that._displayed()){that._focusedIndex++;if(that._focusedIndex>=that._completeElements.length){that._focusedIndex=0}that._refreshFocus();event.stopPropagation();event.preventDefault();that._applyFocused(true);

}else{var v=that._elem.value.trim();if(!v){v=null}that._searchInHistory(v,function(results){if(results.set.length==0){that._hideContainer()}else{that._displayContainer(results.set)}})}}else if(event.keyCode==38){if(that._displayed()){that._focusedIndex--;if(that._focusedIndex<0){that._focusedIndex=that._completeElements.length-1}that._refreshFocus();event.stopPropagation();event.preventDefault();that._applyFocused(true)}}else if(event.keyCode==13){if(that._displayed()&&that._focusedIndex!=-1){that._applyFocused();event.stopPropagation();event.preventDefault()}}});this._elem.addEventListener("keyup",function(event){if([13,38,40].indexOf(event.keyCode)!=-1){event.stopPropagation();return}var text=that._elem.value.trim();if(!text){that._hideContainer()}else{that._searchInHistory(text,function(results){if(results.set.length==0){that._hideContainer()}else{that._displayContainer(results.set)}})}})},_focusElement:function(index){this._focusedIndex=index;this._refreshFocus()},_dropElementsFocus:function(){this._focusedIndex=-1;this._refreshFocus()},_applyFocused:function(preventHide){try{var focused=this._completeElements[this._focusedIndex];var url=focused.getAttribute("suggestion");this._elem.value=url;if(!preventHide){this._hideContainer()}}catch(ex){}},_refreshFocus:function(){var focusedElem=null;for(var i=0;i!=this._completeElements.length;i++){if(this._focusedIndex==i){this._completeElements[i].setAttribute("focused",1);focusedElem=this._completeElements[i]}else{this._completeElements[i].removeAttribute("focused")}}if(focusedElem){var visbleStart=this._getContainer().scrollTop;var visibleEnd=visbleStart+this._getContainer().offsetHeight;var needScrollDelta=0;var startElem=focusedElem.offsetTop;var endElem=startElem+focusedElem.offsetHeight;if(endElem>visibleEnd){needScrollDelta=endElem-visibleEnd}if(startElem<visbleStart){needScrollDelta=startElem-visbleStart}if(needScrollDelta!=0){this._getContainer().scrollTop+=needScrollDelta}}},_searchInHistory:function(query,callback){var that=this;fvdSpeedDial.HistoryComplete.searchInHistory(query,that._maxResults,function(results){callback({query:query,set:results})})},_getContainer:function(){if(this._completionContainer==null){this._completionContainer=this._document.createElement("div");this._completionContainer.className="historyComplete";var elemPos=fvdSpeedDial.Utils.getOffset(this._elem);this._completionContainer.style.left=elemPos.left+"px";this._completionContainer.style.top=elemPos.top+this._elem.offsetHeight+"px";this._completionContainer.style.width=this._elem.offsetWidth-2+"px";this._completionContainer.setAttribute("appear",0);this._document.body.appendChild(this._completionContainer)}return this._completionContainer},_displayContainer:function(results){var that=this;that._focusedIndex=-1;var tmp=this._getContainer().cloneNode(true);while(tmp.firstChild){tmp.removeChild(tmp.firstChild)}this._completeElements=[];for(var i=0;i!=results.length;i++){var favicon=this._document.createElement("img");favicon.setAttribute("src","chrome://favicon/"+results[i].url);var elem=this._document.createElement("div");elem.className="elem";var urlDiv=this._document.createElement("div");urlDiv.className="url";var titleDiv=this._document.createElement("div");titleDiv.className="title";urlDiv.innerHTML=results[i].url;titleDiv.appendChild(favicon);var titleTextDiv=this._document.createElement("div");titleTextDiv.innerHTML=results[i].title;titleDiv.appendChild(titleTextDiv);elem.appendChild(titleDiv);elem.appendChild(urlDiv);elem.setAttribute("suggestion",results[i].rawurl);(function(i){elem.addEventListener("mousedown",function(){that._applyFocused()},false);elem.addEventListener("mouseover",function(){that._focusElement(i)},false);elem.addEventListener("mouseout",function(){that._dropElementsFocus()},false)})(i);this._completeElements.push(elem);tmp.appendChild(elem)}var oldContainer=this._getContainer();oldContainer.parentNode.replaceChild(tmp,oldContainer);this._completionContainer=tmp;tmp.setAttribute("appear",1);if(!this._bodyClickListener){this._bodyClickListener=function(){that._hideContainer()};this._document.body.addEventListener("click",this._bodyClickListener,false)}},_hideContainer:function(){this._getContainer().setAttribute("appear",0);if(this._bodyClickListener){this._document.body.removeEventListener("click",this._bodyClickListener);this._bodyClickListener=null}}};var HistoryComplete=function(){};HistoryComplete.prototype={get _cache(){var c=localStorage["historycomplete:history_cache"];if(c&&typeof c=="string"){c=JSON.parse(c)}c=c||null;return c},set _cache(v){localStorage["historycomplete:history_cache"]=JSON.stringify(v)},_maxCacheRecords:2e3,create:function(elem){this.clearHistoryCache();return new _HistoryComplete(elem)},clearHistoryCache:function(){this._cache=null},getHistory:function(callback){var that=this;if(this._cache==null){chrome.history.search({text:"",maxResults:that._maxCacheRecords*2,startTime:0,endTime:(new Date).getTime()},function(_results){var results=[];for(var i=0;i!=_results.length&&results.length<that._maxCacheRecords;i++){var r=_results[i];var urllower=r.url.toLowerCase();if(urllower.indexOf("chrome")==0||urllower.indexOf("file:///")===0||urllower.indexOf("data:")===0){continue}var host="";try{host=fvdSpeedDial.Utils.parseUrl(urllower,"host").replace(/^www\./,"")}catch(ex){}results.push({url:r.url,title:r.title,_lurl:urllower,_ltitle:r.title.toLowerCase(),host:host,visitCount:r.visitCount})}results.sort(function(a,b){return b.visitCount-a.visitCount});that._cache=results;callback(results)})}else{callback(this._cache)}},searchInHistory:function(query,maxResults,callback){this.getHistory(function(data){var results=[];if(query==null){for(var i=0;i!=data.length&&results.length<maxResults;i++){results.push({url:data[i].url,title:data[i].title,rawurl:data[i].url})}callback(results);return}query=query.toLowerCase();var queryHost=query;queryHost=queryHost.replace(/^https:\/\//,"").replace(/^http:\/\//,"").replace(/www\./,"");var preMatches=[];for(var i=0;i!=data.length;i++){var points=0;var foundByQueryHost=false;if(data[i]._lurl.indexOf(query)!=-1){points=1;if(data[i].host&&data[i].host.indexOf(query)===0){points+=1}}else if(data[i]._ltitle.indexOf(query)!=-1){points=1}else if(data[i].host.indexOf(queryHost)==0){points=1;foundByQueryHost=true}if(points){var item={};item.rawurl=data[i].url;item.points=points;item.visitCount=data[i].visitCount;if(foundByQueryHost){item.title=data[i].title;item.url=data[i].url.replace(new RegExp("^(https?://(?:www.)?)("+queryHost+")","ig"),function(full,pre,match){return pre+"<b>"+match+"</b>"})}else{item.url=data[i].url.replace(new RegExp(query,"ig"),function(match){return"<b>"+match+"</b>"});item.title=data[i].title.replace(new RegExp(query,"ig"),function(match){return"<b>"+match+"</b>"})}preMatches.push(item)}}preMatches.sort(function(a,b){if(b.points==a.points){return b.visitCount-a.visitCount}return b.points-a.points});results=preMatches.slice(0,maxResults);callback(results)})}};this.HistoryComplete=new HistoryComplete}).apply(fvdSpeedDial);var _enMessages=null;function _(msg){var text=chrome.i18n.getMessage(msg);if(!text){text=""}return text}(function(){var Localizer=function(){};Localizer.prototype={localizeCurrentPage:function(){this.localizeElem(document)},localizeElem:function(el){var elements=el.querySelectorAll("*[msg]");for(var i=0,len=elements.length;i!=len;i++){var element=elements[i];if(element.hasAttribute("msg_target")){element.setAttribute(element.getAttribute("msg_target"),_(element.getAttribute("msg")))}else{element.innerHTML=_(element.getAttribute("msg"))}element.removeAttribute("msg")}}};this.Localizer=new Localizer}).apply(fvdSpeedDial);(function(){var Prefs=function(){};Prefs.prototype={_prefsPrefix:"prefs.",_changeListeners:[],_themeDefaults:{fancy:{"sd.background_url":"/images/newtab/fancy_bg.jpg","sd.background_color":"000000","sd.background_color_enabled":true,"sd.background_url_type":"parallax","sd.text.cell_title.color":"FFFFFF","sd.text.list_elem.color":"FFFFFF","sd.text.list_show_url_title.color":"FFFFFF","sd.text.list_link.color":"EEEEEE","sd.text.other.color":"FFFFFF","sd.text.cell_url.color":"FFFFFF"},standard:{"sd.background_url":"","sd.background_color":"FFFFFF","sd.background_color_enabled":true,"sd.background_url_type":"noimage","sd.text.cell_title.color":"000000","sd.text.list_elem.color":"000000","sd.text.list_show_url_title.color":"000000","sd.text.list_link.color":"0551AF","sd.text.other.color":"000000","sd.text.cell_url.color":"000000"}},_defaults:{"surfcanyon.enabled":true,"apps.opened":true,"widgets.enabled":true,"widgets.locked":true,"widgets.opened":true,"widgets.opacity":100,"widgets.bgcolor":"000000","widgets.autoscroll":false,"widgets.autoscroll.speed":1,"poweroff.enabled":false,"poweroff.hidden":false,"poweroff.password":"","poweroff.restore_email":"","poweroff.idle.interval":0,"collapsed_message.with_poweroff.display":true,"collapsed_message.without_poweroff.display":true,display_themes_message:true,"sd.no3d_first":true,"sd.global_ids_setuped":false,"sd.first_dial_page_open":true,"sd.tables_created":false,"sd.install_time":null,"sd.dont_display_rate_message":false,"sd.custom_dial_size":200,"sd.custom_dial_size_fancy":200,"sd.custom_dial_size_setuped":false,"sd.enable_dials_search":true,"sd.enable_search":true,"sd.enable_search_preview":true,"sd.synced_after_install":false,"sd.display_move_to_nosync_group_dialog":true,"sd.display_nosync_group_dialog":true,"sd.display_can_turn_off_newtab_popup":true,"sd.display_dial_already_exists_dialog":true,"sd.display_dial_borders":true,"sd.last_opened_settings":"global","sd.display_in_new_tab":true,"sd.display_superfish":false,"sd.display_mirror":true,"sd.fancy_init_min_columns":6,"sd.fancy_size_adjusted":false,"sd.display_mode":"fancy","sd.rotate_angle_max":10,"sd.display_quick_menu_and_clicks":true,"sd.dials_opacity":100,"sd.background_color":"FFFFFF","sd.background_color_enabled":false,"sd.background_url":"","sd.background_source":"url","sd.background_url_type":"noimage","sd.background_parallax_depth":30,"sd.text.cell_title.color":"000000","sd.text.cell_title.bolder":false,"sd.text.cell_title.size":"12","sd.text.cell_url.color":"888888","sd.text.cell_url.bolder":false,"sd.text.cell_url.size":"10","sd.text.list_elem.color":"000000","sd.text.list_elem.bolder":false,"sd.text.list_elem.size":"12","sd.text.list_show_url_title.color":"000000","sd.text.list_show_url_title.bolder":false,"sd.text.list_show_url_title.size":"12","sd.text.list_link.color":"0551AF","sd.text.list_link.bolder":false,"sd.text.list_link.size":"12","sd.text.other.color":"000000","sd.text.other.bolder":false,"sd.text.other.size":"12","sd.display_dial_background":true,"sd.show_urls_under_dials":true,"sd.show_icons_and_titles_above_dials":true,"sd.display_plus_cells":true,"sd.display_popular_group":true,"sd.recentlyclosed_columns":"auto","sd.scrolling":"vertical","sd.show_in_context_menu":true,"sd.disable_custom_search":false,"sd.preview_creation_delay_default":1200,"sd.main_menu_displayed":true,"sd.all_groups_limit_dials":20,"sd.enable_top_sites":true,"sd.thumbs_type":"medium","sd.top_sites_columns":"auto","sd.default_group":-1,"sd.last_opened_group":1,"sd.list_view_type":"title","sd.enable_most_visited":true,"sd.max_most_visited_records":30,"sd.thumbs_type_most_visited":"list","sd.most_visited_columns":"auto","sd.most_visited_cache_life_time":36e5,"sd.most_visited.group_view_type":"title","sd.enable_recently_closed":true,"sd.max_recently_closed_records":20,"sd.most_visited_interval":"month","sd.display_type":"last_selected","sd.last_selected_display_type":"speeddial","sd.default_open_in":"current","sd.search_bar_expanded":true,"sd.speeddial_expanded":true,"sd.mostvisited_expanded":true,"sd.recentlyclosed_expanded":true,"sd.need_to_offer_parallax":true,"sd.light_collapsed_message_show":true},dump:function(callback){var result={};for(var k in this._defaults){result[k]=this.get(k)}callback(result)},toggle:function(name){var newVal=!_b(this.get(name));this.set(name,newVal)},defaultValue:function(settingName){if(typeof this._defaults[settingName]!="undefined"){return this._defaults[settingName]}else{return null}},restore:function(settingName){if(typeof this._defaults[settingName]!="undefined"){this.set(settingName,this._defaults[settingName])}else{}},get:function(name,defaultValue){if(typeof defaultValue=="undefined"){if(typeof this._defaults[name]!="undefined"){defaultValue=this._defaults[name]}else{defaultValue=null}}var name=this._name(name);if(typeof localStorage[name]=="undefined"){return defaultValue}return localStorage[name]},sSet:function(name,value){localStorage[this._name(name)]=value},set:function(name,value){var oldValue=this.get(name);var badListeners=[];if(_r(oldValue)!=_r(value)){localStorage[this._name(name)]=value;Broadcaster.sendMessage({action:"pref:changed",name:name,value:value})}},_name:function(name){return this._prefsPrefix+name}};this.Prefs=new Prefs}).apply(fvdSpeedDial);(function(){fvdSpeedDial.Sync={addDataToSync:function(params,cb){var req={action:"sync:adddatatosync",params:params};if(cb){req.wantResponse=true}chrome.runtime.sendMessage(req,function(){if(cb){cb()}})},removeSyncData:function(params,cb){cb=cb||function(){};chrome.runtime.sendMessage({action:"sync:removesyncdata",params:params},function(){cb()})},isActive:function(cb){chrome.runtime.sendMessage({action:"sync:isactive"},function(active){cb(active)})},hasDataToSync:function(cb){chrome.runtime.sendMessage({action:"sync:hasdatatosync"},function(has){cb(has)})},startSync:function(type,cb){cb=cb||function(){};chrome.runtime.sendMessage({action:"sync:start",type:type},cb)},syncAddonOptionsUrl:function(cb){chrome.runtime.sendMessage({action:"sync:addonoptionsurl"},cb)},importFinished:function(){chrome.runtime.sendMessage({action:"sync:importfinish"})},syncAddonExists:function(cb){chrome.runtime.sendMessage({action:"sync:syncaddonexists"},cb)}}})();(function(){this.PowerOff=new function(){var PASSPHRASE="*j12398sdfh4123iud9123";var SERVER_URL="http://fvdspeeddial.com/sdserver/poweroff.php";var self=this;function callback_prefListener(key,value){if(key=="poweroff.enabled"||key=="poweroff.hidden"){Broadcaster.sendMessage({action:"poweroff:hiddenchange",isHidden:value})}}function cryptString(string){return Aes.Ctr.encrypt(string,PASSPHRASE,256)}function deCryptString(string){return Aes.Ctr.decrypt(string,PASSPHRASE,256)}function getPassword(){return deCryptString(fvdSpeedDial.Prefs.get("poweroff.password"))}function getEmail(){return deCryptString(fvdSpeedDial.Prefs.get("poweroff.restore_email"))}this.isHidden=function(){if(fvdSpeedDial.PowerOff.isEnabled()&&_b(fvdSpeedDial.Prefs.get("poweroff.hidden"))){return true}return false};this.getEmail=function(){return getEmail()};this.isEnabled=function(){return _b(fvdSpeedDial.Prefs.get("poweroff.enabled"))};this.setup=function(email,password){fvdSpeedDial.Prefs.set("poweroff.enabled",true);fvdSpeedDial.Prefs.set("poweroff.password",cryptString(password));fvdSpeedDial.Prefs.set("poweroff.restore_email",cryptString(email))};this.removePassword=function(){fvdSpeedDial.Prefs.set("poweroff.enabled",false)};this.changePassword=function(password){fvdSpeedDial.Prefs.set("poweroff.password",cryptString(password))};this.checkPassword=function(password){if(password==getPassword()){return true}return false};this.restorePassword=function(callback){var url=SERVER_URL+"?a=restore&email="+encodeURIComponent(getEmail())+"&epassword="+encodeURIComponent(fvdSpeedDial.Prefs.get("poweroff.password"));var req=new XMLHttpRequest;req.open("GET",url);req.onload=function(){var response={error:true};try{response=JSON.parse(req.responseText)}catch(ex){}callback(response)};req.onerror=function(){callback({error:true})};req.send()};Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){callback_prefListener(msg.name,msg.value)}})}}).apply(fvdSpeedDial);(function(){var ChromeThemeClient=function(){var _theme=null;function displayChangeBgWindow(themeId){chrome.runtime.sendMessage({action:"chrometheme:getthemedata",themeId:themeId},function(theme){_theme=theme;fvdSpeedDial.SpeedDialMisc.showOptions("offerAdjustBgToTheme",null,null,{top:20,left:document.body.clientWidth/2-document.getElementById("offerAdjustBgToTheme").offsetWidth/2},true);document.getElementById("themeBackgroundAdjustPreview").setAttribute("src",theme.thumbUrl)})}function _onThemeBgAvailable(themeId){displayChangeBgWindow(themeId)}this.setPrefsForCurrentAppliedTheme=function(){chrome.runtime.sendMessage("chrometheme:setprefsforcurrentappliedtheme")};chrome.runtime.onMessage.addListener(function(msg){if(msg.action=="chrometheme:themebgavailable"){_onThemeBgAvailable(msg.themeId)}});window.addEventListener("load",function(){var btnApply=document.getElementById("applyThemeBg");var btnCancel=document.getElementById("cancelThemeBg");var thumb=document.getElementById("themeBackgroundAdjustPreview");var thumbContainer=document.getElementById("themeBackgroundAdjustPreviewContainer");if(btnApply){btnApply.addEventListener("click",function(){btnApply.setAttribute("hidden",true);btnCancel.setAttribute("hidden",true);thumbContainer.setAttribute("loading",1);chrome.runtime.sendMessage({action:"chrometheme:usebg",theme:_theme},function(){fvdSpeedDial.SpeedDial.refreshBackground();fvdSpeedDial.SpeedDialMisc.hideOptions();setTimeout(function(){thumbContainer.removeAttribute("loading");btnApply.removeAttribute("hidden");btnCancel.removeAttribute("hidden")},500)})})}if(btnCancel){btnCancel.addEventListener("click",function(){chrome.runtime.sendMessage({action:"chrometheme:donotshowcurrentthemeoffer"});fvdSpeedDial.SpeedDialMisc.hideOptions()})}if(btnApply&&btnCancel){chrome.runtime.sendMessage({action:"chrometheme:needofferthemebg"},function(resp){if(resp.need){setTimeout(function(){displayChangeBgWindow(resp.themeId)},3e3)}})}})};fvdSpeedDial.ChromeThemeClient=new ChromeThemeClient})();fvdSpeedDial.PremiumForShare=new function(){function isAuthorizedOnServer(cb){var xhr=new XMLHttpRequest;xhr.open("POST","http://everhelper.me/shareforpremium/can.php");xhr.onload=function(){var resp=JSON.parse(xhr.responseText);if(!resp.can){cb(false)}else{cb(true)}};xhr.send(JSON.stringify({action:"user:authstate"}))}this.canDisplay=function(params,cb){if(typeof params=="function"){cb=params;params={}}if(document.location.hash=="#premiumforshare"){return cb(true)}if(!params.ignoreDisplayed&&fvdSpeedDial.Prefs.get("premiumforshare.displayed")){return}var installTime=parseInt(fvdSpeedDial.Prefs.get("sd.install_time"));if((new Date).getTime()-installTime<3600*24*7*1e3){return cb(false)}fvdSpeedDial.Sync.syncAddonExists(function(exists){if(!exists){return cb(false)}isAuthorizedOnServer(function(authorized){if(!authorized){return cb(false)}var introductionOverlay=document.getElementById("introductionOverlay");if(introductionOverlay&&introductionOverlay.hasAttribute("appear")){return cb(false)}cb(true)})})}};(function(){fvdSpeedDial.HiddenCaptureQueue={capture:function(params,callback){chrome.runtime.sendMessage({action:"hiddencapture:queue",wantResponse:callback?true:false},function(res){if(callback){callback(res)}})}}})();(function(){var Apps=function(){this.init()};Apps.prototype={_appsPanel:null,_rebuildInterval:null,_needRebuild:false,_imgContainerHeight:80,_appHeight:112,_appMargin:10,_activeDD:null,_scrollOfContentAmount:50,_containerMarginTop:0,_prefListener:null,init:function(){var that=this;window.addEventListener("load",function(){if(fvdSpeedDial.Config.HIDE_APPS_PANEL){document.getElementById("appsPanel").style.display="none";return}var rebuildListener=function(){setTimeout(function(){that.sheduleRebuild()},0)};chrome.management.onDisabled.addListener(rebuildListener);chrome.management.onEnabled.addListener(rebuildListener);chrome.management.onInstalled.addListener(rebuildListener);chrome.management.onUninstalled.addListener(rebuildListener);that._prefListener=function(key,value){if(key=="sd.search_bar_expanded"){setTimeout(function(){that.adjustMarginTop()},0)}};Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){that._prefListener(msg.name,msg.value)}});document.addEventListener("scroll",function(){that.adjustMarginTop()},false);window.addEventListener("resize",function(){that.adjustMarginTop()},false);var preAppsContainer=document.getElementsByClassName("preAppsContainer")[0];var canScrollOffContent=true;document.body.addEventListener("mousewheel",function(event){if(fvdSpeedDial.Utils.isChildOf(event.target,preAppsContainer)){event.stopPropagation();var prevMarginTop=0;if(event.wheelDeltaY>0){if(that.canScrollTop()){that.doScroll(true)}else if(canScrollOffContent){canScrollOffContent=false;prevMarginTop=that._containerMarginTop;that._containerMarginTop+=that._scrollOfContentAmount;that.adjustMarginTop();setTimeout(function(){that._containerMarginTop=prevMarginTop;that.adjustMarginTop();canScrollOffContent=true},200)}}else{if(that.canScrollDown()){that.doScroll(false)}else if(canScrollOffContent){canScrollOffContent=false;prevMarginTop=that._containerMarginTop;that._containerMarginTop-=that._scrollOfContentAmount;var buttonScrollTop=that.appsPanel().querySelector(".scrollButton.top");var params={};if(buttonScrollTop.hasAttribute("hidden")){params.dontShowScrollTop=true}that.adjustMarginTop(params);setTimeout(function(){that._containerMarginTop=prevMarginTop;that.adjustMarginTop();canScrollOffContent=true},200)}}event.stopPropagation();event.preventDefault()}},false);that.sheduleRebuild();that._rebuildInterval=setInterval(function(){if(that._needRebuild){that._needRebuild=false;that.rebuild()}},100);var buttonScrollDown=that.appsPanel().querySelector(".scrollButton.bottom");buttonScrollDown.addEventListener("click",function(event){if(event.button===0){that.doScroll(false)}},false);var buttonScrollTop=that.appsPanel().querySelector(".scrollButton.top");buttonScrollTop.addEventListener("click",function(event){if(event.button===0){that.doScroll(true)}},false);that.adjustMarginTop();if(_b(fvdSpeedDial.Prefs.get("apps.opened"))){}Shortcut.add("ctrl+space",function(){that.toggle();return false})},false)},canScrollTop:function(){if(this._containerMarginTop<0){return true}else{return false}},canScrollDown:function(){var container=this.appsPanel().getElementsByClassName("appsContainer")[0];var remainHeight=container.offsetHeight+this._containerMarginTop;if(remainHeight>this._effectiveHeight()){return true}else{return false}},doScroll:function(top,scrollCount){var that=this,scrollTop=0,marginTopBefore=that._containerMarginTop;if(top){if(!scrollCount){scrollCount=that.maxAppsInContainer()-2;if(scrollCount<=0){scrollCount=1}}scrollTop=that._appMargin*scrollCount+that._appHeight*scrollCount;that._containerMarginTop+=scrollTop;if(that._containerMarginTop>0){that._containerMarginTop=0}that.adjustMarginTop()}else{if(!scrollCount){scrollCount=that.maxAppsInContainer()-2;if(scrollCount<=0){scrollCount=1}}scrollTop=that._appMargin*scrollCount+that._appHeight*scrollCount;that._containerMarginTop-=scrollTop;if(that._containerMarginTop>0){that._containerMarginTop=0}that.adjustMarginTop()}if(that.appsPanel().getAttribute("state")=="scrolling"){var correctTop=0;if(that._activeDD._elem.hasAttribute("dd-correct-top")){correctTop=parseInt(that._activeDD._elem.getAttribute("dd-correct-top"))}correctTop+=that._containerMarginTop-marginTopBefore;that._activeDD._elem.setAttribute("dd-correct-top",correctTop);setTimeout(function(){that._activeDD._mouseMove()},100)}return scrollTop},sheduleRebuild:function(){this._needRebuild=true},adjustMarginTop:function(params){params=params||{};var realMarginTop=this._containerMarginTop+this._listTopMarginConst();var container=this.appsPanel().getElementsByClassName("appsContainer")[0];container.style.marginTop=realMarginTop+"px";var buttonScrollDown=this.appsPanel().querySelector(".scrollButton.bottom");var buttonScrollTop=this.appsPanel().querySelector(".scrollButton.top");var remainHeight=container.offsetHeight+this._containerMarginTop;if(remainHeight>this._effectiveHeight()&&!params.dontShowScrollDown){buttonScrollDown.removeAttribute("hidden")}else{buttonScrollDown.setAttribute("hidden",true)}if(this._containerMarginTop<0&&!params.dontShowScrollTop){buttonScrollTop.removeAttribute("hidden");buttonScrollTop.style.top=this._listTopMarginConst()-40+"px"}else{buttonScrollTop.setAttribute("hidden",true)}},maxAppsInContainer:function(){var height=this._effectiveHeight();var count=Math.ceil(height/(this._appHeight+this._appMargin));return count},rebuild:function(){var that=this;fvdSpeedDial.Storage.Apps.get(function(apps){var container=that.appsPanel().getElementsByClassName("appsContainer")[0];var tmpContainer=container.cloneNode(false);var num=0;for(var i=0;i!=apps.length;i++){var app=apps[i];try{var appDiv=that._appDiv(app,num);tmpContainer.appendChild(appDiv);num++}catch(ex){console.log("Fail to place APP",ex)}}tmpContainer.style.height=num*(that._appHeight+that._appMargin)+"px";container.parentNode.replaceChild(tmpContainer,container);setTimeout(function(){that.adjustMarginTop()})})},adjustOpenButton:function(){var button=this.appsPanel().getElementsByClassName("openButton")[0];if(this.appsPanel().getAttribute("active")==1){button.textContent=""}else{button.textContent=""}},toggle:function(){if(this.appsPanel().getAttribute("active")==1){this.hide()}else{this.display()}},isDisplayed:function(){return this.appsPanel().getAttribute("active")==1},display:function(){chrome.tabs.getCurrent(function(tab){chrome.tabs.update(tab.id,{url:"chrome://apps/"})})},hide:function(){if(!this.appsPanel().hasAttribute("active")||this.appsPanel().getAttribute("active")===0){return}this.appsPanel().setAttribute("active","0");this.adjustOpenButton();fvdSpeedDial.Prefs.set("apps.opened",false)},appsPanel:function(){if(!this._appsPanel){this._appsPanel=document.getElementById("appsPanel")}return this._appsPanel},_effectiveHeight:function(){return this.appsPanel().offsetHeight-this._listTopMarginConst()},_listTopMarginConst:function(){var constMargin=5;return constMargin},_setPos:function(appDiv,num){var topPos=num*(this._appHeight+this._appMargin);this._setPosVal(appDiv,topPos);appDiv.setAttribute("index",num)},_setPosVal:function(appDiv,topPos){appDiv.style.top=topPos+"px";appDiv.setAttribute("_top",topPos)},_appDiv:function(app,num){var that=this;var appDiv=document.createElement("div");appDiv.addEventListener("click",function(event){if(appDiv.hasAttribute("_swallowClick")){appDiv.removeAttribute("_swallowClick");return}if(app.type=="packaged_app"){return chrome.management.launchApp(app.id)}if(event.button===0){fvdSpeedDial.Utils.Opener.asClicked(app.appLaunchUrl,"current",event)}else if(event.button==1){chrome.tabs.create({url:app.appLaunchUrl,active:true})}},false);appDiv.setAttribute("dd_class","app");appDiv.setAttribute("_app",app.id);appDiv.setAttribute("id","app_"+app.id);this._setPos(appDiv,num);appDiv.className="app";var img=document.createElement("img");var icon=this._getIcon(app);img.setAttribute("src",icon.src);img.addEventListener("mousedown",function(event){event.preventDefault()},false);if(icon.size<this._imgContainerHeight){img.style.marginTop=(this._imgContainerHeight-icon.size)/2+"px"}var imgContainer=document.createElement("div");imgContainer.className="imgContainer";imgContainer.appendChild(img);var titleContainer=document.createElement("div");titleContainer.textContent=app.name;titleContainer.className="titleContainer";titleContainer.addEventListener("mousedown",function(event){event.preventDefault()},false);appDiv.appendChild(imgContainer);appDiv.appendChild(titleContainer);var ddPlaceHolderPos=null;var allowScrollAuto=true;var dd=fvdSpeedDial.Utils.DD.create({elem:appDiv,targets:"app",scrollingNotMean:true,changePos:function(left,top,dd){var lessThanNeed=false;var moreThanNeed=false;var startTop=parseInt(appDiv.getAttribute("_top"));var correctTop=0;if(appDiv.hasAttribute("dd-correct-top")){correctTop=parseInt(appDiv.getAttribute("dd-correct-top"))}top-=correctTop;var y=startTop+top;var yGlobal=y+that._containerMarginTop;var scrollTop=yGlobal<-10&&y>0;if(y<0||scrollTop){top=false}if(yGlobal<=0){lessThanNeed=true}else if(yGlobal+appDiv.offsetHeight+that._listTopMarginConst()>=window.innerHeight){moreThanNeed=true}if(lessThanNeed){top=-that._containerMarginTop-startTop;top=false}else if(moreThanNeed){top=window.innerHeight-appDiv.offsetHeight-startTop-that._containerMarginTop-that._listTopMarginConst()}else{}return{left:false,top:top}},callbackMouseDown:function(){appDiv.removeAttribute("dd-correct-top");ddPlaceHolderPos=appDiv.getAttribute("_top")},callbackStart:function(){appDiv.removeAttribute("dd-correct-top");appDiv.setAttribute("_swallowClick",1);appDiv.setAttribute("dragging",1);that.appsPanel().setAttribute("state","scrolling");that._activeDD=dd},callbackEnd:function(params){if(ddPlaceHolderPos!==null){that._setPos(appDiv,parseInt(appDiv.getAttribute("index"),10))}appDiv.removeAttribute("dragging");that.appsPanel().setAttribute("state","normal");var _elems=that.appsPanel().getElementsByClassName("app");var elems=[];var i=0;for(i=0;i!=_elems.length;i++){elems.push(_elems[i])}elems.sort(function(a,b){return parseInt(a.getAttribute("_top"))-parseInt(b.getAttribute("_top"))});var positions={};for(i=0;i!=elems.length;i++){positions[elems[i].getAttribute("_app")]=i+1}fvdSpeedDial.Storage.Apps.storePositions(positions)},callbackDragon:function(dragOnElem){var oldIndex=appDiv.getAttribute("index");var newIndex=dragOnElem.getAttribute("index");appDiv.setAttribute("index",newIndex);var _elems=that.appsPanel().getElementsByClassName("app");var i=0,e,index;for(i=0;i!=_elems.length;i++){e=_elems[i];if(e==appDiv){continue}index=parseInt(e.getAttribute("index"),10);if(index>oldIndex){e.setAttribute("index",index-1)}}for(i=0;i!=_elems.length;i++){e=_elems[i];if(e==appDiv){continue}index=parseInt(e.getAttribute("index"),10);if(index>=newIndex){e.setAttribute("index",index+1)}}for(i=0;i!=_elems.length;i++){e=_elems[i];if(e==appDiv){continue}index=parseInt(e.getAttribute("index"),10);that._setPos(e,index)}},callbackDragleave:function(dragLeaveElem){}});fvdSpeedDial.ContextMenus.assignToElem(appDiv,"app");return appDiv},_getIcon:function(app){var maxSize=0;var maxIcon="";for(var i=0;i!=app.icons.length;i++){if(app.icons[i].size>maxSize){maxIcon=app.icons[i].url;maxSize=app.icons[i].size}}return{size:maxSize,src:maxIcon}}};this.Apps=new Apps}).apply(fvdSpeedDial);fvdSpeedDial.Introduction=new function(){var self=this;this.hideCallbacks=[];this.allowStartButton=true;this.SLIDES=[{title:_("newtab_introduction_slide1_title"),text:_("newtab_introduction_slide1_text")},{title:_("newtab_introduction_slide2_title"),text:_("newtab_introduction_slide2_text")}];var currentSlideIndex=-1;var selectedMobileStore=null;var hideRequestInProcess=false;function show(){document.getElementById("introductionOverlay").setAttribute("appear",1);buildImages();selectSlide(0);var as=document.querySelectorAll("#introductionDialog .mobile-stores-select > a");as=[].slice.call(as);as.forEach(function(a){a.addEventListener("click",function(){if(hideRequestInProcess){return}selectedMobileStore=a.getAttribute("value");hide();return false})})}function hide(){if(hideRequestInProcess){return}hideRequestInProcess=true;document.getElementById("introductionOverlay").setAttribute("loading",1);fvdSpeedDial.Utils.Async.arrayProcess(self.hideCallbacks,function(cb,next){cb({store:selectedMobileStore},next)},function(){document.getElementById("introductionOverlay").removeAttribute("loading");fvdSpeedDial.Prefs.set("donotshowintro",true);var overlay=document.getElementById("introductionOverlay");overlay.style.opacity=0;setTimeout(function(){overlay.removeAttribute("appear")},200)})}function selectSlide(index){currentSlideIndex=index;var imgContainer=document.querySelector("#introductionOverlay .imageContainer");var images=imgContainer.getElementsByTagName("img");var stepContents=document.querySelectorAll("#introductionDialog .step-content[appear]");

for(var i=0;i!=stepContents.length;i++){stepContents[i].removeAttribute("appear")}var stepContent=document.querySelector('#introductionDialog .step-content[step="'+index+'"]');if(stepContent){stepContent.setAttribute("appear",1);setTimeout(function(){imgContainer.removeAttribute("appear")},500)}else{imgContainer.setAttribute("appear",1)}for(var i=0;i!=images.length;i++){if(images[i].getAttribute("step")==index&&!stepContent){images[i].setAttribute("appear",1)}else{images[i].setAttribute("appear",0)}}var data=self.SLIDES[index];var titleContainer=document.querySelector("#introductionDialog .slideTitle");var textContainer=document.querySelector("#introductionDialog .slideText");titleContainer.innerHTML=data.title;textContainer.innerHTML=data.text;refreshButtons()}function buildImages(){var container=document.querySelector("#introductionOverlay .imageContainer");while(container.firstChild){container.removeChild(container.firstChild)}for(var i=0;i!=self.SLIDES.length;i++){if(document.querySelector('#introductionDialog .step-content[step="'+i+'"]')){continue}var img=new Image;img.src="images/newtab/introduction/slide"+(i+1)+".png";img.setAttribute("step",i);container.appendChild(img)}}function refreshButtons(){var prev=document.querySelector("#introductionDialog .buttons .prev");var next=document.querySelector("#introductionDialog .buttons .next");var start=document.querySelector("#introductionDialog .buttons .start");if(currentSlideIndex==0){prev.setAttribute("appear",0)}else{prev.setAttribute("appear",1)}if(currentSlideIndex<self.SLIDES.length-1){next.setAttribute("appear",1)}else{next.setAttribute("appear",0)}if(currentSlideIndex==self.SLIDES.length-1){document.querySelector("#introductionDialog .header").setAttribute("title",_("newtab_introduction_last_step"));if(self.allowStartButton){start.setAttribute("appear",1)}}else{document.querySelector("#introductionDialog .header").removeAttribute("title");start.setAttribute("appear",0)}}window.addEventListener("load",function(){if(_b(fvdSpeedDial.Prefs.get("donotshowintro"))){return}show();document.querySelector("#introductionDialog .buttons .next").addEventListener("click",function(){selectSlide(currentSlideIndex+1)},false);document.querySelector("#introductionDialog .buttons .prev").addEventListener("click",function(){selectSlide(currentSlideIndex-1)},false);document.querySelector("#introductionDialog .buttons .start").addEventListener("click",function(){hide()},false);document.querySelector("#introductionDialog .close").addEventListener("click",function(){hide()},false)})};fvdSpeedDial.Widgets=new function(){var self=this;var _scroll=null;var needRebuildWidgetsList=false;setInterval(function(){if(needRebuildWidgetsList){needRebuildWidgetsList=false;fvdSpeedDial.Widgets.Builder.rebuildAll()}},1e3);function scheduleRebuildWidgets(){needRebuildWidgetsList=true}function l_addWidget(widgetId){scheduleRebuildWidgets()}function l_updateWidget(widgetId){scheduleRebuildWidgets()}function l_removeWidget(widgetId){fvdSpeedDial.Widgets.Builder.removeWidget(widgetId);setTimeout(function(){_scroll.refresh()},1e3);self.Builder.syncPositionsWithDb()}function l_prefListener(key,value){if(key=="widgets.locked"){refreshWidgetsLockState()}else if(key=="widgets.bgcolor"){refreshBackground()}else if(key=="widgets.opacity"){refreshOpacity()}else if(key=="widgets.autoscroll"||key=="widgets.autoscroll.speed"){refreshAutoScroll()}else if(key=="widgets.enabled"){refreshVisibility()}}function refreshSpeedDialWrapperPadding(){var panelHeight=self.Builder.getWidgetsPanelHeight();var speedDialWrapper=document.getElementById("speedDialWrapper");if(_b(fvdSpeedDial.Prefs.get("widgets.opened"))){speedDialWrapper.style.paddingBottom=panelHeight+"px";speedDialWrapper.setAttribute("extraheight",panelHeight)}else{speedDialWrapper.style.paddingBottom="";speedDialWrapper.removeAttribute("extraheight")}}function refreshScrollManyTimes(count){_scroll.refreshScrollManyTimes()}function refreshView(){refreshBackground();refreshOpacity();refreshAutoScroll()}function refreshBackground(){var preContainer=document.querySelector("#widgetsPanel .preWidgetsContainer");preContainer.style.backgroundColor="#"+fvdSpeedDial.Prefs.get("widgets.bgcolor")}function refreshOpacity(){var preContainer=document.querySelector("#widgetsPanel");preContainer.style.opacity=parseInt(fvdSpeedDial.Prefs.get("widgets.opacity"))/100}function refreshAutoScroll(){if(_b(fvdSpeedDial.Prefs.get("widgets.autoscroll"))){_scroll.AutoScroll.start();_scroll.AutoScroll.setSpeed(parseInt(fvdSpeedDial.Prefs.get("widgets.autoscroll.speed")))}else{_scroll.AutoScroll.stop()}}function refreshWidgetsLockState(){var locked=self.getCurrentLockState();var widgetsPanel=document.getElementById("widgetsPanel");var lockButton=document.querySelector("#widgetsPanel .actionButtons .lock");widgetsPanel.setAttribute("locked",locked?1:0);lockButton.setAttribute("locked",locked?1:0)}this.getCurrentLockState=function(){return _b(fvdSpeedDial.Prefs.get("widgets.locked"))};this.toggleLockedState=function(){fvdSpeedDial.Prefs.set("widgets.locked",!this.getCurrentLockState())};this.openTab=function(){var overlay=document.getElementById("widgetPanelBgOverlay");document.querySelector("#widgetsPanel").setAttribute("active",1);fvdSpeedDial.Prefs.set("widgets.opened",true);_scroll.AutoScroll.setPause(false);refreshSpeedDialWrapperPadding();if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){fvdSpeedDial.SpeedDial.sheduleRebuild()}};this.closeTab=function(){var overlay=document.getElementById("widgetPanelBgOverlay");overlay.setAttribute("active",0);document.querySelector("#widgetsPanel").setAttribute("active",0);fvdSpeedDial.Prefs.set("widgets.opened",false);_scroll.AutoScroll.setPause(true);refreshSpeedDialWrapperPadding();if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){fvdSpeedDial.SpeedDial.sheduleRebuild()}};this.toggleTab=function(){var panel=document.querySelector("#widgetsPanel");if(panel.getAttribute("active")==1){this.closeTab()}else{this.openTab()}};this.setAllWidgetPositions=function(positions){chrome.runtime.sendMessage({action:"widgets:setallpositions",positions:positions})};this.getPosition=function(id,cb){chrome.runtime.sendMessage({action:"widgets:getposition",id:id},cb)};this.remove=function(id){chrome.runtime.sendMessage({action:"widgets:remove",id:id})};this.getAll=function(cb){chrome.runtime.sendMessage({action:"widgets:getall"},cb)};function refreshVisibility(){var panel=document.querySelector("#widgetsPanel");if(_b(fvdSpeedDial.Prefs.get("widgets.enabled"))){panel.removeAttribute("disabled")}else{panel.setAttribute("disabled",1)}}function init(){if(fvdSpeedDial.Config.HIDE_WIDGETS_PANEL){document.getElementById("widgetsPanel").style.display="none";return}refreshVisibility();document.querySelector("#widgetsPanelOpenButton").addEventListener("click",function(){self.toggleTab()},false);fvdSpeedDial.Widgets.Builder.rebuildAll();fvdSpeedDial.Widgets.Builder.onReorderComplete.addListener(function(){setTimeout(function(){_scroll.refresh()},0)});_scroll=fvdSpeedDial.Controls.Scroll.setToElem(document.querySelector("#widgetsPanel .preWidgetsContainer"),{type:"horizontal",position:"top"});document.getElementById("widgetsPanel").addEventListener("mouseover",function(){if(_b(fvdSpeedDial.Prefs.get("widgets.opened"))){_scroll.AutoScroll.setPause(true)}},false);document.getElementById("widgetsPanel").addEventListener("mouseout",function(){if(_b(fvdSpeedDial.Prefs.get("widgets.opened"))){_scroll.AutoScroll.setPause(false)}},false);document.querySelector("#widgetsPanel .actionButtons .lock").addEventListener("click",function(){self.toggleLockedState()},false);document.querySelector("#widgetsPanel .actionButtons .add").addEventListener("click",function(){chrome.tabs.create({url:"http://fvdmedia.com/to/s/chrome_widg/",active:true})},false);document.querySelector("#widgetsPanel .actionButtons .settings").addEventListener("click",function(){document.location="options.html#widgets"},false);refreshWidgetsLockState();if(_b(fvdSpeedDial.Prefs.get("widgets.opened"))){self.openTab()}else{_scroll.AutoScroll.setPause(true)}refreshView();Shortcut.add("space",function(){self.toggleTab();return false},{disable_in_input:true})}Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){l_prefListener(msg.name,msg.value)}else if(msg.action=="widgets:added"){l_addWidget(msg.id)}else if(msg.action=="widgets:updated"){l_updateWidget(msg.id)}else if(msg.action=="widgets:removed"){l_removeWidget(msg.id)}});document.addEventListener("DOMContentLoaded",function(){console.log(fvdSpeedDial.Widgets.Builder);init()},false)};console.log("load builder");fvdSpeedDial.Widgets.Builder=new function(){var self=this;var pckry=null;var WIDGET_PANEL_MIN_PADDING_TOP=15;var WIDGET_PANEL_OPEN_BUTTON_HEIGHT=19;var WIDGET_MARGIN=10;var WIDGET_PADDING_LEFT=10;var widgetsPanelSize={width:window.innerWidth,height:0};var cellSize={width:250,height:200};var widgetsPanelHeights={1:200,2:400};this.onReorderComplete=new FVDEventEmitter;function effCellWidth(x){var marginsIncludedWidth=0;if(x>4){x=4}if(x>1){marginsIncludedWidth=WIDGET_MARGIN*(x-1)}return cellSize.width*x+marginsIncludedWidth}function effCellHeight(y){if(y>2){y=2}var marginsIncludedHeight=0;if(y>1){marginsIncludedHeight=WIDGET_MARGIN*(y-1)}return cellSize.height*y+marginsIncludedHeight}function adjustWidgetPanelSize(widgets){var rowsCount=1;var widgetsSummaryWidth=WIDGET_PADDING_LEFT;widgets.forEach(function(widget){widgetsSummaryWidth+=effCellWidth(widget.widthCells)+WIDGET_MARGIN;if(widget.heightCells>=2){rowsCount=2}});widgetsPanelSize.height=widgetsPanelHeights[rowsCount]+WIDGET_MARGIN;widgetsPanelSize.width=window.innerWidth;widgetsPanelSize.width=Math.max(widgetsPanelSize.width,widgetsSummaryWidth);document.querySelector("#widgetsPanel .widgetsContainer").style.height=widgetsPanelSize.height+"px";document.querySelector("#widgetsPanel .widgetsContainer").style.width=widgetsPanelSize.width+"px";document.getElementById("widgetsPanel").style.bottom="-"+(widgetsPanelSize.height-WIDGET_PANEL_OPEN_BUTTON_HEIGHT+WIDGET_PANEL_MIN_PADDING_TOP)+"px"}function getWidgetMargins(params){var data=params.data;if(!data.height){return{}}var result={};result.top=(widgetsPanelSize.height-data.height)/2;return result}function refreshPositions(params){pckry.items.sort(function(p1,p2){var a=p1.element;var b=p2.element;return parseInt(a.getAttribute("position"),10)-parseInt(b.getAttribute("position"),10)});pckry.layout()}function storeCurrentPositions(){var widgets=pckry.getItemElements();var positions={};widgets.forEach(function(elem,index){positions[elem.getAttribute("id").replace("widget_","")]=index+1});fvdSpeedDial.Widgets.setAllWidgetPositions(positions)}this.getWidgetsPanelHeight=function(){return widgetsPanelSize.height};this.getWidgetsTotalWidth=function(){var widgets=_array(document.querySelectorAll("#widgetsPanel .widgetsContainer .widget"));var w=0;widgets.forEach(function(widget){w+=parseInt(widget.getAttribute("_width"),10)+WIDGET_MARGIN});w-=WIDGET_MARGIN;w+=WIDGET_PADDING_LEFT;return w};this.syncPositionsWithDb=function(){var widgets=_array(document.querySelectorAll("#widgetsPanel .widgetsContainer .widget"));fvdSpeedDial.Utils.Async.arrayProcess(widgets,function(el,next){fvdSpeedDial.Widgets.getPosition(el.getAttribute("id").replace("widget_",""),function(pos){el.setAttribute("position",pos);next()})},function(){refreshPositions()})};this.removeWidget=function(id){var el=document.getElementById("widget_"+id);if(el){fvdSpeedDial.Widgets.getAll(function(widgets){adjustWidgetPanelSize(widgets);pckry.remove(el)})}};this.buildWidgetElem=function(params){var data=params.data;var elem=fvdSpeedDial.Templates.clone("prototype_widget");elem.removeAttribute("id");elem.setAttribute("id","widget_"+data.id);elem.setAttribute("dd_class","widget");elem.setAttribute("position",params.position);elem.setAttribute("_width",data.widthCells);elem.setAttribute("_height",data.heightCells);elem.querySelector("iframe").setAttribute("src","chrome-extension://"+data.id+data.path);if(data.widthCells){elem.style.width=effCellWidth(data.widthCells)+"px"}if(data.heightCells){elem.style.height=effCellHeight(data.heightCells)+"px"}elem.querySelector(".buttons .close").addEventListener("click",function(){fvdSpeedDial.Widgets.remove(data.id)},false);return elem};this.rebuildAll=function(){var container=document.querySelector("#widgetsPanel .widgetsContainer");var panel=document.getElementById("widgetsPanel");while(container.firstChild){container.removeChild(container.firstChild)}fvdSpeedDial.Widgets.getAll(function(widgets){if(!widgets.length){panel.setAttribute("nowidgets",1)}else{panel.setAttribute("nowidgets",0)}var els=[];widgets.forEach(function(widget){var position=widget.position;var elem=self.buildWidgetElem({data:widget,position:position});container.appendChild(elem);els.push(elem)});if(pckry){pckry.destroy()}adjustWidgetPanelSize(widgets);pckry=new Packery(container,{itemSelector:".widget",gutter:WIDGET_MARGIN,isHorizontal:true,columnWidth:cellSize.width,rowHeight:cellSize.height,containerStyle:null,isInitLayout:false});els.forEach(function(el){var draggie=new Draggabilly(el,{containment:container});draggie.on("dragStart",function(event,pointer){});draggie.on("dragMove",function(event,pointer){el.setAttribute("dragging",1)});draggie.on("dragEnd",function(event,pointer){});pckry.bindDraggabillyEvents(draggie)});pckry.on("dragItemPositioned",function(pckryInstance,draggedItem){draggedItem.element.removeAttribute("dragging");self.onReorderComplete.callListeners();storeCurrentPositions()});pckry.on("layoutComplete",function(){self.onReorderComplete.callListeners()});pckry.on("removeComplete",function(){storeCurrentPositions()});refreshPositions()})}};(function(){var SpeedDial=function(){};SpeedDial.prototype=new FVDEventEmitter;SpeedDial.prototype={_displayType:null,_nowOpenedGroup:null,_cellsSizes:{big:364,medium:210,small:150},_mostVisitedIntervals:["all_time","month","week"],_displayModesList:["speeddial","mostvisited","recentlyclosed"],_topLineHeight:3,_dialBodyPadding:5,_cellsSizeRatio:1.6,_cellsMarginX:20,_cellsMarginY:{standard_speeddial:70,fancy_speeddial:30,standard_mostvisited:70,fancy_mostvisited:50},_groupElemMaxWidth:150,_groupElemMargin:5,_groupElemXPadding:6,_groupElemLetterWidth:6,_listElemMarginX:15,_listElemMarginY:15,_listElemSize:{height:15,width:522},_listElemSizeMostVisited:{height:29,width:522},_needRebuild:false,_needRebuildGroupsList:false,_needCSSRefresh:false,_needBackgroundRefresh:false,_rebuildCheckerIntervalInst:null,_cellsRebuildCallback:null,_firstRebuildDone:false,justAddedId:null,fancySpecialDecrementCount:0,onBuildCompleted:new FVDEventEmitter,cellsMarginY:function(){return this._cellsMarginY[fvdSpeedDial.Prefs.get("sd.display_mode")+"_"+this.currentDisplayType()]},has3D:function(){var has="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix;if(!has){return false}if(document.getElementById("test3d").offsetLeft==0){return false}return true},refreshEnableMirrors:function(){var sdContent=document.getElementById("speedDialContent");if(_b(fvdSpeedDial.Prefs.get("sd.display_mirror"))){sdContent.setAttribute("enablemirrors","1")}else{sdContent.setAttribute("enablemirrors","0")}},init:function(){var that=this;this.refreshEnableMirrors();if(!_b(fvdSpeedDial.Prefs.get("sd.fancy_size_adjusted"))){if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){fvdSpeedDial.CSS._updateThemeActions("fancy")}var min=this.getMinCellWidth();var max=this.getMaxCellWidth();var v=max;var minCols=fvdSpeedDial.Prefs.get("sd.fancy_init_min_columns");while(v>=min){fvdSpeedDial.Prefs.set("sd.custom_dial_size_fancy",v);if(fvdSpeedDial.SpeedDial.cellsInRowMax("auto","fancy").cols>=minCols){break}v--}fvdSpeedDial.Prefs.set("sd.fancy_size_adjusted",true)}fvdSpeedDial.CSS.stylesheets.push(document.styleSheets[0]);this.refreshExpandState();this.refreshBackground();this.refreshCSS();this._rebuildCheckerIntervalInst=setInterval(this._needRebuildChecker,100);window.addEventListener("resize",function(event){that.sheduleRebuild();that.sheduleRebuildGroupsList()},true);this.DragAndDrop.init();setTimeout(function(){fvdSpeedDial.ContextMenus.setGlobalMenu(that.currentDisplayType())},0);chrome.tabs.onActivated.addListener(function(info){chrome.tabs.getCurrent(function(tab){if(tab.id==info.tabId){if(document.body.hasAttribute("dial-search-show-results")){return}that.sheduleFullRebuild()}})});if(_b(fvdSpeedDial.Prefs.get("sd.first_dial_page_open"))){setTimeout(function(){},0);fvdSpeedDial.Prefs.set("sd.first_dial_page_open",false)}this.correctPerspectiveOrigin();document.addEventListener("scroll",function(){that.correctPerspectiveOrigin()},false);document.getElementById("cbNotDisplayCollapsedWithPowerOff").addEventListener("click",function(){setTimeout(function(){fvdSpeedDial.Prefs.set("collapsed_message.with_poweroff.display",false)},0)},false);document.getElementById("cbNotDisplayCollapsedWithoutPowerOff").addEventListener("click",function(){setTimeout(function(){fvdSpeedDial.Prefs.set("collapsed_message.without_poweroff.display",false)},0)},false);document.querySelector("#searchBar .rightMenu .showHide").addEventListener("click",function(){that.toggleExpand()},false);document.querySelector("#speedDialCollapsedContent .aboutPowerOff").addEventListener("click",function(){window.open(chrome.extension.getURL("/options.html#poweroff"))},false);this.refreshCollapsedMessages();var forceShowGroupId=fvdSpeedDial.Utils.getQueryValue("show_group_id");if(forceShowGroupId){that.setCurrentGroupId(forceShowGroupId)}document.location.hash="#";Broadcaster.onMessage.addListener(function(message){switch(message.action){case"syncStartNotification":document.getElementById("buttonSync").setAttribute("sync",1);break;case"syncEndNotification":document.getElementById("buttonSync").removeAttribute("sync");break;case"pref:changed":that._prefsListener(message.name,message.value);break;case"forceRebuild":fvdSpeedDial.Utils.Async.chain([function(next){if(message.needDisplayType){if(message.needDisplayType!=fvdSpeedDial.SpeedDial.currentDisplayType()){return}}if(!message.needActiveTab){return next()}fvdSpeedDial.Utils.isActiveTab(function(active){if(!active){return}next()})},function(){fvdSpeedDial.SpeedDial.sheduleFullRebuild()}]);break;case"foundRecentlyClosed":fvdSpeedDial.Utils.Async.chain([function(next){if(!message.needActiveTab){return}fvdSpeedDial.Utils.isActiveTab(function(active){if(!active){return}next()})},function(){if(fvdSpeedDial.SpeedDial.currentDisplayType()=="recentlyclosed"){fvdSpeedDial.SpeedDial.sheduleFullRebuild()}else{fvdSpeedDial.SpeedDialMisc.sheduleRebuild()}}]);break}})},refreshCollapsedMessages:function(){if(!_b(fvdSpeedDial.Prefs.get("collapsed_message.with_poweroff.display"))){document.querySelector("#speedDialCollapsedContent .collapsedMessagePoweroffDisabled").style.display="none"}if(!_b(fvdSpeedDial.Prefs.get("collapsed_message.without_poweroff.display"))){document.querySelector("#speedDialCollapsedContent .collapsedMessagePoweroffEnabled").style.display="none"}},getMaxCellWidth:function(){var max=0;for(var k in this._cellsSizes){var size=this._cellsSizes[k];if(size>max){max=size}}return max},getMinCellWidth:function(){var min=9999;for(var k in this._cellsSizes){var size=this._cellsSizes[k];if(size<min){min=size}}return min},openSizeSetup:function(){window.open(chrome.extension.getURL("/options.html#setup-custom-size"))},dialRemoveAnimate:function(dialId){var cell=document.getElementById("dialCell_"+dialId);if(cell){var that=this;cell.addEventListener("webkitTransitionEnd",function(event){that.sheduleFullRebuild()},true);cell.style.opacity=0;cell.style.webkitTransform="scale(0.5)"}},dialMoveToGroup:function(dialId,groupId){fvdSpeedDial.Storage.moveDial(dialId,groupId,function(result){if(result.result){fvdSpeedDial.Sync.addDataToSync({category:"dials",data:dialId,translate:"dial"});if(fvdSpeedDial.SpeedDial.currentGroupId()==0){fvdSpeedDial.SpeedDial.sheduleFullRebuild()}else{fvdSpeedDial.SpeedDial.dialRemoveAnimate(dialId)}fvdSpeedDial.Storage.dialGlobalId(dialId,function(dialGlobalId){fvdSpeedDial.Sync.removeSyncData({category:["deleteDials"],data:dialGlobalId})})}})},setListViewType:function(){var selectedElem=document.querySelector("[name=listViewType]:checked");var type=null;if(selectedElem){type=selectedElem.value;fvdSpeedDial.Prefs.set("sd.list_view_type",type)}else{selectedElem=document.querySelector("[name=listViewType][value="+fvdSpeedDial.Prefs.get("sd.list_view_type")+"]");selectedElem.checked=true;type=selectedElem.value}var elements=document.getElementsByClassName("newtabListElem");var altType=null;if(type=="url"){altType="title"}else{altType="url"}for(var i=0;i!=elements.length;i++){var elem=elements[i];var textNode=elem.getElementsByClassName("text")[0];textNode.textContent=elem.getAttribute("_"+type);elem.setAttribute("title",elem.getAttribute("_"+altType))}},refreshSpeedDialWrapperHeight:function(){var wrapper=document.getElementById("speedDialWrapper");wrapper.style.height="";var currentHeight=wrapper.offsetHeight;var bodyHeight=document.body.offsetHeight;var speedDialHeight=bodyHeight-this._topLineHeight;var extraHeight=0;if(wrapper.hasAttribute("extraheight")){extraHeight=parseInt(wrapper.getAttribute("extraheight"))}if(currentHeight>speedDialHeight){wrapper.style.height=currentHeight+20-extraHeight+"px"}else{wrapper.style.height=speedDialHeight-extraHeight+"px"}},correctPerspectiveOrigin:function(){var originValue=100;originValue+=document.body.scrollTop;document.getElementById("cellsContainer").style.webkitPerspectiveOrigin="50% "+originValue+"px"},correctPerspective:function(params){params=params||{};if(!params._correctAttempt){params._correctAttempt=1}if(params._correctAttempt>10){return}params._correctAttempt++;if(!this.getExpandState()){return}var that=this;var pers=600;var fixedPerspective=false;if(fvdSpeedDial.Prefs.get("sd.display_mode")!="fancy"){fixedPerspective=true}else if(this.currentDisplayType()=="mostvisited"){}else if(this._currentSettingsColumnsCount()!="auto"){var maxCols=that.cellsInRowMax("auto",null,{objects:document.getElementById("cellsContainer").childNodes.length}).cols;if(maxCols!=this._currentSettingsColumnsCount()){fixedPerspective=true}}if(fixedPerspective){document.getElementById("cellsContainer").style.webkitPerspective=pers+"px";return}var iter=0;var that=this;var els=document.querySelectorAll(".newtabCell[row='0']");var viewPortWidth=that._viewportWidth();console.log(viewPortWidth,els.length,that.cellsInRowMax("auto",null,{objects:document.getElementById("cellsContainer").childNodes.length}).cols);var el=els[els.length-1];var firstEl=els[0];var rect=el.getBoundingClientRect();if(rect.right==0){setTimeout(function(){that.correctPerspective(params)},0);return}var lastValueWhenInBorders=0;var alreadyCheckedPers={};var cellsContainer=document.getElementById("cellsContainer");cellsContainer.style.webkitPerspective=pers+"px";while(true){iter++;if(iter>100||alreadyCheckedPers[pers]>5){if(lastValueWhenInBorders){cellsContainer.style.webkitPerspective=lastValueWhenInBorders+"px"}break}if(!alreadyCheckedPers[pers]){alreadyCheckedPers[pers]=0}alreadyCheckedPers[pers]++;var delta=20;var width=0;var el=els[els.length-1];var rect=el.getBoundingClientRect();var normWDelta=25;var wDelta=viewPortWidth-rect.right;if(wDelta<normWDelta&&wDelta>0&&rect.left>0){break}var inBorders=false;if(wDelta<0){pers+=delta}else{if(firstEl.getBoundingClientRect().left>normWDelta){inBorders=true;lastValueWhenInBorders=pers}pers-=delta}var scaleRatio=rect.width/el.offsetWidth;if(inBorders&&scaleRatio<=fvdSpeedDial.Config.FANCY_SIDE_DIALS_MAX_SCALE&&scaleRatio>=fvdSpeedDial.Config.FANCY_SIDE_DIALS_MIN_SCALE){console.log("DONE#1");break}cellsContainer.style.webkitPerspective=pers+"px"}},rebuildCells:function(params){var l=new Log;l.profile.start("preparing tasks");l.profile.start("total");var that=this;params=params||{};var rebuildCellsParams=params;if(!params.doNotZeroFancySpecialDecrementCount){this.fancySpecialDecrementCount=0}var speedDialContent=document.getElementById("speedDialContent");speedDialContent.setAttribute("style",fvdSpeedDial.Prefs.get("sd.display_mode"));this.refreshExpandState({ifcollapsed:true});var displayType=this.currentDisplayType();var thumbsMode=this.currentThumbsMode();var cellSize=this._currentCellSize();document.body.setAttribute("thumbsmode",thumbsMode);document.body.setAttribute("displaymode",fvdSpeedDial.Prefs.get("sd.display_mode"));document.body.setAttribute("displaytype",displayType);var activeScrollingType=fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType();var container=null;var containerId=null;var tmpContainer=null;function _getContainer(){var listContainer=that._listContainer();var cellsContainer=that._cellsContainer();var c;if(that.currentThumbsMode()=="list"){c=listContainer}else{c=cellsContainer}return c}container=_getContainer();tmpContainer=container.cloneNode(true);while(tmpContainer.firstChild){tmpContainer.removeChild(tmpContainer.firstChild)}containerId=container.getAttribute("id");var finishBuildCallback=function(params){speedDialContent.style.width="";tmpContainer.style.width="";l.profile.start("finishBuildCallback");document.body.setAttribute("scrollingtype",activeScrollingType);if(that.currentThumbsMode()!="list"){var containerSize=that._dialsAreaSize({objects:tmpContainer.childNodes.length});if(containerSize.width&&activeScrollingType=="vertical"){tmpContainer.style.width=containerSize.width+"px"}}if(that._cellsRebuildCallback){that._cellsRebuildCallback()}if(displayType=="recentlyclosed"){document.getElementById("groupsWidthSetter").setAttribute("hidden",true)}else{document.getElementById("groupsWidthSetter").removeAttribute("hidden")}if(thumbsMode=="list"){cellsContainer.setAttribute("hidden",true);document.getElementById("listContainerParent").removeAttribute("hidden")}else{listContainer.setAttribute("hidden",true);document.getElementById("listContainerParent").setAttribute("hidden",true)}container=_getContainer();container.parentNode.replaceChild(tmpContainer,container);tmpContainer.removeAttribute("hidden");setTimeout(function(){that.refreshExpandState()},0);if(thumbsMode=="list"){var listViewMenus=document.getElementsByClassName("listViewMenu");for(var i=0;i!=listViewMenus.length;i++){listViewMenus[i].setAttribute("hidden",true)}document.getElementById("listNoItemsToDisplay").setAttribute("hidden",true);if(params){if(params.noitems){document.getElementById("listNoItemsToDisplay").removeAttribute("hidden");document.getElementById("listViewTypeSelector").setAttribute("hidden",true);return}}document.getElementById("listViewTypeSelector").removeAttribute("hidden");var listContainerParent=document.getElementById("listContainerParent");var size=that.Builder.listViewContainerSize(tmpContainer,countInRow);tmpContainer.style.height=size.height+"px";tmpContainer.style.width=size.width+"px";if(size.width!=0){listContainerParent.style.width=size.width+"px"}that.setListViewType();var neededMenu=document.getElementById(displayType+"ListViewMenu");neededMenu.removeAttribute("hidden")}else{document.getElementById("listViewTypeSelector").setAttribute("hidden",true);that.correctPerspective();if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="vertical"){tmpContainer.style.height=fvdSpeedDial.SpeedDial.Builder.cellsContainerHeight(tmpContainer.childNodes.length,that.cellsInRowMax(null,null,{objects:tmpContainer.childNodes.length}).cols,cellSize)+"px"}if(activeScrollingType=="horizontal"){var rows=parseInt(tmpContainer.getAttribute("rows"),10);var cell=tmpContainer.childNodes[0];var cellWidth=cell.offsetWidth;var cellsPerRow=Math.ceil(tmpContainer.childNodes.length/rows);speedDialContent.style.width=cellWidth*cellsPerRow+"px"}}if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"&&!that.has3D()){if(_b(fvdSpeedDial.Prefs.get("sd.no3d_first"))){fvdSpeedDial.Prefs.set("sd.no3d_first",false);return fvdSpeedDial.Prefs.set("sd.display_mode","standard")}document.getElementById("cellsContainer").setAttribute("hidden",true);document.getElementById("listContainer").setAttribute("hidden",true);document.getElementById("no3dmessage").removeAttribute("hidden")}else{document.getElementById("no3dmessage").setAttribute("hidden",true)}that.Builder.refreshLastRow();l.profile.end("finishBuildCallback");l.profile.end("total");console.log("** rebuildCells **\n",l.toString());that.onBuildCompleted.callListeners(rebuildCellsParams)};if(thumbsMode=="list"){tmpContainer.style.height=""}else{}var countInRow=null;var gridParams=this.cellsInRowMax();countInRow=gridParams.cols;l.profile.end("preparing tasks");if(this.currentDisplayType()=="speeddial"){var groupId=this.currentGroupId();var order=null;var limit=null;if(parseInt(groupId,10)===0){order="`clicks` DESC";limit=fvdSpeedDial.Prefs.get("sd.all_groups_limit_dials")}fvdSpeedDial.Utils.Async.chain([function(next){if(params.dials){return next()}fvdSpeedDial.Storage.listDials(order,groupId,limit,function(data){params.dials=data;next()})},function(){var data=params.dials;if(that.currentThumbsMode()!="list"){var displayDialBg=fvdSpeedDial.Prefs.get("sd.display_dial_background");l.profile.start("fetch dials from db");l.profile.end("fetch dials from db");l.profile.start("build cells html");gridParams=that.cellsInRowMax(null,null,{objects:data.length});if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"&&!gridParams.rows){activeScrollingType="vertical"}countInRow=gridParams.cols;if(gridParams.rows){countInRow=Math.ceil(data.length/gridParams.rows);if(_b(fvdSpeedDial.Prefs.get("sd.display_plus_cells"))){countInRow++}}var i=0;var countRowsFilled=Math.ceil(data.length/countInRow);tmpContainer.setAttribute("rows",countRowsFilled);var lastRow=[];var plusCellsCount=countRowsFilled*countInRow-data.length;for(;i!=data.length;i++){data[i].displayDialBg=displayDialBg;var cell=that.Builder.cell(data[i],i,countInRow,displayType,thumbsMode,cellSize,countRowsFilled);if(plusCellsCount!=0&&cell.getAttribute("row")==countRowsFilled-1){lastRow.push(cell)}var needAnimateAppear=false;if(data[i].id==that.justAddedId){cell.style.opacity=0;that.justAddedId=null;needAnimateAppear=true}tmpContainer.appendChild(cell);if(needAnimateAppear){(function(cell){setTimeout(function(){cell.style.webkitTransform=cell.style.webkitTransform.replace("scale(0)","");cell.style.opacity="";fvdSpeedDial.Utils.scrollToElem(cell)},0)})(cell)}}if(_b(fvdSpeedDial.Prefs.get("sd.display_plus_cells"))){if(plusCellsCount==0){plusCellsCount=countInRow}for(var j=0;j!=plusCellsCount;j++,i++){var cell=that.Builder.plusCell(i,countInRow,cellSize,countRowsFilled);cell.setAttribute("id","plus_cell_"+j);tmpContainer.appendChild(cell);lastRow.push(cell)}}l.profile.end("build cells html")}else{var countInCol=that.Builder.listElemCountInCol(countInRow,data.length);for(var i=0;i!=data.length;i++){var elem=that.Builder.listElem(i,countInCol,data[i],displayType);tmpContainer.appendChild(elem)}}finishBuildCallback()}])}else if(this.currentDisplayType()=="mostvisited"){var interval=this.currentGroupId();if(this.currentThumbsMode()!="list"){fvdSpeedDial.Storage.MostVisited.getData({interval:interval,type:"host",count:fvdSpeedDial.Prefs.get("sd.max_most_visited_records")},function(data){if(gridParams.rows){countInRow=Math.ceil(data.length/gridParams.rows)}for(var i=0;i!=data.length;i++){var row=data[i];(function(i){fvdSpeedDial.Storage.MostVisited.extendData(row,function(mvData){var cell=that.Builder.cell(mvData,i,countInRow,displayType,thumbsMode,cellSize);tmpContainer.appendChild(cell);if(i==data.length-1){finishBuildCallback()}})})(i)}if(!data.length){finishBuildCallback()}})}else{var t=(new Date).getTime();fvdSpeedDial.Storage.MostVisited.getData({interval:interval,type:"host",count:fvdSpeedDial.Prefs.get("sd.max_most_visited_records")},function(data){var countInCol=that.Builder.listElemCountInCol(countInRow,data.length);for(var i=0;i!=data.length;i++){var row=data[i];

(function(i){fvdSpeedDial.Storage.MostVisited.extendData(row,function(mvData){var cell=that.Builder.listElem(i,countInCol,mvData,displayType);tmpContainer.appendChild(cell);if(i==data.length-1){finishBuildCallback()}})})(i)}if(!data.length){finishBuildCallback({noitems:true})}})}}else if(this.currentDisplayType()=="recentlyclosed"){fvdSpeedDial.Storage.RecentlyClosed.getData({count:fvdSpeedDial.Prefs.get("sd.max_recently_closed_records")},function(data){var countInCol=that.Builder.listElemCountInCol(countInRow,data.length);for(var i=0;i!=data.length;i++){var row=data[i];var cell=that.Builder.listElem(i,countInCol,data[i],displayType);tmpContainer.appendChild(cell)}finishBuildCallback({noitems:data.length==0})})}},removeGroup:function(groupId,callback,params){var removeFromBase=function(){fvdSpeedDial.Utils.Async.chain([function(chainCallback){fvdSpeedDial.Sync.addDataToSync({category:"deleteGroups",data:groupId,translate:"group"},function(){fvdSpeedDial.Storage.groupDelete(groupId,function(){chainCallback()})})},function(chainCallback){fvdSpeedDial.Storage.listDials(null,groupId,null,function(dials){fvdSpeedDial.Utils.Async.arrayProcess(dials,function(dial,apCallback){fvdSpeedDial.Storage.deleteDial(dial.id);apCallback()},function(){if(callback){callback(true)}})})}])};fvdSpeedDial.Storage.groupsCount(function(countGroups){if(countGroups==1){fvdSpeedDial.Dialogs.alert(_("dlg_alert_cannot_remove_group_title"),_("dlg_alert_cannot_remove_group_text"));if(callback){callback(false)}}else{fvdSpeedDial.Storage.getGroup(groupId,function(group){if(group!=null){if(group.count_dials==0||params&&params.noConfirmIfHaveDials){removeFromBase();if(callback){callback(true)}}else{fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_group_title"),_("dlg_confirm_remove_group_text").replace("%count%",group.count_dials),function(result){if(result){removeFromBase()}if(callback){callback(result)}})}}})}})},currentGroupId:function(){if(this.currentDisplayType()=="speeddial"){if(this._nowOpenedGroup!==null){return this._nowOpenedGroup}var id=fvdSpeedDial.Prefs.get("sd.default_group");if(id==-1){id=fvdSpeedDial.Prefs.get("sd.last_opened_group")}this._nowOpenedGroup=id;return id}else if(this.currentDisplayType()=="mostvisited"){return fvdSpeedDial.Prefs.get("sd.most_visited_interval")}else{return null}},setCurrentGroupId:function(id){if(this.currentDisplayType()=="speeddial"){if(this.currentGroupId()==id){return}this._nowOpenedGroup=id;fvdSpeedDial.Prefs.set("sd.last_opened_group",id)}else if(this.currentDisplayType()=="mostvisited"){if(this.currentGroupId()==id){return}fvdSpeedDial.Prefs.set("sd.most_visited_interval",id)}else{return}this.sheduleRebuild();this.sheduleRebuildGroupsList()},setCurrentThumbsMode:function(mode){switch(this.currentDisplayType()){case"speeddial":fvdSpeedDial.Prefs.set("sd.thumbs_type",mode);break;case"mostvisited":fvdSpeedDial.Prefs.set("sd.thumbs_type_most_visited",mode);break}},currentThumbsMode:function(){switch(this.currentDisplayType()){case"speeddial":return fvdSpeedDial.Prefs.get("sd.thumbs_type");break;case"mostvisited":return fvdSpeedDial.Prefs.get("sd.thumbs_type_most_visited");break;case"recentlyclosed":return"list";break}},cirlceDisplayType:function(direction){direction=direction||1;var list=this._displayModesList.slice();if(!_b(fvdSpeedDial.Prefs.get("sd.enable_top_sites"))){var index=list.indexOf("speeddial");list.splice(index,1)}if(!_b(fvdSpeedDial.Prefs.get("sd.enable_recently_closed"))){var index=list.indexOf("recentlyclosed");list.splice(index,1)}if(!_b(fvdSpeedDial.Prefs.get("sd.enable_most_visited"))){var index=list.indexOf("mostvisited");list.splice(index,1)}var mode=this.currentDisplayType();var modeIndex=list.indexOf(mode);var nextModeIndex=modeIndex+direction;if(nextModeIndex>=list.length){nextModeIndex=0}else if(nextModeIndex<0){nextModeIndex=list.length-1}var nextMode=list[nextModeIndex];this.setCurrentDisplayType(nextMode)},setCurrentDisplayType:function(type){this._displayType=type;fvdSpeedDial.Prefs.set("sd.last_selected_display_type",type);fvdSpeedDial.ContextMenus.setGlobalMenu(type);this.sheduleFullRebuild();this.refreshShowHideButton()},currentDisplayType:function(){if(this._displayType==null){if(fvdSpeedDial.Prefs.get("sd.display_type")=="last_selected"){this._displayType=fvdSpeedDial.Prefs.get("sd.last_selected_display_type")}else{this._displayType=fvdSpeedDial.Prefs.get("sd.display_type")}}return this._displayType},cellsInRowMax:function(settingsColumnsCount,displayMode,additional){displayMode=displayMode||fvdSpeedDial.Prefs.get("sd.display_mode");additional=additional||{};if(typeof additional.objects=="undefined"){additional.objects=-1}else if(typeof additional.objects=="function"){additional.objects=additional.objects()}settingsColumnsCount=settingsColumnsCount||this._currentSettingsColumnsCount();var countRows=null;if(this.currentThumbsMode()=="list"){if(settingsColumnsCount!="auto"){var autoCount=this.cellsInRowMax("auto").cols;if(settingsColumnsCount>autoCount){settingsColumnsCount=autoCount}return{cols:settingsColumnsCount}}var documentWidth=this._viewportWidth();var count=Math.floor(documentWidth/(this._listElemSize.width+this._listElemMarginX));if(count<=0){count=1}return{cols:count}}else{if(settingsColumnsCount!="auto"){if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){return{rows:settingsColumnsCount}}else{return{cols:settingsColumnsCount}}}var documentWidth=this._viewportWidth();var sdWrapper=document.getElementById("speedDialWrapper");var documentHeight=this._viewportHeightForHorizScroll();if(sdWrapper.hasAttribute("extraheight")){documentHeight-=parseInt(sdWrapper.getAttribute("extraheight"))}var cellSize=this._currentCellSize();var cellsMarginY=this.cellsMarginY();var effectiveCellSize=cellSize.height;effectiveCellSize+=34;effectiveCellSize+=21;countRows=Math.floor(documentHeight/(effectiveCellSize+this._cellsMarginX));var count=Math.floor(documentWidth/(cellSize.width+this._cellsMarginX));if(displayMode=="fancy"){count--;if(this.fancySpecialDecrementCount){count-=this.fancySpecialDecrementCount}}if(count<=0){count=1}if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){if(additional.objects>=0){if(countRows*count>additional.objects){countRows=null}}}else{countRows=null}}var result={cols:count,rows:countRows};if(displayMode=="fancy"&&!_b(fvdSpeedDial.Prefs.get("sd.display_plus_cells"))&&result.cols&&additional.objects>=0){if(result.cols>additional.objects){result.cols=additional.objects}}return result},sheduleRebuild:function(){this._needRebuild=true},sheduleFullRebuild:function(params){fvdSpeedDial.SpeedDialMisc.sheduleRebuild();this.sheduleRebuildGroupsList();this.sheduleRebuild()},makeThumb:function(dialId,url,type,delay,saveImage){if(typeof saveImage=="undefined"){saveImage=true}var that=this;chrome.tabs.getSelected(null,function(tab){fvdSpeedDial.ThumbMaker.screenTab({tabId:tab.id,type:type,dialId:dialId,width:that.getMaxCellWidth()*window.devicePixelRatio,url:url,delay:delay,saveImage:saveImage});chrome.tabs.update(tab.id,{url:url})})},openAllDialsInGrop:function(groupId){var that=this;fvdSpeedDial.Storage.listDials(null,groupId,null,function(dials){try{for(var i=0;i!=dials.length;i++){fvdSpeedDial.Utils.Opener.backgroundTab(dials[i].url);that.addDialClick(dials[i].id)}}catch(ex){}})},refreshAllDialsInGroup:function(groupId){var that=this;if(groupId==0){fvdSpeedDial.Storage.listDials("",groupId,fvdSpeedDial.Prefs.get("sd.all_groups_limit_dials"),function(dials){var ids=[];dials.forEach(function(dial){ids.push(dial.id)});fvdSpeedDial.Storage.resetAutoDialsForGroup({ids:ids},function(){that.sheduleRebuild()})})}else{fvdSpeedDial.Storage.resetAutoDialsForGroup({groupId:groupId},function(){that.sheduleRebuild()})}},addDialClick:function(dialId){var that=this;fvdSpeedDial.Storage.getDial(dialId,function(data){if(!data){return false}var newClicks=data.clicks+1;fvdSpeedDial.Storage.updateDial(dialId,{clicks:newClicks},function(){try{var cell=that._getSpeedDialCellById(dialId);var clicksCount=cell.getElementsByClassName("clicksCount")[0];clicksCount.textContent=newClicks}catch(ex){}})})},sheduleRebuildGroupsList:function(){this._needRebuildGroupsList=true},Groups:{rebuildGroupsList:function(){var l=new Log;l.profile.start("total");l.profile.start("preparations");var that=fvdSpeedDial.SpeedDial;var isAdditionalListOpened=false;try{if(document.getElementsByClassName("additionalGroupsList")[0].getAttribute("active")==1){isAdditionalListOpened=true}}catch(ex){}document.getElementById("speedDialGroupsWrapper").setAttribute("type",that.currentDisplayType());var groupsBox=document.getElementById("groupsBox");var tmpContainer=groupsBox.cloneNode(true);while(tmpContainer.firstChild){tmpContainer.removeChild(tmpContainer.firstChild)}l.profile.end("preparations");if(that.currentDisplayType()=="speeddial"){var countInPopularGroup=0;fvdSpeedDial.Utils.Async.chain([function(chainCallback){if(_b(fvdSpeedDial.Prefs.get("sd.display_popular_group"))){l.profile.start("fetch total count dials");fvdSpeedDial.Storage.countDials({uniqueUrl:true},function(count){l.profile.end("fetch total count dials");countInPopularGroup=Math.min(fvdSpeedDial.Prefs.get("sd.all_groups_limit_dials"),count);chainCallback()})}else{chainCallback()}},function(){l.profile.start("fetch groups list");fvdSpeedDial.Storage.groupsList(function(groups){l.profile.end("fetch groups list");var currentGroupId=fvdSpeedDial.SpeedDial.currentGroupId();var groupFound=false;for(var i=0;i!=groups.length;i++){if(groups[i].id==currentGroupId){groupFound=true;break}}if(currentGroupId==0){groupFound=true}if(!groupFound){if(!groups.length){return}fvdSpeedDial.SpeedDial.setCurrentGroupId(groups[0].id);fvdSpeedDial.SpeedDial.sheduleFullRebuild();return}l.profile.start("building groups html");if(_b(fvdSpeedDial.Prefs.get("sd.display_popular_group"))){var item=fvdSpeedDial.SpeedDial.Builder.Groups.item(_("newtab_popular_group_title")+" ("+countInPopularGroup+")",0);fvdSpeedDial.ContextMenus.assignToElem(item,"speeddialGroup");tmpContainer.appendChild(item)}var groupsBoxMaxWidth=that._viewportWidth()-430;var groupsActiveWidth=0;var maxGroupsInMainList=0;if(_b(fvdSpeedDial.Prefs.get("sd.display_popular_group"))){groupsActiveWidth+=that._groupElemXPadding*2+that._groupElemLetterWidth*item.textContent.length+that._groupElemMargin}for(var i=0;i!=groups.length;i++){var groupSize=(groups[i].name+"("+groups[i].count_dials+")").length*that._groupElemLetterWidth+that._groupElemXPadding*2+ +that._groupElemMargin;if(groupSize>that._groupElemMaxWidth){groupSize=that._groupElemMaxWidth}groupsActiveWidth+=groupSize;if(groupsActiveWidth>=groupsBoxMaxWidth){break}maxGroupsInMainList++}var groupsInMainListCount=maxGroupsInMainList;var groupsInMainList=groups.splice(0,groupsInMainListCount);var groupsInAdditionalList=groups;for(var i=0;i!=groupsInMainList.length;i++){item=fvdSpeedDial.SpeedDial.Builder.Groups.item(groupsInMainList[i].name,groupsInMainList[i].id,groupsInMainList[i].count_dials);fvdSpeedDial.ContextMenus.assignToElem(item,"speeddialGroup");tmpContainer.appendChild(item)}if(groupsInAdditionalList.length>0){var additionalGroupsButton=fvdSpeedDial.SpeedDial.Builder.Groups.additionalGroupsButton();tmpContainer.appendChild(additionalGroupsButton);var additionalList=fvdSpeedDial.SpeedDial.Builder.Groups.additionalList(groupsInAdditionalList);additionalList.setAttribute("active",0);tmpContainer.appendChild(additionalList)}item=document.createElement("div");item.setAttribute("class","group add");var image=document.createElement("div");image.setAttribute("class","image");item.appendChild(image);item.addEventListener("click",function(event){fvdSpeedDial.Dialogs.addGroup()},true);tmpContainer.appendChild(item);groupsBox=document.getElementById("groupsBox");groupsBox.parentNode.replaceChild(tmpContainer,groupsBox);l.profile.end("building groups html");if(isAdditionalListOpened){that.Groups.displayAdditionalList({disableAnimation:true})}setTimeout(function(){fvdSpeedDial.ContextMenus.rebuildSpeedDialCellMenu()},0);try{var currentGroupId=that.currentGroupId();var item=document.getElementById("group_select_"+currentGroupId);document.getElementById("groupsBoxContainer").scrollLeft=item.offsetLeft}catch(ex){}l.profile.end("total");console.log("**Groups**\n",l.toString());if(_loadLog){_loadLog.profile.end("Total Loading");console.log("** Total Loading **\n",_loadLog.toString());_loadLog=null}})}])}else if(that.currentDisplayType()=="mostvisited"){for(var i=0;i!=that._mostVisitedIntervals.length;i++){var interval=that._mostVisitedIntervals[i];var item=fvdSpeedDial.SpeedDial.Builder.Groups.item(_("newtab_mostvisited_interval_"+interval),interval);tmpContainer.appendChild(item)}groupsBox.parentNode.replaceChild(tmpContainer,groupsBox)}else{groupsBox.parentNode.replaceChild(tmpContainer,groupsBox)}},displayAdditionalList:function(params){params=params||{};var that=this;try{var listElem=document.getElementsByClassName("additionalGroupsList")[0];if(listElem.getAttribute("active")==1){this.closeAdditionalList();return}var btn=document.getElementsByClassName("additionalGroupsButton")[0];var pos=fvdSpeedDial.Utils.getOffset(btn);listElem.style.left=pos.left+"px";if(params.disableAnimation){listElem.setAttribute("disableanim",1);setTimeout(function(){listElem.removeAttribute("disableanim")},500)}listElem.setAttribute("active",1);document.addEventListener("click",that.closeAdditionalList,false)}catch(ex){}},closeAdditionalList:function(){try{var listElem=document.getElementsByClassName("additionalGroupsList")[0];listElem.setAttribute("active",0);document.removeEventListener("click",fvdSpeedDial.SpeedDial.Groups.closeAdditionalList)}catch(ex){}}},syncMostVisited:function(){fvdSpeedDial.Storage.MostVisited.invalidateCache(true);if(this.currentDisplayType()=="mostvisited"){this.sheduleFullRebuild()}},mostVisitedRestoreRemoved:function(){var that=this;fvdSpeedDial.Storage.MostVisited.restoreRemoved(function(){if(that.currentDisplayType()=="mostvisited"){that.sheduleFullRebuild()}})},openAllCurrentMostVisitedLinks:function(){fvdSpeedDial.Storage.MostVisited.getData({interval:fvdSpeedDial.SpeedDial.currentGroupId(),count:fvdSpeedDial.Prefs.get("sd.max_most_visited_records")},function(data){for(var i=0;i!=data.length;i++){fvdSpeedDial.Utils.Opener.backgroundTab(data[i].url)}})},removeAllCurrentMostVisitedLinks:function(){fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_links_all_title"),_("dlg_confirm_remove_links_all_text"),function(r){if(r){fvdSpeedDial.Storage.MostVisited.getData({interval:fvdSpeedDial.SpeedDial.currentGroupId(),count:fvdSpeedDial.Prefs.get("sd.max_most_visited_records")},function(data){for(var i=0;i!=data.length;i++){(function(i){fvdSpeedDial.Storage.MostVisited.deleteId(data[i].id,function(result){if(i==data.length-1){fvdSpeedDial.SpeedDial.sheduleFullRebuild()}})})(i)}})}})},openAllCurrentRecentlyClosedLinks:function(){fvdSpeedDial.Storage.RecentlyClosed.getData({count:fvdSpeedDial.Prefs.get("sd.max_recently_closed_records")},function(data){for(var i=0;i!=data.length;i++){fvdSpeedDial.Utils.Opener.backgroundTab(data[i].url)}})},removeAllCurrentRecentlyClosedLinks:function(){fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_links_all_title"),_("dlg_confirm_remove_links_all_text"),function(r){if(r){fvdSpeedDial.Storage.RecentlyClosed.removeAll(function(){fvdSpeedDial.SpeedDial.sheduleFullRebuild()})}})},wrapperDblClick:function(event){this.toggleExpand()},getExpandState:function(){var currentState=_b(fvdSpeedDial.Prefs.get("sd."+this.currentDisplayType()+"_expanded"));if(fvdSpeedDial.PowerOffClient.isHidden()){return false}return currentState},toggleExpand:function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}var newVal=!_b(fvdSpeedDial.Prefs.get("sd."+fvdSpeedDial.SpeedDial.currentDisplayType()+"_expanded"));fvdSpeedDial.Prefs.set("sd."+fvdSpeedDial.SpeedDial.currentDisplayType()+"_expanded",newVal)},refreshShowHideButton:function(){var b=document.querySelector("#searchBar .rightMenu .showHide");if(this.getExpandState()){b.setAttribute("active","1")}else{b.setAttribute("active","0")}},refreshExpandState:function(args){var currentState=this.getExpandState();if(args){if(args.ifcollapsed){if(currentState){return}}}var wrapper=document.getElementById("speedDialWrapper");wrapper.setAttribute("expanded",currentState?1:0);var that=this;if(!currentState){var collapsedContainer=document.querySelector("#speedDialCollapsedContent");if(fvdSpeedDial.PowerOffClient.isHidden()){collapsedContainer.setAttribute("type","poweroff")}else if(fvdSpeedDial.PowerOff.isEnabled()){collapsedContainer.setAttribute("type","poweroffmessage")}else{collapsedContainer.setAttribute("type","simple")}}that.refreshSpeedDialWrapperHeight();that.refreshShowHideButton();that.refreshLightCollapsedMessageVisibility()},refreshLightCollapsedMessageVisibility:function(){var collapsedContainer=document.querySelector("#speedDialCollapsedContent");var collapsedType=collapsedContainer.getAttribute("type");var needShow=false;switch(collapsedType){case"poweroffmessage":if(!_b(fvdSpeedDial.Prefs.get("collapsed_message.without_poweroff.display"))){needShow=true}break;case"simple":if(!_b(fvdSpeedDial.Prefs.get("collapsed_message.with_poweroff.display"))){needShow=true}break}if(this.getExpandState()){needShow=false}if(needShow){fvdSpeedDial.lightCollapsedMessage.show()}else{fvdSpeedDial.lightCollapsedMessage.hide()}},refreshBackground:function(){fvdSpeedDial.Storage.getMisc("sd.background",function(imageUrl){var bgData={color:fvdSpeedDial.Prefs.get("sd.background_color"),useColor:_b(fvdSpeedDial.Prefs.get("sd.background_color_enabled")),imageUrl:imageUrl+"?"+Math.random(),imageType:fvdSpeedDial.Prefs.get("sd.background_url_type")};var bgContainer=document.documentElement;fvdSpeedDial.Background.setToElem(bgData,bgContainer)})},refreshCSS:function(){fvdSpeedDial.CSS.refresh()},sheduleCSSRefresh:function(){var that=this;this._needCSSRefresh=true;setTimeout(function(){if(that._needCSSRefresh){that.refreshCSS()}},100)},sheduleBackgroundRefresh:function(){var that=this;this._needBackgroundRefresh=true;setTimeout(function(){if(that._needBackgroundRefresh){that.refreshBackground()}},100)},_needRebuildChecker:function(){if(fvdSpeedDial.SpeedDial._needRebuildGroupsList){fvdSpeedDial.SpeedDial._needRebuildGroupsList=false;fvdSpeedDial.SpeedDial.Groups.rebuildGroupsList()}if(fvdSpeedDial.SpeedDial._needRebuild){fvdSpeedDial.SpeedDial._needRebuild=false;fvdSpeedDial.SpeedDial.rebuildCells()}},_getSpeedDialCellById:function(dialId){return document.getElementById("dialCell_"+dialId)},_viewportWidth:function(){var maxRightScrollbarWidth=20;return window.innerWidth-maxRightScrollbarWidth},_viewportHeightForHorizScroll:function(){return window.innerHeight-document.getElementById("cellsContainer").getBoundingClientRect().top},_viewportHeight:function(){return document.body.scrollHeight},_prefsListener:function(name,value){if("sd.thumbs_type"==name||"sd.top_sites_columns"==name){if(name=="sd.thumbs_type"){fvdSpeedDial.Prefs.set("sd.top_sites_columns","auto")}if(fvdSpeedDial.SpeedDial.currentDisplayType()=="speeddial"){fvdSpeedDial.SpeedDial.sheduleRebuild()}}else if("sd.scrolling"==name){window.scrollTo(0,0)}else if("sd.display_mode"==name){window.scrollTo(0,0)}else if("sd.all_groups_limit_dials"==name){if(fvdSpeedDial.SpeedDial.currentDisplayType()=="speeddial"){if(fvdSpeedDial.SpeedDial.currentGroupId()==0){fvdSpeedDial.SpeedDial.sheduleRebuild()}}}else if("sd.thumbs_type_most_visited"==name||"sd.most_visited_columns"==name||"sd.max_most_visited_records"==name){if(fvdSpeedDial.SpeedDial.currentDisplayType()=="mostvisited"){fvdSpeedDial.SpeedDial.sheduleRebuild()}if(name=="sd.thumbs_type_most_visited"){fvdSpeedDial.Prefs.set("sd.most_visited_columns","auto")}}else if("sd.max_recently_closed_records"==name||"sd.recentlyclosed_columns"==name){if(fvdSpeedDial.SpeedDial.currentDisplayType()=="recentlyclosed"){fvdSpeedDial.SpeedDial.sheduleRebuild()}}else if(name=="sd.search_bar_expanded"){fvdSpeedDial.SpeedDial.refreshSpeedDialWrapperHeight()}else if(["sd.enable_top_sites","sd.enable_most_visited","sd.enable_recently_closed"].indexOf(name)!=-1){fvdSpeedDial.SpeedDial._displayType=null}else if(["sd.speeddial_expanded","sd.mostvisited_expanded","sd.recentlyclosed_expanded"].indexOf(name)!=-1){var displayType=name.replace("sd.","").replace("_expanded","");if(displayType==fvdSpeedDial.SpeedDial.currentDisplayType()){fvdSpeedDial.SpeedDial.refreshExpandState()}if(value&&fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){fvdSpeedDial.SpeedDial.sheduleRebuild()}}else if(name.indexOf("sd.text.")==0||["sd.show_urls_under_dials","sd.dials_opacity","sd.show_icons_and_titles_above_dials","sd.display_dial_background","sd.display_quick_menu_and_clicks"].indexOf(name)!=-1){fvdSpeedDial.SpeedDial.sheduleCSSRefresh()}else if(name.indexOf("sd.background")==0){fvdSpeedDial.SpeedDial.sheduleBackgroundRefresh()}else if(name=="collapsed_message.with_poweroff.display"||name=="collapsed_message.without_poweroff.display"){fvdSpeedDial.SpeedDial.refreshCollapsedMessages();fvdSpeedDial.SpeedDial.refreshLightCollapsedMessageVisibility()}else if(name=="sd.display_mirror"){fvdSpeedDial.SpeedDial.refreshEnableMirrors()}},_getDialIdByCell:function(cell){return cell.getAttribute("id").replace("dialCell_","")},_getGroupByItem:function(item){return item.getAttribute("id").replace("group_select_","")},_dialsAreaSize:function(params){if(typeof params.objects=="undefined"){params.objects=document.getElementById("cellsContainer").childNodes.length}var cellSize=this._currentCellSize();var cellsInRow=this.cellsInRowMax(null,null,params).cols;var areaWidth=cellSize.width*cellsInRow+(cellsInRow-1)*this._cellsMarginX;return{width:areaWidth}},_currentSettingsColumnsCount:function(){switch(this.currentDisplayType()){case"speeddial":return fvdSpeedDial.Prefs.get("sd.top_sites_columns");break;case"mostvisited":return fvdSpeedDial.Prefs.get("sd.most_visited_columns");break;case"recentlyclosed":return fvdSpeedDial.Prefs.get("sd.recentlyclosed_columns");break}},_currentListElemSize:function(){if(this.currentDisplayType()=="mostvisited"){return this._listElemSizeMostVisited}else{return this._listElemSize}},_currentCellSize:function(){var size=null;var that=this;if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){size=parseInt(fvdSpeedDial.Prefs.get("sd.custom_dial_size_fancy"))}else{size=parseInt(fvdSpeedDial.Prefs.get("sd.custom_dial_size"))}return{width:size,height:Math.round(size/that._cellsSizeRatio)}},_listContainer:function(){return document.getElementById("listContainer")},_cellsContainer:function(){return document.getElementById("cellsContainer")}};fvdSpeedDial.SpeedDial=new SpeedDial})();(function(){var DragAndDrop=function(){};DragAndDrop.prototype={elem:null,_elemOffset:null,_elemsMargin:null,_elementsPositions:[],_elementsGrid:{},_dragSuccessListener:null,_elemDraggedOn:null,_maxColumns:null,_onGroupIdNow:-1,_callbacks:{},init:function(){var that=this;document.addEventListener("mouseup",function(event){if(that.isDragActive()){that.endDrag(event)}},true);document.addEventListener("mousemove",function(event){if(that.elem){that.elem.style.display="none";var elemUnder=document.elementFromPoint(event.x,event.y);var groupBlured=false;var groupSelected=false;if(elemUnder&&elemUnder.parentNode&&(elemUnder.parentNode.className=="group"||elemUnder.className=="group")){var groupId=0;if(elemUnder.className=="group"){groupId=parseInt(elemUnder.getAttribute("id").replace("group_select_",""),10)}else{groupId=parseInt(elemUnder.parentNode.getAttribute("id").replace("group_select_",""),10)}if(that._onGroupIdNow!=groupId){that._onGroupIdNow=groupId;groupBlured=true;groupSelected=true}}else{if(that._onGroupIdNow!=-1){that._onGroupIdNow=-1;groupBlured=true}if(elemUnder&&(elemUnder.getAttribute("id")=="groupsBox"||elemUnder.className=="group")){that._onGroupIdNow=0;groupSelected=true}}that.elem.style.display="";if(groupBlured){if(that._callbacks.groupBlured){that._callbacks.groupBlured()}}if(groupSelected){if(that._callbacks.groupFocus){that._callbacks.groupFocus(that._onGroupIdNow)}}var mouseX=event.x;var mouseY=event.y+document.body.scrollTop;if(that._elementsPositions.length==0){var displayType=fvdSpeedDial.SpeedDial.currentThumbsMode();if(displayType=="list"){that._elemsMargin=fvdSpeedDial.SpeedDial._listElemMarginY}else{that._elemsMargin=fvdSpeedDial.SpeedDial._cellsMarginX}var dials=[];if(displayType=="list"){dials=document.querySelectorAll('.newtabListElem[type="speeddial"]')}else{dials=document.querySelectorAll('.newtabCell[type="speeddial"]')}var cellSize=fvdSpeedDial.SpeedDial._currentCellSize();that._elementsGrid={};for(var i=0;i!=dials.length;i++){var p=fvdSpeedDial.Utils.getOffset(dials[i]);var dialPosData={leftTopPos:p,rightBottomPos:{left:p.left+dials[i].offsetWidth,top:p.top+dials[i].offsetHeight},centerPos:{left:p.left+dials[i].offsetWidth/2,top:p.top+dials[i].offsetHeight/2},elem:dials[i]};that._elementsPositions.push(dialPosData);that._elementsGrid[dials[i].getAttribute("col")+"x"+dials[i].getAttribute("row")]=dialPosData}that._maxColumns=fvdSpeedDial.SpeedDial.cellsInRowMax();that._maxListRows=fvdSpeedDial.SpeedDial.Builder.listElemCountInCol(that._maxColumns,dials.length)}if(that._callbacks.dragMove){that._callbacks.dragMove(mouseX,mouseY,that._elementsPositions)}var marginLeft=mouseX-that.elem.getAttribute("startDragPosX");var marginTop=mouseY-that.elem.getAttribute("startDragPosY");if(that._elemOffset==null){that._elemOffset=fvdSpeedDial.Utils.getOffset(that.elem)}if(!that.elem.hasAttribute("noclick")){if(marginLeft!=0||marginTop!=0){that.elem.setAttribute("noclick",1)}}var viewPortWidth=fvdSpeedDial.SpeedDial._viewportWidth();var rightCornerLeft=that._elemOffset.left+marginLeft+that.elem.offsetWidth;if(rightCornerLeft<viewPortWidth||fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){that.elem.style.marginLeft=marginLeft+"px"}that.elem.style.marginTop=marginTop+"px";if(!that.elem.hasAttribute("indrag")){that.elem.setAttribute("indrag",1)}var dialCenterPos={left:that._elemOffset.left+marginLeft+that.elem.offsetWidth/2,top:that._elemOffset.top+marginTop+that.elem.offsetHeight/2};var elemDraggedOn=null;var ignoreInCicleElem=null;for(var i=0;i!=that._elementsPositions.length;i++){var elemPos=that._elementsPositions[i];if(ignoreInCicleElem==elemPos.elem){continue}if(elemPos.elem==that.elem){continue}var cond=false;if(fvdSpeedDial.SpeedDial.currentThumbsMode()=="list"){cond=dialCenterPos.left>=elemPos.leftTopPos.left&&dialCenterPos.left<=elemPos.rightBottomPos.left&&(dialCenterPos.top>=elemPos.leftTopPos.top-that._elemsMargin&&dialCenterPos.top<=elemPos.rightBottomPos.top+that._elemsMargin)}else{cond=dialCenterPos.left>=elemPos.leftTopPos.left-that._elemsMargin&&dialCenterPos.left<=elemPos.rightBottomPos.left+that._elemsMargin&&(dialCenterPos.top>=elemPos.leftTopPos.top&&dialCenterPos.top<=elemPos.rightBottomPos.top)}if(cond){if(fvdSpeedDial.SpeedDial.currentThumbsMode()=="list"){var insertAttribute=null;var col=elemPos.elem.getAttribute("col");var row=elemPos.elem.getAttribute("row");var newCol=col;var newRow=row;if(dialCenterPos.top>elemPos.centerPos.top){insertAttribute="after";newRow++;if(newRow>=that._maxListRows){newRow=0;newCol++}}else{insertAttribute="before";newRow--;if(newRow<0){newCol--;if(newCol<0){newCol=0;newRow=0}else{newRow=that._maxListRows-1}}}if(newCol==that.elem.getAttribute("col")&&newRow==that.elem.getAttribute("row")){if(elemPos.elem.hasAttribute("dragon")){elemPos.elem.removeAttribute("dragon")}continue}if(!elemPos.elem.hasAttribute("dragon")){elemPos.elem.setAttribute("dragon",1)}if(insertAttribute){elemPos.elem.setAttribute("insert_type",insertAttribute)}elemDraggedOn=elemPos.elem;if(insertAttribute=="after"){row++;insertAttribute="before"}else if(insertAttribute=="before"){row--;insertAttribute="after"}if(typeof that._elementsGrid[col+"x"+row]!="undefined"){var additionalDraggedElem=that._elementsGrid[col+"x"+row].elem;ignoreInCicleElem=additionalDraggedElem;additionalDraggedElem.setAttribute("insert_type",insertAttribute);additionalDraggedElem.setAttribute("dragon",1)}}else{var insertAttribute=null;var col=elemPos.elem.getAttribute("col");var row=elemPos.elem.getAttribute("row");var newCol=col;var newRow=row;if(dialCenterPos.left>elemPos.centerPos.left){insertAttribute="after";newCol++;if(newCol>=that._maxColumns){newCol=0;newRow++}}else{insertAttribute="before";newCol--;if(newCol<0){newRow--;if(newRow<0){newRow=0;newCol=0}else{newCol=that._maxColumns-1}}}if(newCol==that.elem.getAttribute("col")&&newRow==that.elem.getAttribute("row")){if(elemPos.elem.hasAttribute("dragon")){elemPos.elem.removeAttribute("dragon");if(that._callbacks.dragOut){that._callbacks.dragOut(elemPos.elem)}}continue}if(!elemPos.elem.hasAttribute("dragon")){elemPos.elem.setAttribute("dragon",1)}if(insertAttribute){elemPos.elem.setAttribute("insert_type",insertAttribute);if(that._callbacks.dragOn){that._callbacks.dragOn(elemPos.elem)}}elemDraggedOn=elemPos.elem;if(insertAttribute=="after"){col++;insertAttribute="before"}else if(insertAttribute=="before"){col--;insertAttribute="after"}if(typeof that._elementsGrid[col+"x"+row]!="undefined"){var additionalDraggedElem=that._elementsGrid[col+"x"+row].elem;ignoreInCicleElem=additionalDraggedElem;additionalDraggedElem.setAttribute("insert_type",insertAttribute);additionalDraggedElem.setAttribute("dragon",1);if(that._callbacks.dragOn){that._callbacks.dragOn(additionalDraggedElem)}}}}else{if(elemPos.elem.hasAttribute("dragon")){elemPos.elem.removeAttribute("dragon");elemPos.elem.removeAttribute("insert_type");if(that._callbacks.dragOut){that._callbacks.dragOut(elemPos.elem)}}}}that._elemDraggedOn=elemDraggedOn}},true)},startDrag:function(elem,listener,event,callbacks){this._onGroupIdNow=-1;this._elementsPositions=[];this._callbacks=callbacks||{};this._dragSuccessListener=listener;this.elem=elem;this._elemDraggedOn=null;this._elemOffset=null;this.elem.setAttribute("startDragPosX",event.x);this.elem.setAttribute("startDragPosY",event.y+document.body.scrollTop);document.getElementById("speedDialWrapper").setAttribute("state","dragging")},endDrag:function(event){var that=this;document.getElementById("speedDialWrapper").setAttribute("state","normal");this.elem.removeAttribute("startDragPosX");this.elem.removeAttribute("startDragPosY");if(this._elemDraggedOn){if(this._dragSuccessListener){this._dragSuccessListener(this._elemDraggedOn)}}this.elem.style.marginLeft="";this.elem.style.marginTop="";that.elem.removeAttribute("indrag",1);that.elem.setAttribute("flyAfterDrag",1);var _elem=that.elem;setTimeout(function(){try{_elem.removeAttribute("flyAfterDrag")}catch(ex){}},200);this.elem=null;if(this._elementsPositions.length!=0){for(var i=0;i!=this._elementsPositions.length;i++){var elemPos=this._elementsPositions[i];if(elemPos.elem.hasAttribute("dragon")){elemPos.elem.removeAttribute("dragon");elemPos.elem.removeAttribute("insert_type")}}}if(!that._elemDraggedOn){if(that._callbacks.drop){that._callbacks.drop(event)}}if(that._callbacks.groupBlured){that._callbacks.groupBlured()}if(that._onGroupIdNow>0){if(that._callbacks.dropOnGroup){that._callbacks.dropOnGroup(that._onGroupIdNow)}}},isDragActive:function(){return this.elem!=null}};this.DragAndDrop=new DragAndDrop}).apply(fvdSpeedDial.SpeedDial);(function(){const mirrorSurfaceDistance=0;const CLICK_SCREEN_OVER=100;var cellsMirrors={};var mirrorsElemsAttrs={};var mirrorsCheckInterval=null;const mirrorUpdatePeriod=100;const mirrorFadeTimeout=200;var Builder=function(){var that=this};Builder.prototype={_effSizeDim:function(dim){return dim+fvdSpeedDial.SpeedDial._dialBodyPadding*2},listViewContainerSize:function(container,countInRow){var countChilds=container.childNodes.length;var countInCol=this.listElemCountInCol(countInRow,countChilds);if(countInRow>countChilds){countInRow=countChilds}var size=fvdSpeedDial.SpeedDial._currentListElemSize();var width=size.width*countInRow+fvdSpeedDial.SpeedDial._listElemMarginX*countInRow;

var height=size.height*countInCol+fvdSpeedDial.SpeedDial._listElemMarginY*countInCol;return{width:width,height:height}},listCol:function(){var row=document.createElement("div");row.className="listCol";return row},listElemCountInCol:function(inRow,totalCount){return Math.ceil(totalCount/inRow)},listElem:function(num,countInCol,data,displayType){var dataPreview=this.getDialPreviewData(data);var cell=fvdSpeedDial.Templates.clone("prototype_"+displayType+"ListElem");cell.setAttribute("id","dialCell_"+data.id);cell.setAttribute("type",displayType);var textNode=cell.getElementsByClassName("text")[0];textNode.textContent=data.displayTitle;var favicon=cell.getElementsByTagName("img")[0];favicon.setAttribute("src","chrome://favicon/"+data.url);this._assignEvents(cell,data,displayType,"list");fvdSpeedDial.ContextMenus.assignToElem(cell,displayType);this.setListElemPos(cell,num,countInCol);cell.style.position="absolute";if(displayType=="speeddial"){cell.setAttribute("position",data.position)}var size=fvdSpeedDial.SpeedDial._currentListElemSize();cell.style.height=size.height+"px";if(!data.displayTitle){if(displayType!="recentlyclosed"){if(data.get_screen_method=="manual"){cell.setAttribute("_title",_("newtab_click_to_get_title"))}else{cell.setAttribute("_title",_("newtab_getting_title"));fvdSpeedDial.SpeedDial.ThumbManager.hiddenCaptureThumb({data:data,type:cell.getAttribute("type"),saveImage:false,resetScreenMaked:false,interval:fvdSpeedDial.SpeedDial.currentGroupId(),elemId:cell.getAttribute("id"),elem:cell})}cell.setAttribute("notitle",1)}else{cell.setAttribute("_title","")}}else{cell.setAttribute("_title",data.displayTitle)}cell.setAttribute("_url",dataPreview.url);if(displayType=="mostvisited"){var viewsText=cell.getElementsByClassName("views")[0];var inGroup=cell.getElementsByClassName("ingroup")[0];var views=null;var ingroup=null;views=_("newtab_mostvisited_views");ingroup=_("newtab_mostvisited_ingroup");viewsText.textContent=views+": "+data.totalVisits;inGroup.textContent=ingroup+": "+data.inGroup}return cell},setListElemPos:function(cell,num,countInCol){var pos=this._listElemPos(num,countInCol);cell.style.top=pos.y+"px";cell.style.left=pos.x+"px";cell.setAttribute("col",pos.col);cell.setAttribute("row",pos.row);cell.setAttribute("index",num)},plusCell:function(num,countInRow,size,countRowsTotal){var cell=fvdSpeedDial.Templates.clone("prototype_speeddialCell");cell.removeAttribute("id");cell.setAttribute("width",size.width);cell.setAttribute("height",size.height);var dialPos=this._getDialXY(num,countInRow,size);cell.style.left=dialPos.x+"px";cell.style.top=dialPos.y+"px";cell.setAttribute("col",dialPos.col);cell.setAttribute("row",dialPos.row);var body=cell.getElementsByClassName("body")[0];body.style.width=this._effSizeDim(size.width)+"px";body.style.height=this._effSizeDim(size.height)+"px";cell.style.width=this._effSizeDim(size.width)+fvdSpeedDial.SpeedDial._dialBodyPadding*2+"px";cell.setAttribute("type","plus");this.setDialSkew(cell,dialPos,countInRow,size,countRowsTotal);cell.onclick=function(event){if(event.button==0){fvdSpeedDial.Dialogs.addDial()}};cell.querySelector(".footer span").innerHTML="&nbsp;";return cell},cellsContainerHeight:function(countCells,countInRow,size){var height=0;var num=countCells-1;var dialPos=this._getDialXY(num,countInRow,size);height=dialPos.y+size.height+fvdSpeedDial.SpeedDial.cellsMarginY();if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){height+=200}return height},refreshLastRow:function(){var _dials=document.querySelectorAll(".newtabCell");var maxRow=0,i,row;for(i=0;i!=_dials.length;i++){_dials[i].removeAttribute("lastrow");row=parseInt(_dials[i].getAttribute("row"),10);if(row>maxRow){maxRow=row}}for(i=0;i!=_dials.length;i++){row=parseInt(_dials[i].getAttribute("row"),10);if(row==maxRow){_dials[i].setAttribute("lastrow",1)}}},refreshDialsByPositions:function(countInRow,displayMode,size){var i,_dials,dials;if(displayMode=="list"){_dials=document.getElementsByClassName("newtabListElem");var countInCol=this.listElemCountInCol(countInRow.cols,_dials.length);if(typeof countInRow=="object"){countInRow=countInRow.cols}dials=[];for(i=0;i!=_dials.length;i++){dials.push(_dials[i])}dials.sort(function(a,b){return a.getAttribute("position")-b.getAttribute("position")});for(i=0;i!=dials.length;i++){this.setListElemPos(dials[i],i,countInCol)}}else{_dials=document.querySelectorAll(".newtabCell[type=speeddial]");if(fvdSpeedDial.SpeedDial.Scrolling.activeScrollingType()=="horizontal"){countInRow=fvdSpeedDial.SpeedDial.cellsInRowMax(null,null,{objects:_dials.length})}if(typeof countInRow=="object"){if(countInRow.rows){countInRow=Math.ceil(_dials.length/countInRow.rows);if(_b(fvdSpeedDial.Prefs.get("sd.display_plus_cells"))){countInRow++}}else{countInRow=countInRow.cols}}dials=[];for(i=0;i!=_dials.length;i++){if(_dials[i].hasAttribute("type")&&_dials[i].getAttribute("type")=="plus"){continue}dials.push(_dials[i])}dials.sort(function(a,b){return a.getAttribute("position")-b.getAttribute("position")});var countRows=document.getElementById("cellsContainer").getAttribute("rows");for(i=0;i!=dials.length;i++){var cell=dials[i];var dialPos=this._getDialXY(i,countInRow,size);this.setDialPosition(cell,dialPos);this.setDialSkew(cell,dialPos,countInRow,size,countRows)}}this.refreshLastRow()},skewAngle:function(col,row,middle,countRowsTotal,inRow){var skewMax=1.7;var middleRow=Math.floor(countRowsTotal/2);if(inRow%2===0){middle++}var skewDeg=skewMax*Math.abs(col-middle)/middle;var type="top";if(row>=middleRow){type="down"}if(type=="down"){}return{deg:skewDeg,type:type}},rotateAngle:function(col,row,middle,countRowsTotal,inRow){if(inRow%2===0){inRow++;middle=Math.ceil(inRow/2)-1;if(col>=middle){col++}}var skewMax=fvdSpeedDial.Prefs.get("sd.rotate_angle_max");var newSkewMax;var originLeft;var middleRow=Math.floor(countRowsTotal/2);newSkewMax=inRow/10*skewMax;if(newSkewMax>skewMax){newSkewMax=skewMax}skewMax=newSkewMax;var fixedMiddle=false;var skewDeg=skewMax*Math.abs(col-middle)/middle;var type="top";if(row>=middleRow){type="down"}if(type=="down"){}var originTop=0;if(skewDeg==0){originLeft=0}else{if(col<=middle){originLeft=100+(middle-col-1)*50}else{originLeft=0-(col-middle-1)*50}}return{deg:skewDeg,type:type,originLeft:originLeft,originTop:originTop}},dialZ:function(col,row,middle,countRowsTotal,inRow,size){var z=0;if(col!=middle){var c=middle;var inc=col<middle?-1:1;while(c!=col){z=z+size.width*Math.sin(this.rotateAngle(c,row,middle,countRowsTotal,inRow).deg*Math.PI/180);c+=inc}}return z},setDialSkew:function(cell,dialPos,inRow,size,countRowsTotal){if(fvdSpeedDial.Prefs.get("sd.display_mode")!="fancy"){return}var middle=Math.ceil(inRow/2)-1;var angle=0;if(dialPos.col!=middle||inRow%2==0){angle=this.rotateAngle(dialPos.col,dialPos.row,middle,countRowsTotal,inRow);if(dialPos.col>middle){angle.deg=-angle.deg}cell.style.webkitTransform="rotateY("+angle.deg+"deg)";cell.style.webkitTransformOrigin=angle.originLeft+"% "+angle.originTop+"%";cell.setAttribute("skew",angle.deg)}else{cell.style.webkitTransform=""}var relPos=dialPos.col;if(relPos>middle){relPos=inRow-1-dialPos.col}},setDialPosition:function(cell,dialPos){cell.style.left=dialPos.x+"px";cell.style.top=dialPos.y+"px";cell.setAttribute("row",dialPos.row);cell.setAttribute("col",dialPos.col)},cellTitle:function(data){var params={url:data.url,title:data.title};return params.title+"\n"+params.url},getDialPreviewData:function(data){var previewData={};var override=fvdSpeedDial.Config.DIAL_PREVIEW_OVERRIDE[data.global_id];for(var k in data){var v=data[k];if(override&&override[k]){v=override[k]}previewData[k]=v}return previewData},cell:function(data,num,countInRow,displayType,displayMode,size,countRowsTotal){var cell=fvdSpeedDial.Templates.clone("prototype_"+displayType+"Cell");var dataPreview=this.getDialPreviewData(data);cell.setAttribute("data-url",data.url);cell.setAttribute("width",size.width);cell.setAttribute("height",size.height);cell.setAttribute("id","dialCell_"+data.id);cell.setAttribute("type",displayType);var dialPos=this._getDialXY(num,countInRow,size);this.setDialPosition(cell,dialPos,countInRow);this.setDialSkew(cell,dialPos,countInRow,size,countRowsTotal);cell.setAttribute("position",data.position);if(data.displayDialBg){cell.setAttribute("displayDialBg",data.displayDialBg)}var body=cell.getElementsByClassName("body")[0];body.style.width=this._effSizeDim(size.width)+"px";body.style.height=this._effSizeDim(size.height)+"px";cell.style.width=this._effSizeDim(size.width)+fvdSpeedDial.SpeedDial._dialBodyPadding*2+"px";var titleBlock=cell.getElementsByClassName("head")[0].getElementsByTagName("span")[0];if(data.displayTitle){titleBlock.textContent=data.displayTitle}else{if(data.get_screen_method=="manual"){titleBlock.textContent=_("newtab_click_to_get_title")}else{titleBlock.textContent=_("newtab_getting_title")}}if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){cell.setAttribute("title",this.cellTitle({title:titleBlock.textContent,url:dataPreview.url}))}if(!data.displayTitle){cell.setAttribute("notitle",1)}var footerTitleBlock=cell.getElementsByClassName("footer")[0].getElementsByTagName("span")[0];footerTitleBlock.textContent=fvdSpeedDial.Utils.urlToCompareForm(dataPreview.url);var favicon=cell.getElementsByClassName("head")[0].getElementsByTagName("img")[0];favicon.setAttribute("src","chrome://favicon/"+data.url);var that=this;var screenParent=body.getElementsByClassName("screenParent")[0];fvdSpeedDial.SpeedDial.ThumbManager.setThumbToElement({elem:cell,data:data,cellSize:size,interval:fvdSpeedDial.SpeedDial.currentGroupId(),nocache:data.thumb_version});var menuOverlay=cell.getElementsByClassName("menuOverlay")[0];if(displayType=="speeddial"){var clicksText=menuOverlay.getElementsByClassName("text")[0];var spanClicksCount=document.createElement("span");spanClicksCount.className="clicksCount";spanClicksCount.textContent=data.clicks;clicksText.appendChild(document.createTextNode(_("newtab_dial_clicks")+": "));clicksText.appendChild(spanClicksCount)}else if(displayType=="mostvisited"){var viewsText=cell.getElementsByClassName("views")[0];var inGroup=cell.getElementsByClassName("ingroup")[0];var views=null;var ingroup=null;if(displayMode!="small"){views=_("newtab_mostvisited_views");ingroup=_("newtab_mostvisited_ingroup")}else{views=_("newtab_mostvisited_views_small");ingroup=_("newtab_mostvisited_ingroup_small")}viewsText.textContent=views+": "+data.totalVisits;inGroup.textContent=ingroup+": "+data.inGroup}fvdSpeedDial.ContextMenus.assignToElem(cell,displayType);this._assignEvents(cell,data,displayType,displayMode);return cell},Groups:{item:function(text,groupId,countDials){var item=document.createElement("div");item.setAttribute("class","group");var spanName=document.createElement("span");var spanCount=document.createElement("span");spanName.className="groupName";if(typeof countDials!="undefined"){spanName.textContent=text;spanCount.textContent=" ("+countDials+")"}else{spanName.textContent=text}item.appendChild(spanName);item.appendChild(spanCount);var that=this;item.addEventListener("dblclick",function(event){event.stopPropagation()},false);item.addEventListener("click",function(event){fvdSpeedDial.SpeedDial.setCurrentGroupId(groupId)},false);item.addEventListener("mouseup",function(event){if(event.button==2){fvdSpeedDial.SpeedDial.setCurrentGroupId(groupId)}},false);if(fvdSpeedDial.SpeedDial.currentGroupId()==groupId){item.setAttribute("current","1")}else{item.setAttribute("current","0")}item.setAttribute("id","group_select_"+groupId);return item},additionalGroupsButton:function(){var additionalGroupsButton=document.createElement("div");additionalGroupsButton.className="additionalGroupsButton";var img=document.createElement("div");img.className="img";additionalGroupsButton.appendChild(img);additionalGroupsButton.addEventListener("click",function(event){fvdSpeedDial.SpeedDial.Groups.displayAdditionalList();event.stopPropagation()},false);return additionalGroupsButton},additionalList:function(groups){var container=document.createElement("div");container.className="additionalGroupsList";var that=this;for(var i=0;i!=groups.length;i++){var group=groups[i];(function(group){var groupElem=that.item(group.name,group.id,group.count_dials);fvdSpeedDial.ContextMenus.assignToElem(groupElem,"speeddialGroup");container.appendChild(groupElem)})(group)}var manageGroups=document.createElement("div");manageGroups.className="manageGroups";manageGroups.textContent=_("newtab_manage_groups");manageGroups.addEventListener("click",function(){fvdSpeedDial.Dialogs.manageGroups()},false);container.appendChild(document.createElement("hr"));container.appendChild(manageGroups);return container}},_getDialXY:function(num,countInRow,size){var xInCells=num%countInRow;var yInCells=Math.floor(num/countInRow);var x=xInCells*size.width+(xInCells>0?xInCells*fvdSpeedDial.SpeedDial._cellsMarginX:0);var y=yInCells*size.height+(yInCells>0?yInCells*fvdSpeedDial.SpeedDial.cellsMarginY():0);return{x:x,y:y,row:yInCells,col:xInCells}},_listElemPos:function(num,countInCol){var yInCells=num%countInCol;var xInCells=Math.floor(num/countInCol);var size=fvdSpeedDial.SpeedDial._currentListElemSize();var x=xInCells*size.width+(xInCells>0?xInCells*fvdSpeedDial.SpeedDial._listElemMarginX:0);var y=yInCells*size.height+(yInCells>0?yInCells*fvdSpeedDial.SpeedDial._listElemMarginY:0);return{x:x,y:y,col:xInCells,row:yInCells}},_assignEvents:function(cell,data,displayType,displayMode){var clickEventAssigned=false;cell.addEventListener("mousedown",function(event){event.preventDefault()});if(displayMode!="list"){var favicon=cell.getElementsByClassName("head")[0].getElementsByTagName("img")[0];favicon.addEventListener("mousedown",function(event){event.preventDefault()},false);if(data.thumb_source_type=="screen"&&data.get_screen_method=="manual"){if(data.screen_maked==0){clickEventAssigned=true;cell.addEventListener("click",function(event){if(cell.hasAttribute("noclick")){cell.removeAttribute("noclick");return}if(event.button==0){fvdSpeedDial.SpeedDial.makeThumb(data.id,data.url,displayType,data.screen_delay)}event.stopPropagation()},false)}}}if(!clickEventAssigned){if(!data.displayTitle&&data.get_screen_method=="manual"){clickEventAssigned=true;cell.addEventListener("click",function(event){if(cell.hasAttribute("noclick")){cell.removeAttribute("noclick");return}if(event.button==0){fvdSpeedDial.SpeedDial.makeThumb(data.id,data.url,displayType,data.screen_delay,false)}event.stopPropagation()},false)}}cell.addEventListener("dblclick",function(event){event.stopPropagation()},false);if(!clickEventAssigned){var allowAddClick=true;cell.addEventListener("click",function(event){if(cell.hasAttribute("noclick")){cell.removeAttribute("noclick");return}if(displayType=="speeddial"){if(allowAddClick){fvdSpeedDial.SpeedDial.addDialClick(data.id);allowAddClick=false;setTimeout(function(){allowAddClick=true},1e4)}}var openedIn=fvdSpeedDial.Utils.Opener.asClicked(data.url,fvdSpeedDial.Prefs.get("sd.default_open_in"),event);if(displayMode!="list"&&openedIn=="current"){if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){var cells=document.getElementsByClassName("newtabCell");for(var i=0;i!=cells.length;i++){if(cells[i]==cell){continue}cells[i].setAttribute("fadeOut",1)}}}if(displayType=="recentlyclosed"){fvdSpeedDial.Storage.RecentlyClosed.remove(data.id,function(){fvdSpeedDial.SpeedDial.dialRemoveAnimate(data.id)})}event.stopPropagation()},false)}var removeButton=cell.getElementsByClassName("remove")[0];removeButton.addEventListener("click",function(event){event.stopPropagation();fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_dial_title"),_("dlg_confirm_remove_dial_text"),function(confirmResult){if(confirmResult){if(displayType=="speeddial"){fvdSpeedDial.Sync.addDataToSync({category:"deleteDials",data:data.id,translate:"dial"},function(){fvdSpeedDial.Storage.deleteDial(data.id,function(){fvdSpeedDial.SpeedDial.dialRemoveAnimate(data.id)})})}else if(displayType=="recentlyclosed"){fvdSpeedDial.Storage.RecentlyClosed.remove(data.id,function(){fvdSpeedDial.SpeedDial.dialRemoveAnimate(data.id)})}else if(displayType=="mostvisited"){fvdSpeedDial.Storage.MostVisited.deleteId(data.id,function(result){if(result.result){fvdSpeedDial.SpeedDial.dialRemoveAnimate(data.id)}})}}})},false);if(displayType!="recentlyclosed"){var editButton=cell.getElementsByClassName("edit")[0];editButton.addEventListener("click",function(event){if(event.button!=0){return}event.stopPropagation();fvdSpeedDial.Dialogs.addDial(data,displayType,false)},false)}if(displayType=="mostvisited"||displayType=="recentlyclosed"){var denyButton=cell.getElementsByClassName("deny")[0];denyButton.addEventListener("click",function(event){if(event.button!=0){return}fvdSpeedDial.Dialogs.deny({type:"url",sign:data.url});event.stopPropagation()},false);var addButton=cell.getElementsByClassName("add")[0];addButton.addEventListener("click",function(event){if(event.button!=0){return}if(data.title){}else if(data.auto_title){data.title=data.auto_title}fvdSpeedDial.Dialogs.addDial(data,"speeddial",true);event.stopPropagation()},false)}if(displayType=="mostvisited"){var inGroup=cell.getElementsByClassName("ingroup")[0];inGroup.addEventListener("click",function(event){fvdSpeedDial.Dialogs.viewGroup(data.host);event.stopPropagation()},false)}else if(displayType=="recentlyclosed"){}else if(displayType=="speeddial"){cell.addEventListener("mousedown",function(event){if(event.button!=0){return}var isFancyMode=false;if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){isFancyMode=true}if(isFancyMode){cell.setAttribute("transformBeforeDrag",cell.style.webkitTransform);cell.setAttribute("transformOriginBeforeDrag",cell.style.webkitTransformOrigin)}var needStartDrag=true;function _startDragMouseUp(){needStartDrag=false}cell.addEventListener("mouseup",_startDragMouseUp,false);setTimeout(function(){cell.removeEventListener("mouseup",_startDragMouseUp);if(!needStartDrag){return}if(fvdSpeedDial.SpeedDial.currentGroupId()==0){fvdSpeedDial.SpeedDialMisc.showCenterScreenNotification(_("newtab_cant_move_dials_in_popular"));return}fvdSpeedDial.SpeedDial.DragAndDrop.startDrag(cell,function(draggedOn){cell.removeAttribute("transformBeforeDrag");cell.removeAttribute("transformOriginBeforeDrag");var insertType=draggedOn.getAttribute("insert_type");var dials=[];if(displayMode=="list"){dials=document.getElementsByClassName("newtabListElem")}else{dials=document.querySelectorAll(".newtabCell[type=speeddial]")}var maxDialPosition=0;for(var i=0;i!=dials.length;i++){var dialPos=parseInt(dials[i].getAttribute("position"));if(dialPos>maxDialPosition){maxDialPosition=dialPos}}var relDial={position:parseInt(draggedOn.getAttribute("position"))};var dial={position:parseInt(cell.getAttribute("position"))};var sign=null;if(relDial.position>dial.position){sign=-1}else{sign=1}var newDialPosition;if(insertType=="after"){if(sign==-1){newDialPosition=relDial.position}else{newDialPosition=relDial.position+1;if(newDialPosition>maxDialPosition){newDialPosition=relDial.position}}}else if(insertType=="before"){if(sign==1){newDialPosition=relDial.position}else{newDialPosition=relDial.position-1;if(newDialPosition<1){newDialPosition=1}}}if(newDialPosition==dial.position){fvdSpeedDial.SpeedDial.Builder.refreshDialsByPositions(fvdSpeedDial.SpeedDial.cellsInRowMax(null,null,{objects:function(){return document.getElementById("cellsContainer").childNodes.length}}),displayMode,fvdSpeedDial.SpeedDial._currentCellSize());return}var dialsRangeStart=Math.min(newDialPosition,dial.position);var dialsRangeEnd=Math.max(newDialPosition,dial.position);for(var i=0;i!=dials.length;i++){var dialPos=parseInt(dials[i].getAttribute("position"));if(dialPos>=dialsRangeStart&&dialPos<=dialsRangeEnd){dials[i].setAttribute("position",dialPos+sign)}}cell.setAttribute("position",newDialPosition);fvdSpeedDial.SpeedDial.Builder.refreshDialsByPositions(fvdSpeedDial.SpeedDial.cellsInRowMax(null,null,{objects:function(){return document.getElementById("cellsContainer").childNodes.length}}),displayMode,fvdSpeedDial.SpeedDial._currentCellSize());var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(cell);fvdSpeedDial.Storage.insertDialUpdateStorage(dialId,sign==-1?"-":"+",{start:dialsRangeStart,end:dialsRangeEnd},newDialPosition,function(changedIds){fvdSpeedDial.Utils.Async.arrayProcess(changedIds,function(dialId,arrayProcessCallback){fvdSpeedDial.Sync.addDataToSync({category:"dials",data:dialId},function(){arrayProcessCallback()})},function(){})})},event,{groupFocus:function(groupId){if(groupId>0){var elem=document.getElementById("group_select_"+groupId);elem.setAttribute("dragDialTo",1)}cell.setAttribute("dragovergroup",1)},groupBlured:function(){var groups=document.querySelectorAll("#groupsBox .group");for(var i=0;i!=groups.length;i++){if(groups[i]){groups[i].removeAttribute("dragDialTo")}}cell.removeAttribute("dragovergroup")},dropOnGroup:function(groupId){fvdSpeedDial.SpeedDial.dialMoveToGroup(data.id,groupId)},dragMove:function(x,y,elems){if(!isFancyMode){return}var elem=null;var distance=99999999999;elems.forEach(function(e){var d=Math.abs(e.centerPos.left-x);if(d<distance){distance=d;elem=e.elem}});if(elem){var transform=elem.style.webkitTransform;var transformOrigin=elem.style.webkitTransformOrigin;if(elem.hasAttribute("transformBeforeDrag")){transform=elem.getAttribute("transformBeforeDrag")}if(elem.hasAttribute("transformOriginBeforeDrag")){transformOrigin=elem.getAttribute("transformOriginBeforeDrag")}cell.style.webkitTransform=transform;cell.style.webkitTransformOrigin=transformOrigin}},drop:function(){if(!isFancyMode){return}cell.style.webkitTransform=cell.getAttribute("transformBeforeDrag");cell.style.webkitTransformOrigin=cell.getAttribute("transformOriginBeforeDrag");cell.removeAttribute("transformBeforeDrag");cell.removeAttribute("transformOriginBeforeDrag")}})},300);event.stopPropagation()},false)}}};this.Builder=new Builder}).apply(fvdSpeedDial.SpeedDial);(function(){var SpeedDialMisc=function(){var that=this;Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){that._prefsListener(msg.name,msg.value)}else if(msg.action=="sync:syncdatachanged"){that._syncDataChangedListener()}})};SpeedDialMisc.prototype={_optionsOpened:false,_needRebuild:false,_checkNeedRebuildInterval:false,settingsInvalidated:[],settingsInvalidatedIntervalCheck:null,allRefreshesSettings:["speedDial","mostVisited","recentlyClosed"],partPrefs:{},_showRateMessageAfterDaysCount:1,refreshSearchPanel:function(){try{if(_b(fvdSpeedDial.Prefs.get("sd.enable_search"))){document.getElementById("cse-search-box").style.display="block";document.body.setAttribute("searchEnabled",1);chrome.i18n.getAcceptLanguages(function(languages){if(languages.indexOf("ru")!=-1){document.querySelector(".searchForm button span").textContent=_("newtab_search_on_yandex")}})}else{document.getElementById("cse-search-box").style.display="none";document.body.setAttribute("searchEnabled",0)}}catch(ex){}},unHighlightSearch:function(){document.querySelector("#searchFormContainer").classList.remove("highlight")},doSearch:function(query){query=query||document.getElementById("q").value;var url="http://fvdmedia.com/addon_search/?q="+encodeURIComponent(query)+"&from=chrome_fvdsd";document.location=url},showCenterScreenNotification:function(text){var notification=document.getElementById("center-screen-notification");notification.style.display="block";notification.getElementsByClassName("notification-message")[0].innerHTML=text;setTimeout(function(){notification.setAttribute("appear",1)},0);setTimeout(function(){notification.removeAttribute("appear");setTimeout(function(){notification.style.display="none"},500)},3e3)},init:function(){var that=this;this.refreshSearchPanel();$("#q").speechify({lang:chrome.i18n.getUILanguage(),onResult:function(){that.doSearch()},build:function(data){data.icon.attr("title",_("newtab_voice_search"))}});var searchForm=document.querySelector(".searchForm");searchForm.addEventListener("submit",function(event){that.doSearch();event.stopPropagation();event.preventDefault()},false);var inputSearch=document.getElementById("q");inputSearch.addEventListener("dblclick",function(event){event.stopPropagation()},false);inputSearch.addEventListener("focus",function(){searchForm.setAttribute("active",1)},false);inputSearch.addEventListener("blur",function(){searchForm.removeAttribute("active")},false);this._setupIconsMenu();this.setExpandedState();this.setCustomSearchState();this.refreshMenu();this.settingsInvalidatedIntervalCheck=setInterval(function(){if(that.settingsInvalidated.length!=0){var toRefresh=that.settingsInvalidated;that.settingsInvalidated=[];that.refreshSettingsWindow(toRefresh)}},200);this._initialOptionsSetup();document.addEventListener("click",function(event){that._handlerDocumentClick.call(that,event)},true);this._checkNeedRebuildInterval=setInterval(function(){if(that._needRebuild){that._needRebuild=false;that._setupLabelsBelowIcons();that._setupIconsMenu()}},100);if(!_b(fvdSpeedDial.Prefs.get("sd.dont_display_rate_message"))&&!fvdSpeedDial.Config.HIDE_RATE_MESSAGE){setTimeout(function(){var installTime=fvdSpeedDial.Prefs.get("sd.install_time");if(installTime!=null){var now=(new Date).getTime();var days=Math.floor((now-installTime)/(1e3*3600*24));if(days>=that._showRateMessageAfterDaysCount){that.showOptions("rateMessage",document.getElementById("searchBar"),null,null,true)}}},5e3)}if(_b(fvdSpeedDial.Prefs.get("display_themes_message"))){setTimeout(function(){},8e3)}document.getElementById("enableSpeedDial_yes").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableSpeedDial_yes").parentNode,"enableSpeedDial",true)},false);document.getElementById("enableSpeedDial_no").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableSpeedDial_no").parentNode,"enableSpeedDial",false)},false);document.getElementById("defaultSpeedDial").addEventListener("change",function(event){fvdSpeedDial.SpeedDialMisc.changeDefaultDisplayType("speeddial",document.getElementById("defaultSpeedDial").checked)},false);document.getElementById("speedDialColumns").addEventListener("focus",function(event){fvdSpeedDial.SpeedDialMisc.rebuildColumnsField(["speedDialColumns"])},false);document.getElementById("sdButtonManageGroups").addEventListener("click",function(event){fvdSpeedDial.Dialogs.manageGroups();fvdSpeedDial.SpeedDialMisc.hideOptions()},false);document.getElementById("enableMostVisited_yes").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableMostVisited_yes").parentNode,"enableMostVisited",true)},false);document.getElementById("enableMostVisited_no").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableMostVisited_no").parentNode,"enableMostVisited",false)},false);document.getElementById("defaultMostVisited").addEventListener("change",function(event){fvdSpeedDial.SpeedDialMisc.changeDefaultDisplayType("mostvisited",document.getElementById("defaultMostVisited").checked)},false);document.getElementById("mostVisitedColumns").addEventListener("focus",function(event){fvdSpeedDial.SpeedDialMisc.rebuildColumnsField(["mostVisitedColumns"])},false);document.getElementById("mostvisitedButtonSync").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.syncMostVisited();document.getElementById("doneflushMostVisitedCache").setAttribute("active",1);setTimeout(function(){document.getElementById("doneflushMostVisitedCache").removeAttribute("active")},2e3)},false);document.getElementById("mostvisitedButtonRestoreRemoved").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.mostVisitedRestoreRemoved()},false);document.getElementById("enableRecentlyClosed_yes").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableRecentlyClosed_yes").parentNode,"enableRecentlyClosed",true)},false);document.getElementById("enableRecentlyClosed_no").addEventListener("click",function(event){fvdSpeedDial.SpeedDialMisc.confirmSetting(document.getElementById("enableRecentlyClosed_no").parentNode,"enableRecentlyClosed",false)},false);document.getElementById("defaultRecentlyClosed").addEventListener("change",function(event){fvdSpeedDial.SpeedDialMisc.changeDefaultDisplayType("recentlyclosed",document.getElementById("defaultRecentlyClosed").checked)},false);document.getElementById("recentlyClosedColumns").addEventListener("focus",function(event){fvdSpeedDial.SpeedDialMisc.rebuildColumnsField(["recentlyClosedColumns"])},false);document.getElementById("sdCbCanTurnOffNewTabPopup").addEventListener("click",function(event){fvdSpeedDial.Prefs.set("sd.display_can_turn_off_newtab_popup",!document.getElementById("sdCbCanTurnOffNewTabPopup").checked)},false);var items=document.getElementById("rateMessage").getElementsByClassName("click");for(var i=0;i!=items.length;i++){items[i].addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.openChromeStorePage()})}document.getElementById("sdCBDontDisplayMigrateMessage").addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.setRateMessageNotDisplayState(document.getElementById("sdCBDontDisplayMigrateMessage").checked)},false);document.getElementById("sdDontDisplayThemesMessage").addEventListener("click",function(){fvdSpeedDial.Prefs.set("display_themes_message",!document.getElementById("sdDontDisplayThemesMessage").checked)},false);document.getElementById("searchBar").addEventListener("dblclick",function(){fvdSpeedDial.SpeedDialMisc.processDblClick(event)},false);var buttonsIds=["buttonSpeedDial","buttonMostVisited","buttonRecentlyClosed"];buttonsIds.forEach(function(buttonId){document.getElementById(buttonId).addEventListener("mouseover",function(){fvdSpeedDial.SpeedDialMisc.mouseOverButton(document.getElementById(buttonId))},false);document.getElementById(buttonId).addEventListener("mouseout",function(){fvdSpeedDial.SpeedDialMisc.mouseOutButton(document.getElementById(buttonId))},false)});document.getElementById("sdSetDisplayTypeSpeedDial").addEventListener("click",function(){fvdSpeedDial.SpeedDial.setCurrentDisplayType("speeddial")},false);document.getElementById("sdSetDisplayTypeSpeedDial").addEventListener("click",function(){fvdSpeedDial.SpeedDial.setCurrentDisplayType("speeddial")},false);document.getElementById("speedDialExpand").addEventListener("click",function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.speeddial_expanded")},false);document.getElementById("speedDialHide").addEventListener("click",function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.speeddial_expanded")},false);document.getElementById("sdOpenFastOptions").addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.showOptions("speedDialOptions",document.getElementById("sdOpenFastOptions"),event)},false);document.getElementById("sdSetDisplayTypeMostVisited").addEventListener("click",function(){fvdSpeedDial.SpeedDial.setCurrentDisplayType("mostvisited")},false);document.getElementById("mostVisitedExpand").addEventListener("click",function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.mostvisited_expanded")},false);document.getElementById("mostVisitedHide").addEventListener("click",function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.mostvisited_expanded")},false);document.getElementById("mostVisitedOpenFastOptions").addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.showOptions("mostVisitedOptions",document.getElementById("mostVisitedOpenFastOptions"),event)},false);document.getElementById("sdSetDisplayTypeRecentlyClosed").addEventListener("click",function(){fvdSpeedDial.SpeedDial.setCurrentDisplayType("recentlyclosed")},false);document.getElementById("recentlyClosedExpand").addEventListener("click",function(){
if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.recentlyclosed_expanded")},false);document.getElementById("recentlyClosedHide").addEventListener("click",function(){if(fvdSpeedDial.PowerOffClient.isHidden()){return}fvdSpeedDial.Prefs.toggle("sd.recentlyclosed_expanded")},false);document.getElementById("recentlyClosedOpenFastOptions").addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.showOptions("recentlyClosedOptions",document.getElementById("recentlyClosedOpenFastOptions"),event)},false);document.getElementById("buttonSettings").addEventListener("click",function(){document.location="options.html"},false);fvdSpeedDial.Sync.isActive(function(active){if(!active){document.getElementById("buttonSync").removeAttribute("hidden")}});document.getElementById("buttonSync").addEventListener("click",function(){fvdSpeedDial.Sync.isActive(function(active){if(!active){document.location="options.html#sync"}else{fvdSpeedDial.Sync.startSync("main",function(state){if(state=="syncActive"){fvdSpeedDial.Dialogs.alert(_("dlg_alert_sync_on_another_driver_title"),_("dlg_alert_sync_on_another_driver_text"))}})}})},false);document.getElementById("fastMenuToggleButton").addEventListener("click",function(){fvdSpeedDial.SpeedDialMisc.toggleMenu()},false);document.getElementById("speedDialWrapper").addEventListener("dblclick",function(event){fvdSpeedDial.SpeedDial.wrapperDblClick(event)},false);document.getElementById("q").addEventListener("focus",function(event){document.getElementById("q").parentNode.setAttribute("focused","1")},false);document.getElementById("q").addEventListener("blur",function(event){document.getElementById("q").parentNode.setAttribute("focused","0")},false);document.getElementById("sdCbSetListViewTypeTitle").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.setListViewType()},false);document.getElementById("sdCbSetListViewTypeUrl").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.setListViewType()},false);document.getElementById("sdListMenuAddDial").addEventListener("click",function(event){fvdSpeedDial.Dialogs.addDial()},false);document.getElementById("mostVisitedListMenuOpenAllLinks").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.openAllCurrentMostVisitedLinks()},false);document.getElementById("mostVisitedListMenuRemoveAllLinks").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.removeAllCurrentMostVisitedLinks()},false);document.getElementById("recentlyClosedListMenuOpenAllLinks").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.openAllCurrentRecentlyClosedLinks()},false);document.getElementById("recentlyClosedListMenuRemoveAllLinks").addEventListener("click",function(event){fvdSpeedDial.SpeedDial.removeAllCurrentRecentlyClosedLinks()},false);document.getElementById("no3dSwtichToStandard").addEventListener("click",function(event){fvdSpeedDial.Prefs.set("sd.display_mode","standard")},false);document.getElementById("changeBackgroundBlock").addEventListener("click",function(event){frameWin.gFVDSSDSettings.displayWindow("fvdsd_sd","paneSdBackground")},false);document.getElementById("appsPanelOpenButton").addEventListener("click",function(event){fvdSpeedDial.Apps.toggle()},false);this.refreshSyncButtonState();Shortcut.add("ctrl+enter",function(){fvdSpeedDial.SpeedDial.toggleExpand();return false});setTimeout(function(){fvdSpeedDial.SpeedDialMisc.unHighlightSearch()},3e3)},toggleBottomPanel:function(){var panel=document.getElementById("bottomBlock");var button=document.getElementById("showHideButtonButtonBlock");var active=panel.getAttribute("active");if(active==0){active=1;document.getElementById("fb_like").onload=function(){document.getElementById("fbLikeLoading").style.display="none";document.getElementById("fb_like").setAttribute("loaded","1")};document.getElementById("fb_like").src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.flashvideodownloader.org%2Ffvd-suite%2F&amp;layout=standard&amp;show_faces=true&amp;width=450&amp;action=like&amp;font=arial&amp;colorscheme=light&amp;height=80"}else{active=0}panel.setAttribute("active",active);button.setAttribute("active",active)},resetDropDown:function(){end_drop_down();setTimeout(function(){start_drop_down()},500)},sheduleRebuild:function(){this._needRebuild=true},processDblClick:function(event){if(event.target.id=="searchBar"||event.target.className=="dialIcons"){var currValue=_b(fvdSpeedDial.Prefs.get("sd.search_bar_expanded"));fvdSpeedDial.Prefs.set("sd.search_bar_expanded",!currValue)}},setCustomSearchState:function(){var disabled=_b(fvdSpeedDial.Prefs.get("sd.disable_custom_search"));var form=document.getElementsByClassName("searchForm")[0];if(disabled){form.setAttribute("hidden",true)}else{form.removeAttribute("hidden")}},openChromeStorePage:function(){window.open("https://chrome.google.com/webstore/detail/llaficoajjainaijghjlofdfmbjpebpa/reviews")},setRateMessageNotDisplayState:function(state){fvdSpeedDial.Prefs.set("sd.dont_display_rate_message",state)},setExpandedState:function(){},toggleMenu:function(){var state=!_b(fvdSpeedDial.Prefs.get("sd.main_menu_displayed"));fvdSpeedDial.Prefs.set("sd.main_menu_displayed",state)},refreshMenu:function(attrs){attrs=attrs||{};var menu=document.getElementById("searchBar").getElementsByClassName("activeContent")[0];menu.setAttribute("active",_b(fvdSpeedDial.Prefs.get("sd.main_menu_displayed"))?"1":"0")},mouseOverButton:function(elem){var texts=document.getElementsByClassName("subText");for(var i=0;i!=texts.length;i++){if(texts[i].parentNode==elem){continue}texts[i].style.display="none"}},mouseOutButton:function(){var texts=document.getElementsByClassName("subText");for(var i=0;i!=texts.length;i++){texts[i].style.display=""}},showOptions:function(id,toElem,event,pos,waitForOtherOpened,openCallback){var that=this;var elems=document.getElementsByClassName("popupOptions");if(waitForOtherOpened){var wait=false;if(document.getElementById("introductionOverlay").hasAttribute("appear")){wait=true}for(var i=0;i!=elems.length;i++){if(elems[i].getAttribute("active")=="1"){wait=true}}if(wait){if(typeof waitForOtherOpened=="function"){return waitForOtherOpened()}var args=arguments;return setTimeout(function(){that.showOptions.apply(that,args)},1e3)}}pos=pos||"left";if(id==null){switch(fvdSpeedDial.SpeedDial.currentDisplayType()){case"speeddial":id="speedDialOptions";break;case"mostvisited":id="mostVisitedOptions";break;case"recentlyclosed":id="recentlyClosedOptions";break}}if(toElem){var offset=fvdSpeedDial.Utils.getOffset(toElem);var left=offset.left+0;var top=offset.top+toElem.offsetHeight;if(pos=="left"){left+=toElem.offsetWidth}}else{top=pos.top;left=pos.left}var optionsOpened=false;for(var i=0;i!=elems.length;i++){if(elems[i].id==id&&elems[i].getAttribute("active")!="1"){elems[i].setAttribute("active","1");elems[i].setAttribute("collapsed","0");elems[i].style.top=top+"px";if(pos=="left"){left-=elems[i].offsetWidth}elems[i].style.left=left+"px";optionsOpened=true;continue}elems[i].setAttribute("active","0")}if(event){event.stopPropagation()}if(openCallback){openCallback()}this._optionsOpened=optionsOpened},hideOptions:function(){var elems=document.getElementsByClassName("popupOptions");var foundActive=false;for(var i=0;i!=elems.length;i++){if(elems[i].getAttribute("active")=="1"){elems[i].setAttribute("active","0");foundActive=true}}if(foundActive){var confirms=document.getElementsByClassName("confirm");for(var i=0;i!=confirms.length;i++){if(confirms[i].getAttribute("appear")=="1"){this.confirmSetting(confirms[i],confirms[i].getAttribute("for"),false)}}}this._optionsOpened=false},confirmSetting:function(confirm,settingId,action){var setting=document.getElementById(settingId);if(action){this.ss(setting.getAttribute("sname"),setting.checked,"bool")}else{if(setting.getAttribute("type")=="checkbox"){setting.checked=!setting.checked}}confirm.setAttribute("appear","0")},rebuildGroupsList:function(){var settings=fvdSpeedDial.Prefs;var list=document.getElementById("defaultGroupSpeedDial");fvdSpeedDial.Storage.groupsList(function(groups){list.options.length=0;list.options[list.options.length]=new Option(_("newtab_last_used_group"),-1);list.options[list.options.length]=new Option(_("newtab_popular_group_title"),0);for(var i=0;i!=groups.length;i++){var group=groups[i];list.options[list.options.length]=new Option(fvdSpeedDial.Utils.cropLength(group.name,18),group.id)}list.value=settings.get("sd.default_group")})},rebuildColumnsField:function(fields){if(typeof fields=="undefined"||fields==null){fields=["speedDialColumns","mostVisitedColumns","recentlyClosedColumns"]}for(var i=0;i!=fields.length;i++){var thumbsType="list";if(fields[i]=="speedDialColumns"){thumbsType=fvdSpeedDial.Prefs.get("sd.thumbs_type")}else if(fields[i]=="mostVisitedColumns"){thumbsType=fvdSpeedDial.Prefs.get("sd.thumbs_type_most_visited")}var columnsAuto=fvdSpeedDial.SpeedDial.cellsInRowMax("auto");if(columnsAuto.rows){columnsAuto=columnsAuto.rows}else{columnsAuto=columnsAuto.cols}var title=_("newtab_number_of_columns");if(thumbsType=="list"||fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){}else if(fvdSpeedDial.Prefs.get("sd.scrolling")=="horizontal"){title=_("newtab_number_of_rows")}document.getElementById(fields[i]+"Title").textContent=title;var field=document.getElementById(fields[i]);var preValue=fvdSpeedDial.Prefs.get(field.getAttribute("sname"));var numOfColumns=columnsAuto;if(preValue!="auto"){if(preValue>columnsAuto||isNaN(numOfColumns)){numOfColumns=preValue}}field.options.length=1;for(var columnNum=1;columnNum<=numOfColumns;columnNum++){var option=new Option(columnNum,columnNum);field.options[field.options.length]=option}field.value=preValue}},ss:function(key,value){fvdSpeedDial.Prefs.set(key,value)},changeDefaultDisplayType:function(type,set){if(!set){type="last_selected"}this.ss("sd.display_type",type)},refreshSyncButtonState:function(){fvdSpeedDial.Sync.hasDataToSync(function(has){document.getElementById("buttonSync").setAttribute("hasUpdates",has?1:0)})},refreshSettingsWindow:function(toRefresh){toRefresh=toRefresh||this.allRefreshesSettings;var settings=fvdSpeedDial.Prefs;var enableSpeedDial=settings.get("sd.enable_top_sites");var enableMostVisited=settings.get("sd.enable_most_visited");var enableRecentlyClosed=settings.get("sd.enable_recently_closed");if(toRefresh.indexOf("speedDial"!=-1)){this.rebuildGroupsList();var def=settings.get("sd.display_type")=="speeddial";var allGroupsMax=settings.get("sd.all_groups_limit_dials");var thumbsType=settings.get("sd.thumbs_type");var defaultGroup=settings.get("sd.default_group");document.getElementById("enableSpeedDial").checked=enableSpeedDial;if(_b(enableSpeedDial)){if(!_b(enableMostVisited)&&!_b(enableRecentlyClosed)){document.getElementById("enableSpeedDial").setAttribute("disabled",true)}else{document.getElementById("enableSpeedDial").removeAttribute("disabled")}}document.getElementById("defaultSpeedDial").checked=def;document.getElementById("maxGroupsSpeedDial").value=allGroupsMax;document.getElementById("thumbsSpeedDial"+fvdSpeedDial.Utils.ucfirst(thumbsType)).checked=true;this.rebuildColumnsField(["speedDialColumns"]);var columns=document.getElementById("speedDialColumns");columns.value=settings.get("sd.top_sites_columns")}if(toRefresh.indexOf("mostVisited"!=-1)){var def=settings.get("sd.display_type")=="mostvisited";var showLast=settings.get("sd.max_most_visited_records");var thumbsType=settings.get("sd.thumbs_type_most_visited");var cacheLifeTime=settings.get("sd.most_visited_cache_life_time");document.getElementById("enableMostVisited").checked=enableMostVisited;if(_b(enableMostVisited)){if(!_b(enableSpeedDial)&&!_b(enableRecentlyClosed)){document.getElementById("enableMostVisited").setAttribute("disabled",true)}else{document.getElementById("enableMostVisited").removeAttribute("disabled")}}document.getElementById("defaultMostVisited").checked=def;document.getElementById("showLastMostVisited").value=showLast;document.getElementById("thumbsMostVisited"+fvdSpeedDial.Utils.ucfirst(thumbsType)).checked=true;document.getElementById("cacheLifeTimeMostVisited").value=cacheLifeTime;this.rebuildColumnsField(["mostVisitedColumns"]);var columns=document.getElementById("mostVisitedColumns");columns.value=settings.get("sd.most_visited_columns")}if(toRefresh.indexOf("recentlyClosed"!=-1)){var def=settings.get("sd.display_type")=="recentlyclosed";var showLast=settings.get("sd.max_recently_closed_records");document.getElementById("enableRecentlyClosed").checked=enableRecentlyClosed;if(_b(enableRecentlyClosed)){if(!_b(enableSpeedDial)&&!_b(enableMostVisited)){document.getElementById("enableRecentlyClosed").setAttribute("disabled",true)}else{document.getElementById("enableRecentlyClosed").removeAttribute("disabled")}}document.getElementById("defaultRecentlyClosed").checked=def;document.getElementById("showLastRecentlyClosed").value=showLast;this.rebuildColumnsField(["recentlyClosedColumns"]);var columns=document.getElementById("recentlyClosedColumns");columns.value=settings.get("sd.recentlyclosed_columns")}},_handlerDocumentClick:function(event){try{if(this._optionsOpened&&event.target.className!="buttonSmall options"){var closeOptions=true;var elem=event.target;do{if(elem.className&&elem.className.indexOf("popupOptions")!=-1){closeOptions=false;break}}while(elem=elem.parentNode);if(closeOptions){this.hideOptions()}}}catch(ex){}},_syncDataChangedListener:function(){fvdSpeedDial.SpeedDialMisc.refreshSyncButtonState()},_prefsListener:function(name,value){var that=fvdSpeedDial.SpeedDialMisc;if(!that.partPrefs[name]){if(name=="sd.display_type"||name=="sd.display_mode"){that.settingsInvalidated=that.allRefreshesSettings}else if(name=="sd.disable_custom_search"){that.setCustomSearchState()}else if(name=="sd.search_bar_expanded"){that.setExpandedState()}else if(["sd.speeddial_expanded","sd.mostvisited_expanded","sd.recentlyclosed_expanded"].indexOf(name)!=-1){that._setupIconsMenu()}}else{if(["sd.enable_top_sites","sd.enable_most_visited","sd.enable_recently_closed"].indexOf(name)!=-1){if(!value){fvdSpeedDial.SpeedDialMisc.resetDropDown();fvdSpeedDial.SpeedDialMisc.hideOptions()}that.settingsInvalidated=that.allRefreshesSettings}else{var partToUpdate=that.partPrefs[name];if(that.settingsInvalidated.indexOf(partToUpdate)==-1){that.settingsInvalidated.push(partToUpdate)}}}if(name=="sd.main_menu_displayed"){fvdSpeedDial.SpeedDialMisc.refreshMenu()}if(name=="sd.enable_search"){that.refreshSearchPanel()}},_setupIconsMenu:function(){var buttonSpeedDial=document.getElementById("buttonSpeedDial");var buttonMostVisited=document.getElementById("buttonMostVisited");var buttonRecentlyClosed=document.getElementById("buttonRecentlyClosed");var currentType=fvdSpeedDial.SpeedDial.currentDisplayType();buttonSpeedDial.setAttribute("active",currentType=="speeddial"?"1":"0");buttonMostVisited.setAttribute("active",currentType=="mostvisited"?"1":"0");buttonRecentlyClosed.setAttribute("active",currentType=="recentlyclosed"?"1":"0");buttonSpeedDial.setAttribute("expanded",_b(fvdSpeedDial.Prefs.get("sd.speeddial_expanded"))?"1":"0");buttonMostVisited.setAttribute("expanded",_b(fvdSpeedDial.Prefs.get("sd.mostvisited_expanded"))?"1":"0");buttonRecentlyClosed.setAttribute("expanded",_b(fvdSpeedDial.Prefs.get("sd.recentlyclosed_expanded"))?"1":"0");if(_b(fvdSpeedDial.Prefs.get("sd.enable_top_sites"))){buttonSpeedDial.removeAttribute("hidden")}else{buttonSpeedDial.setAttribute("hidden",true)}if(_b(fvdSpeedDial.Prefs.get("sd.enable_most_visited"))){buttonMostVisited.removeAttribute("hidden")}else{buttonMostVisited.setAttribute("hidden",true)}if(_b(fvdSpeedDial.Prefs.get("sd.enable_recently_closed"))){buttonRecentlyClosed.removeAttribute("hidden")}else{buttonRecentlyClosed.setAttribute("hidden",true)}},_setupLabelsBelowIcons:function(){var speedDialText=document.getElementById("buttonSpeedDial").getElementsByClassName("subText")[0];var mostVisitedText=document.getElementById("buttonMostVisited").getElementsByClassName("subText")[0];var recentlyClosedText=document.getElementById("buttonRecentlyClosed").getElementsByClassName("subText")[0];var displayType=fvdSpeedDial.SpeedDial.currentDisplayType();fvdSpeedDial.Storage.countDials(function(count){speedDialText.textContent=_("newtab_speeddial_label").replace("%count%",count);if(displayType=="speeddial"){}});fvdSpeedDial.Storage.MostVisited.getAvailableCount(fvdSpeedDial.Prefs.get("sd.most_visited_interval"),function(count){mostVisitedText.textContent=_("newtab_most_visited_label").replace("%count%",count);if(displayType=="mostvisited"){}});fvdSpeedDial.Storage.RecentlyClosed.getAvailableCount(function(count){recentlyClosedText.textContent=_("newtab_recently_closed_label").replace("%count%",count);if(displayType=="recentlyclosed"){}})},_initialOptionsSetup:function(){var options=document.getElementsByClassName("popupOptions");for(var i=0;i!=options.length;i++){var option=options[i];option.setAttribute("collapsed","1");option.addEventListener("webkitTransitionEnd",function(event){if(event.target.getAttribute("active")==0){event.target.setAttribute("collapsed","1")}},true);option.addEventListener("click",function(event){event.stopPropagation()},false)}this.refreshSettingsWindow();var that=this;var settings=document.getElementsByClassName("setting");for(var i=0;i!=settings.length;i++){var setting=settings[i];if(setting.getAttribute("confirm")){(function(setting){setting.onchange=function(){var confirms=document.getElementsByClassName("confirm");for(var i=0;i!=confirms.length;i++){if(confirms[i].getAttribute("for")==setting.id){if(confirms[i].getAttribute("appear")!="1"){confirms[i].setAttribute("appear","1")}else{confirms[i].setAttribute("appear","0")}break}}}})(setting);continue}var stype=setting.getAttribute("stype");var sname=setting.getAttribute("sname");if(setting.getAttribute("type")=="checkbox"){(function(setting,stype,sname){setting.onchange=function(){that.ss(sname,setting.checked,stype)}})(setting,stype,sname)}else if(setting.getAttribute("type")=="radio"){(function(setting,stype,sname){setting.onchange=function(){that.ss(sname,setting.value,stype)}})(setting,stype,sname)}else if(setting.getAttribute("type")=="text"){(function(setting,stype,sname){if(stype=="int"){setting.onkeypress=function(event){var numbers="0123456789";if(event.charCode==0){return true}var letter=String.fromCharCode(event.charCode);return numbers.indexOf(letter)!=-1}}setting.onkeyup=function(){if(stype=="int"&&setting.value.trim()==""){return}var v;var m;try{v=parseInt(setting.value);m=parseInt(setting.getAttribute("max"))}catch(ex){return}if(v>m){setting.value=m}setTimeout(function(){that.ss(sname,setting.value,stype)},500)}})(setting,stype,sname)}else if(setting.tagName=="SELECT"){(function(setting,stype,sname){setting.onchange=function(){that.ss(sname,setting.value,stype)}})(setting,stype,sname)}}var parts=document.getElementsByClassName("popupOptions");for(var i=0;i!=parts.length;i++){var partName=parts[i].id.replace("Options","");var settings=parts[i].getElementsByClassName("setting");for(var j=0;j!=settings.length;j++){this.partPrefs[settings[j].getAttribute("sname")]=partName}}}};this.SpeedDialMisc=new SpeedDialMisc}).apply(fvdSpeedDial);const SETTINGS_KEY_BRANCH="fvdsd.";window.current_value=null;var dd_data=[];var selected_value=null;var allow_close=false;var menu_opened=false;var sites_info={web:{cx:"001477807305393216127:7dbycpqumuw",selected:true},"video-search":{redirect:"http://fvdvideo.com/search/?q=%q%"},"flash-games":{cx:"009547620127771566411:vdegr9qva-o"},video:{cx:"partner-pub-5087362176467115:h6z8ss-efx2"},people:{cx:"009547620127771566411:tzp3hyliplo"},twitter:{redirect:"http://twitter.com/search?q=%q%"},wiki:{redirect:"http://en.wikipedia.org/wiki/%q%"},youtube:{redirect:"http://www.youtube.com/results?search_type=&aq=f&search_query=%q%"},metacafe:{redirect:"http://www.metacafe.com/tags/%q%"},google_videos:{redirect:"http://www.google.com/search?q=%q%&tbs=vid:1",ico:"google"},google_images:{redirect:"http://images.google.com/images?q=%q%",ico:"google"},myspace:{redirect:"http://www.myspace.com/search/videos?q=%q%"},dailymotion:{redirect:"http://www.dailymotion.com/relevance/search/%q%"},"break":{redirect:"http://www.break.com/surfacevideo/%q%"},blip:{redirect:"http://www.blip.tv/search?q=%q%"},spike:{redirect:"http://www.spike.com/search?mkt=en-us&FORM=VCM050&query=%q%"},myvideo:{redirect:"http://www.myvideo.de/Videos_A-Z?searchWord=%q%"},flurl:{redirect:"http://www.flurl.com/search?site_id=147&search=Search&q=%q%"}};function dd_get_ico_class(info,site_name){var ico_class;if(typeof info.ico!="undefined"){ico_class=info.ico}else{ico_class=site_name}ico_class="ico-"+ico_class;return"dd_ico "+ico_class}function display_adult(display){if(!display){if(window.current_value=="adult")__dd_set_current_element("web")}}function is_adult_visible(){var res=true;try{var reg=Components.classes["@mozilla.org/windows-registry-key;1"].createInstance(Components.interfaces.nsIWindowsRegKey);try{reg.open(reg.ROOT_KEY_CURRENT_USER,"Software\\FVDSuite\\Firefox",reg.ACCESS_READ);if(reg.hasValue("DisableAdult")&&reg.getValueType("DisableAdult")==reg.TYPE_INT){if(reg.readIntValue("DisableAdult")!=0)res=false}reg.close()}catch(ee){reg.close()}}catch(e){}return res}function end_drop_down(){var list=document.getElementById("dd_search_list");if(list){list.parentNode.removeChild(list)}var selectedElem=document.getElementById("dd_selected_list_elem");if(selectedElem){selectedElem.parentNode.removeChild(selectedElem)}}function start_drop_down(){return false;var adult_display=is_adult_visible();for(var site_name in sites_info){var info=sites_info[site_name];if(typeof info.selected!="undefined"&&info.selected){selected_value=site_name}}var new_list_id="dd_search_list";var list=document.createElement("div");list.id=new_list_id;list.className="dd_list_main";list.style.display="none";for(var site_name in sites_info){if(!(site_name=="adult"&&!adult_display)){var info=sites_info[site_name];var elem=document.createElement("div");elem.className="dd_list_option "+dd_get_ico_class(info,site_name);var text_name=site_name.replace("_"," ");var f=text_name[0].toUpperCase();text_name=f+text_name.substr(1);elem.textContent=text_name;elem.value=site_name;elem.onclick=function(){__dd_set_current_element(this.value)};list.appendChild(elem)}}document.getElementById("q").parentNode.appendChild(list);__dd_set_current_element(selected_value)}function getY(oElement){var iReturnValue=0;while(oElement!=null){iReturnValue+=oElement.offsetTop;oElement=oElement.offsetParent}return iReturnValue}function __dd_set_current_element(site_name){var info=sites_info[site_name];var current=document.createElement("div");current.className="dd_list_option dd_list_option_selected "+dd_get_ico_class(info,site_name);current.id="dd_selected_list_elem";current.style.top=getY(document.getElementById("q"))+"px";var currentImg=document.createElement("img");currentImg.setAttribute("src","/images/newtab/arrow.png");currentImg.style.marginLeft="2px";current.appendChild(currentImg);current.onclick=function(){autocompleteHide();if(menu_opened){return false}menu_opened=true;var list=document.getElementById("dd_search_list");list.style.display="";list.style.position="absolute";list.style.zindex=1e3;allow_close=false;document.onclick=function(){if(allow_close){document.getElementById("dd_search_list").style.display="none";menu_opened=false}};setTimeout(function(){allow_close=true},100);return false};window.current_value=site_name;check_google_bk();var list=document.getElementById("dd_search_list");list.style.display="none";removeDOM_id("dd_selected_list_elem");document.getElementById("q").parentNode.appendChild(current)}function removeDOM_id(element){try{var e=document.getElementById(element);e.parentNode.removeChild(e)}catch(ex){}}function check_google_bk(){if(["web","adult","flash-games","video"].indexOf(window.current_value)!=-1&&document.getElementById("q").value==""){document.getElementById("q").setAttribute("google","true")}else{document.getElementById("q").removeAttribute("google")}}window.onload=function(){document.getElementById("q").addEventListener("blur",check_google_bk,false)};function dd_hide(){if(allow_close){document.getElementById("dd_search_list").style.display="none";menu_opened=false}}function pre_submit(){var query=document.getElementById("q").value;setTimeout(function(){document.location="http://fvdmedia.com/addon_search/?q="+encodeURIComponent(query)+"&from=chrome_fvdsd"},0);return false}(function(){var _lastaCIndex=0,acSources={},acSourcesXHR=null;acSources.google=function(params,cb){if(acSourcesXHR){acSourcesXHR.abort()}var url="http://google.com/complete/search?output=toolbar&q="+encodeURIComponent(params.query);var req=new XMLHttpRequest;acSourcesXHR=req;req.open("GET",url,true);req.inst=this;req.q="";req.onload=function(){acSourcesXHR=null;var r=req.responseXML;if(r){var elems=r.getElementsByTagName("suggestion");var items=[];for(var i=0;i!=elems.length;i++){items.push(elems[i].getAttribute("data"))}cb({items:items})}};req.send(null)};acSources.ebay=function(params,cb){if(acSourcesXHR){acSourcesXHR.abort()}var url="http://autosug.ebay.com/autosug?kwd="+encodeURIComponent(params.query)+"&version=1279292363&_jgr=1&sId=0&_ch=0&callback=GH_ac_callback";var req=new XMLHttpRequest;acSourcesXHR=req;req.open("GET",url,true);req.inst=this;req.q="";req.onload=function(){acSourcesXHR=null;var r=req.responseText;if(r){var items=[],m=r.match(/AutoFill\._do\((.+?)\)$/i),parsed=null;if(m){parsed=JSON.parse(m[1]);if(!parsed.res){return cb({items:[]})}cb({items:parsed.res.sug})}}};req.send(null)};acSources.amazon=function(params,cb){if(acSourcesXHR){acSourcesXHR.abort()}var url="http://completion.amazon.com/search/complete?method=completion&mkt=1&client=amazon-search-ui&x=String&search-alias=aps&q="+encodeURIComponent(params.query)+"&qs=&cf=1&fb=1&sc=1";var req=new XMLHttpRequest;acSourcesXHR=req;req.open("GET",url,true);req.inst=this;req.q="";req.onload=function(){acSourcesXHR=null;var r=req.responseText;if(r){var items=[],m=r.match(/^completion\s*=\s*(.+)/i),parsed=null;if(m){var text=m[1];text=text.replace(/String\(\);$/,"");text=text.replace(/;+$/,"");try{parsed=JSON.parse(text)}catch(ex){parsed=[]}if(parsed[1]&&Array.isArray(parsed[1])){return cb({items:parsed[1]})}cb({items:[]})}}};req.send(null)};acSources.aliexpress=function(params,cb){if(acSourcesXHR){acSourcesXHR.abort()}var url="http://connectkeyword.aliexpress.com/lenoIframeJson.htm?__number=2&keyword="+encodeURIComponent(params.query);var req=new XMLHttpRequest;acSourcesXHR=req;req.open("GET",url,true);req.inst=this;req.q="";req.onload=function(){acSourcesXHR=null;var r=req.responseText;if(r){var items=[],regExp=/\{keywords\s*:\s*'(.+?)'/gi,parsed=null;var m;do{m=regExp.exec(r);if(m){if(items.indexOf(m[1])===-1){items.push(m[1])}}}while(m&&c);return cb({items:items})}};req.send(null)};function addLoadEvent(a){window.addEventListener("load",a)}function AutoComplete(params){var acId=++_lastaCIndex,suggestElemId="suggest_"+acId,suggestionsTableId="suggestions_"+acId,self=this,acpObj={},inputEl=document.querySelector(params.input),acSource=inputEl.hasAttribute("data-autocomplete-source")?inputEl.getAttribute("data-autocomplete-source"):"google";this.onPopupShow=new FVDEventEmitter;this.onPopupHide=new FVDEventEmitter;this.onClickSuggestion=new FVDEventEmitter;this.setSource=function(source){acSource=source};function $(a){if(a=="force_acp_object_imput"){return acpObj.force_input_obj}else if(a=="force_acp_object_form"){return acpObj.force_form_obj}return document.getElementById(a)}function autocompleteHide(event){var suggest=$(suggestElemId);if(suggest){suggest.style.display="none"}document.removeEventListener("click",autocompleteHide,true);self.onPopupHide.callListeners();if(event){event.stopPropagation()}}function startAutocomplete(){acpObj={force_input_obj:document.querySelector(params.input),force_form_obj:document.querySelector(params.form),click_callback:function(){},acp_searchbox_id:"force_acp_object_imput",acp_search_form_id:"force_acp_object_form",acp_partner:"flsh",acp_suggestions:"7"};var c=$(acpObj.acp_searchbox_id);c.addEventListener("keyup",function(event){acpObj.ac.s(event,c)});var b=document.createElement("div");b.setAttribute("class","acp_ltr");var mainContainer=b;var table=document.createElement("table");b.appendChild(table);table.setAttribute("cellspacing","0");b.setAttribute("style","display:none");b.setAttribute("id",suggestElemId);var a=document.createElement("tbody");a.setAttribute("id",suggestionsTableId);table.appendChild(a);c.parentNode.appendChild(b);if(!acpObj.acp_sig){acpObj.acp_sig="on"}if(acpObj.acp_sig=="on"){var tfoot=document.createElement("tfoot");var tr=document.createElement("tr");var td=document.createElement("td");tr.appendChild(td);tfoot.appendChild(tr);table.appendChild(tfoot)}b=table;(function(){var b={y:-1,table:$(suggestionsTableId)};function g(h,k){for(var j=h.table.rows.length-1;j>=0;j--){h.table.rows[j].style.backgroundColor=""}if(k===undefined){h.table.rows[h.y].style.backgroundColor="#eee";$(acpObj.acp_searchbox_id).value=h.table.rows[h.y].cells[0].getAttribute("queryText")}else{k.style.backgroundColor="#eee";h.y=k.getAttribute("sugID")}}function c(m,k,l){var n;if(document.all){n="rules"}else{if(document.getElementById){n="cssRules"}}var j=document.styleSheets;for(var h=0;h<document.styleSheets[j.length-1][n].length;h++){if(document.styleSheets[j.length-1][n][h].selectorText==m){document.styleSheets[j.length-1][n][h].style[k]=l;return}}}function e(i){if(!acpObj.acp_b){acpObj.acp_b=1}if(!b.table){b.table=$(suggestionsTableId);var j=$(acpObj.acp_searchbox_id)}if(!acpObj.acp_api){}this.c(i)}function d(query){acSources[acSource]({query:query},function(result){a({items:result.items,query:query})})}function f(i,h){if(h.value.length==0){$(suggestElemId).style.display="none";return}if(i.keyCode==27){if($(suggestElemId)&&$(suggestElemId).style.display!="none"){autocompleteHide(i);i.stopPropagation()}return}var i=i||event;switch(i.keyCode){case 38:b.y--;break;case 40:b.y++;break;case 13:case 39:case 37:return;break;default:this.r(h.value);b.y=-1;return}if(b.y<0){b.y=b.table.rows.length-1}if(b.y>=b.table.rows.length){b.y=0}if(b.y>=b.table.rows.length){b.y=0}if(i.keyCode==38||i.keyCode==40){if($(suggestElemId)&&$(suggestElemId).style.display=="none"){fvdSpeedDial.AutoComplete.onPopupShow.callListeners();$(suggestElemId).style.display="block"}}this.f(b)}function a(m){dd_hide();var i=$(suggestionsTableId);var l=String(m.items).split(",");while(i.rows&&i.rows.length){i.deleteRow(-1)}for(var s in l){if(l[s]==""){continue}var k=i.insertRow(-1);var h=k.insertCell(0);h.style.display="block";var bolderText=document.createElement("b");bolderText.textContent=l[s].substr(m.query.length,l[s].length);var queryText=document.createTextNode(m.query);var newdiv=document.createElement("div");newdiv.appendChild(queryText);newdiv.appendChild(bolderText);h.setAttribute("queryText",l[s]);h.appendChild(newdiv);h.style.width="";k.setAttribute("sugID",s);k.onmouseover=function(){acpObj.ac.f(b,this)};k.addEventListener("dblclick",function(event){event.stopPropagation()},false);k.addEventListener("click",function(event){$(acpObj.acp_searchbox_id).value="";$(acpObj.acp_searchbox_id).focus();var te=document.createEvent("TextEvent");te.initTextEvent("textInput",true,true,window,this.cells[0].getAttribute("queryText"));$(acpObj.acp_searchbox_id).dispatchEvent(te);autocompleteHide();event.stopPropagation();self.onClickSuggestion.callListeners()})}document.addEventListener("click",autocompleteHide,false);if($(suggestElemId).style.display=="none"){$(suggestElemId).style.display="block"}if(i.rows.length==0){$(suggestElemId).style.display="none"}fvdSpeedDial.AutoComplete.onPopupShow.callListeners()}acpObj.ac={s:f,h:a,r:e,c:d,f:g,css:c}})()}startAutocomplete()}fvdSpeedDial.AutoCompletePlus=AutoComplete})();(function(){var ContextMenus=function(){};ContextMenus.prototype={_globalMenu:null,
_speedDialCellMenu:null,_speedDialGroupContextMenu:null,_speedDialGroupManageGroupsMenu:null,_mostVisitedCellMenu:null,_mostVisitedInGroupUrlMenu:null,_appsCellMenu:null,_recentlyClosedCellMenu:null,init:function(){var that=this;setTimeout(function(){that._appsCellMenu=new dhtmlXMenuObject;that._appsCellMenu.renderAsContextMenu();that.rebuildAppsCellMenu();that._appsCellMenu.attachEvent("onclick",function(action,cellId){var cell=document.getElementById(cellId);var appId=cell.getAttribute("_app");switch(action){case"open":chrome.management.launchApp(appId);break;case"remove":chrome.management.uninstall(appId);break}});that._recentlyClosedCellMenu=new dhtmlXMenuObject;that._recentlyClosedCellMenu.renderAsContextMenu();that.rebuildRecentlyClosedCellMenu();that._recentlyClosedCellMenu.attachEvent("onclick",function(action,cellId){var cell=document.getElementById(cellId);if(!cell){return false}var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(cell);fvdSpeedDial.Storage.RecentlyClosed.get(dialId,function(data){switch(action){case"open_tab":fvdSpeedDial.Utils.Opener.currentTab(data.url);break;case"open_new_tab":fvdSpeedDial.Utils.Opener.newTab(data.url);break;case"open_bg_tab":fvdSpeedDial.Utils.Opener.backgroundTab(data.url);break;case"add_to_speeddial":fvdSpeedDial.Dialogs.addDial(data,"speeddial",true);break;case"remove":fvdSpeedDial.Storage.RecentlyClosed.remove(data.id,function(){fvdSpeedDial.SpeedDial.sheduleFullRebuild()});break;case"block":fvdSpeedDial.Dialogs.deny({type:"url",sign:data.url});break;case"copy_url":fvdSpeedDial.Utils.copyToClipboard(data.url);break}})});that._mostVisitedInGroupUrlMenu=new dhtmlXMenuObject;that._mostVisitedInGroupUrlMenu.renderAsContextMenu();that._mostVisitedInGroupUrlMenu.attachEvent("onclick",function(action,cellId){var dialId=cellId.replace("mostvisitedInGroupUrl_","");fvdSpeedDial.Storage.MostVisited.getById(dialId,fvdSpeedDial.SpeedDial.currentGroupId(),"url",function(data){switch(action){case"open_tab":fvdSpeedDial.Utils.Opener.currentTab(data.url);break;case"open_new_tab":fvdSpeedDial.Utils.Opener.newTab(data.url);break;case"open_bg_tab":fvdSpeedDial.Utils.Opener.backgroundTab(data.url);break;case"add_to_speeddial":fvdSpeedDial.Dialogs.addDial(data,"speeddial",true,function(){fvdSpeedDial.Dialogs.ViewGroup.currentDlg.close()});break;case"remove":fvdSpeedDial.Storage.MostVisited.deleteId(data.id,function(result){if(result.result){fvdSpeedDial.Dialogs.ViewGroup.rebuild();fvdSpeedDial.SpeedDial.sheduleFullRebuild()}});break;case"block":fvdSpeedDial.Dialogs.deny({type:"url",sign:data.url});break;case"copy_url":fvdSpeedDial.Utils.copyToClipboard(data.url);break}})});that.rebuildMostVisitedInGroupUrlMenu();that._mostVisitedCellMenu=new dhtmlXMenuObject;that._mostVisitedCellMenu.renderAsContextMenu();that._mostVisitedCellMenu.attachEvent("onContextMenu",function(x,cellId){var cell=document.getElementById(cellId);if(!cell){return false}var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(cell);fvdSpeedDial.Storage.MostVisited.getById(dialId,fvdSpeedDial.SpeedDial.currentGroupId(),null,function(data){fvdSpeedDial.Storage.MostVisited.extendData(data,function(extendedData){if(extendedData.thumb_source_type=="screen"){that._mostVisitedCellMenu.setItemEnabled("refresh")}else{that._mostVisitedCellMenu.setItemDisabled("refresh")}})})});that._mostVisitedCellMenu.attachEvent("onClick",function(action,cellId){var cell=document.getElementById(cellId);if(!cell){return false}var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(cell);fvdSpeedDial.Storage.MostVisited.getById(dialId,fvdSpeedDial.SpeedDial.currentGroupId(),null,function(data){if(data){switch(action){case"open_tab":fvdSpeedDial.Utils.Opener.currentTab(data.url);break;case"open_new_tab":fvdSpeedDial.Utils.Opener.newTab(data.url);break;case"open_bg_tab":fvdSpeedDial.Utils.Opener.backgroundTab(data.url);break;case"add_to_speeddial":if(data.title){}else if(data.auto_title){data.title=data.auto_title}fvdSpeedDial.Dialogs.addDial(data,"speeddial",true);break;case"edit":fvdSpeedDial.Storage.MostVisited.extendData(data,function(extendedData){fvdSpeedDial.Dialogs.addDial(extendedData,"mostvisited",false)});break;case"refresh":fvdSpeedDial.Storage.MostVisited.extendData(data,function(extendedData){if(extendedData.get_screen_method=="manual"){fvdSpeedDial.SpeedDial.makeThumb(extendedData.id,extendedData.url,"mostvisited",extendedData.screen_delay)}else{fvdSpeedDial.SpeedDial.ThumbManager.hiddenCaptureThumb({type:"mostvisited",interval:fvdSpeedDial.SpeedDial.currentGroupId(),data:{id:dialId},elemId:cell.getAttribute("id")})}});break;case"remove":fvdSpeedDial.Storage.MostVisited.deleteId(data.id,function(result){if(result.result){fvdSpeedDial.SpeedDial.dialRemoveAnimate(data.id)}});break;case"block":fvdSpeedDial.Dialogs.deny({type:"url",sign:data.url});break;case"copy_url":fvdSpeedDial.Utils.copyToClipboard(data.url);break}}})});that.rebuildMostVisitedCellMenu();that._speedDialGroupManageGroupsMenu=new dhtmlXMenuObject;that._speedDialGroupManageGroupsMenu.renderAsContextMenu();that.rebuildSpeedDialGroupManageGroupsMenu();that._speedDialGroupManageGroupsMenu.attachEvent("onContextMenu",function(x,elemId){var groupId=elemId.replace("group_","");var menu=that._speedDialGroupManageGroupsMenu;menu.setCheckboxState("default_group",fvdSpeedDial.Prefs.get("sd.default_group")==groupId)});that._speedDialGroupManageGroupsMenu.attachEvent("onClick",function(action,elemId){var groupId=elemId.replace("group_","");switch(action){case"default_group":fvdSpeedDial.Prefs.set("sd.default_group",groupId);that._speedDialGroupManageGroupsMenu.setCheckboxState("default_group",true);break;case"edit":fvdSpeedDial.Dialogs.ManageGroups.editGroupById(groupId);break;case"remove":fvdSpeedDial.SpeedDial.removeGroup(groupId);break}});that._speedDialGroupContextMenu=new dhtmlXMenuObject;that._speedDialGroupContextMenu.renderAsContextMenu();that._speedDialGroupContextMenu.attachEvent("onContextMenu",function(x,elemId){var elem=document.getElementById(elemId);if(!elem){return false}var groupId=fvdSpeedDial.SpeedDial._getGroupByItem(elem);var menu=that._speedDialGroupContextMenu;if(groupId==0){menu.setItemDisabled("edit");menu.setItemDisabled("remove")}else{menu.setItemEnabled("edit");menu.setItemEnabled("remove")}menu.setCheckboxState("default_group",fvdSpeedDial.Prefs.get("sd.default_group")==groupId);menu.setCheckboxState("last_selected_group",fvdSpeedDial.Prefs.get("sd.default_group")==-1)});that._speedDialGroupContextMenu.attachEvent("onClick",function(action,elemId){var menu=that._speedDialGroupContextMenu;var elem=document.getElementById(elemId);if(!elem){return false}var groupId=fvdSpeedDial.SpeedDial._getGroupByItem(elem);switch(action){case"sync_group":var sync=menu.getCheckboxState("sync_group")?1:0;fvdSpeedDial.Utils.Async.chain([function(chainCallback){fvdSpeedDial.Sync.syncAddonExists(function(exists){if(!exists){fvdSpeedDial.Dialogs.installFVDSync()}else{chainCallback()}})},function(chainCallback){if(sync==1){chainCallback()}else{fvdSpeedDial.Dialogs.setGroupNoSyncDialog(function(set){if(set){chainCallback()}})}},function(){fvdSpeedDial.Storage.groupUpdate(groupId,{sync:sync})}]);break;case"default_group":fvdSpeedDial.Prefs.set("sd.default_group",groupId);menu.setCheckboxState("default_group",true);menu.setCheckboxState("last_selected_group",false);break;case"last_selected_group":fvdSpeedDial.Prefs.set("sd.default_group",-1);menu.setCheckboxState("default_group",false);menu.setCheckboxState("last_selected_group",true);break;case"edit":fvdSpeedDial.Dialogs.addGroup(groupId);break;case"remove":fvdSpeedDial.SpeedDial.removeGroup(groupId);break;case"open_all":fvdSpeedDial.SpeedDial.openAllDialsInGrop(groupId);break;case"manage":fvdSpeedDial.Dialogs.manageGroups();break;case"refresh_all":fvdSpeedDial.SpeedDial.refreshAllDialsInGroup(fvdSpeedDial.SpeedDial.currentGroupId());break}});that.rebuildSpeedDialGroupContextMenu();that._speedDialCellMenu=new dhtmlXMenuObject;that._speedDialCellMenu.renderAsContextMenu();that._speedDialCellMenu.attachEvent("onContextMenu",function(x,elemId){var elem=document.getElementById(elemId);if(!elem){return false}var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(elem);fvdSpeedDial.Storage.getDial(dialId,function(data){fvdSpeedDial.Storage.groupsList(function(groups){for(var i=0;i!=groups.length;i++){that._speedDialCellMenu.setItemEnabled("move_to_gr_"+groups[i].id)}that._speedDialCellMenu.setItemDisabled("move_to_gr_"+data.group_id);if(data.thumb_source_type=="screen"){that._speedDialCellMenu.setItemEnabled("refresh")}else{that._speedDialCellMenu.setItemDisabled("refresh")}})})});that._speedDialCellMenu.attachEvent("onclick",function(action,elemId){var elem=document.getElementById(elemId);if(!elem){return false}var dialId=fvdSpeedDial.SpeedDial._getDialIdByCell(elem);switch(action){case"edit":fvdSpeedDial.Storage.getDial(dialId,function(data){if(data==null){return}fvdSpeedDial.Dialogs.addDial(data)});break;case"remove":fvdSpeedDial.Dialogs.confirm(_("dlg_confirm_remove_dial_title"),_("dlg_confirm_remove_dial_text"),function(confirmResult){if(confirmResult){fvdSpeedDial.Sync.addDataToSync({category:"deleteDials",data:dialId,translate:"dial"},function(){fvdSpeedDial.Storage.deleteDial(dialId,function(){fvdSpeedDial.SpeedDial.dialRemoveAnimate(dialId)})})}});break;case"refresh":fvdSpeedDial.Storage.getDial(dialId,function(data){if(data.get_screen_method=="manual"){try{fvdSpeedDial.SpeedDial.makeThumb(data.id,data.url,"speeddial",data.screen_delay)}catch(ex){}}else{fvdSpeedDial.SpeedDial.ThumbManager.hiddenCaptureThumb({type:"speeddial",data:{id:dialId},elemId:elem.getAttribute("id")})}});break;case"copy_url":fvdSpeedDial.Storage.getDial(dialId,function(data){fvdSpeedDial.Utils.copyToClipboard(data.url)});break;case"open_tab":fvdSpeedDial.Storage.getDial(dialId,function(data){fvdSpeedDial.Utils.Opener.currentTab(data.url)});break;case"open_new_tab":fvdSpeedDial.Storage.getDial(dialId,function(data){fvdSpeedDial.Utils.Opener.newTab(data.url)});break;case"open_bg_tab":fvdSpeedDial.Storage.getDial(dialId,function(data){fvdSpeedDial.Utils.Opener.backgroundTab(data.url)});break}if(action.indexOf("move_to_gr_")!=-1){var groupId=action.replace("move_to_gr_","");var can=false;fvdSpeedDial.Utils.Async.chain([function(chainCallback){fvdSpeedDial.Storage.groupCanSyncById(groupId,function(c){can=c;if(!can){fvdSpeedDial.Dialogs.moveDialToNoSyncGroupDialog(function(r){if(r){chainCallback()}})}else{chainCallback()}})},function(){fvdSpeedDial.SpeedDial.dialMoveToGroup(dialId,groupId)}])}});that.rebuildSpeedDialCellMenu()},0)},assignToElem:function(elem,type){var menu=null;switch(type){case"speeddial":menu=this._speedDialCellMenu;break;case"speeddialGroup":menu=this._speedDialGroupContextMenu;break;case"speeddialManageGroups":menu=this._speedDialGroupManageGroupsMenu;break;case"mostvisited":menu=this._mostVisitedCellMenu;break;case"mostvisitedGroupUrl":var menu=this._mostVisitedInGroupUrlMenu;break;case"recentlyclosed":menu=this._recentlyClosedCellMenu;break;case"app":menu=this._appsCellMenu;break}if(menu!=null){menu.addContextZone(elem)}},setGlobalMenu:function(type){var menu=null;switch(type){case"speeddial":menu=this._createSpeedDialGlobalMenu();break;case"mostvisited":menu=this._createMostVisitedGlobalMenu();break;case"recentlyclosed":menu=this._createRecentlyClosedGlobalMenu();break}if(this._globalMenu!=null){this._globalMenu.unload()}menu.addContextZone(document.documentElement);this._globalMenu=menu},rebuildSpeedDialCellMenu:function(callback){var that=this;fvdSpeedDial.Storage.groupsList(function(groups){that._speedDialCellMenu.clearAll();that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,0,"open_tab",_("cm_speeddial_cell_open_tab"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,1,"open_new_tab",_("cm_speeddial_cell_open_new_tab"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,2,"open_bg_tab",_("cm_speeddial_cell_open_bg_tab"),false,false);that._speedDialCellMenu.addNewSeparator("open_bg_tab","sep");that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,4,"refresh",_("cm_speeddial_cell_refresh"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,5,"edit",_("cm_speeddial_cell_edit"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,6,"remove",_("cm_speeddial_cell_remove"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,7,"copy_url",_("cm_speeddial_cell_copy_url"),false,false);that._speedDialCellMenu.addNewChild(that._speedDialCellMenu.topId,8,"move_to",_("cm_speeddial_cell_move_to"),false,false);for(var i=0;i!=groups.length;i++){that._speedDialCellMenu.addNewChild("move_to",i,"move_to_gr_"+groups[i].id,groups[i].name,false,false)}if(callback){callback()}})},rebuildSpeedDialGroupManageGroupsMenu:function(){var menu=this._speedDialGroupManageGroupsMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"edit",_("cm_speeddial_group_edit"),false,false);menu.addCheckbox("sibling","edit",null,"default_group",_("cm_speeddial_group_default"),false,false);menu.addNewChild(menu.topId,2,"remove",_("cm_speeddial_group_remove"),false,false)},rebuildSpeedDialGroupContextMenu:function(callback){var menu=this._speedDialGroupContextMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"edit",_("cm_speeddial_group_edit"),false,false);menu.addCheckbox("sibling","edit",null,"default_group",_("cm_speeddial_group_default"),false,false);menu.addCheckbox("sibling","default_group",null,"last_selected_group",_("newtab_last_used_group"),false,false);menu.addNewChild(menu.topId,4,"remove",_("cm_speeddial_group_remove"),false,false);menu.addNewChild(menu.topId,5,"open_all",_("cm_speeddial_group_open_all"),false,false);menu.addNewChild(menu.topId,6,"manage",_("cm_speeddial_group_manage"),false,false);menu.addNewChild(menu.topId,7,"refresh_all",_("cm_refresh_all"),false,false);menu.addNewSeparator("remove","sep")},rebuildMostVisitedInGroupUrlMenu:function(){var menu=this._mostVisitedInGroupUrlMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"open_tab",_("cm_speeddial_cell_open_tab"),false,false);menu.addNewChild(menu.topId,1,"open_new_tab",_("cm_speeddial_cell_open_new_tab"),false,false);menu.addNewChild(menu.topId,2,"open_bg_tab",_("cm_speeddial_cell_open_bg_tab"),false,false);menu.addNewChild(menu.topId,3,"remove",_("cm_speeddial_cell_remove"),false,false);menu.addNewChild(menu.topId,4,"add_to_speeddial",_("cm_mostvisited_cell_add_to_speeddial"),false,"/images/icons/16x16.png");menu.addNewChild(menu.topId,5,"block",_("cm_mostvisited_cell_block"),false,false);menu.addNewChild(menu.topId,6,"copy_url",_("cm_speeddial_cell_copy_url"),false,false);menu.addNewSeparator("open_bg_tab","sep")},rebuildRecentlyClosedCellMenu:function(){var menu=this._recentlyClosedCellMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"open_tab",_("cm_speeddial_cell_open_tab"),false,false);menu.addNewChild(menu.topId,1,"open_new_tab",_("cm_speeddial_cell_open_new_tab"),false,false);menu.addNewChild(menu.topId,2,"open_bg_tab",_("cm_speeddial_cell_open_bg_tab"),false,false);menu.addNewSeparator("open_bg_tab","sep");menu.addNewChild(menu.topId,4,"add_to_speeddial",_("cm_mostvisited_cell_add_to_speeddial"),false,"/images/icons/16x16.png");menu.addNewChild(menu.topId,6,"remove",_("cm_speeddial_cell_remove"),false,false);menu.addNewChild(menu.topId,7,"block",_("cm_mostvisited_cell_block"),false,false);menu.addNewChild(menu.topId,8,"copy_url",_("cm_speeddial_cell_copy_url"),false,false)},rebuildMostVisitedCellMenu:function(){var menu=this._mostVisitedCellMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"open_tab",_("cm_speeddial_cell_open_tab"),false,false);menu.addNewChild(menu.topId,1,"open_new_tab",_("cm_speeddial_cell_open_new_tab"),false,false);menu.addNewChild(menu.topId,2,"open_bg_tab",_("cm_speeddial_cell_open_bg_tab"),false,false);menu.addNewSeparator("open_bg_tab","sep");menu.addNewChild(menu.topId,4,"refresh",_("cm_speeddial_cell_refresh"),false,false);menu.addNewChild(menu.topId,5,"add_to_speeddial",_("cm_mostvisited_cell_add_to_speeddial"),false,"/images/icons/16x16.png");menu.addNewChild(menu.topId,6,"edit",_("cm_speeddial_cell_edit"),false,false);menu.addNewChild(menu.topId,7,"remove",_("cm_speeddial_cell_remove"),false,false);menu.addNewChild(menu.topId,8,"block",_("cm_mostvisited_cell_block"),false,false);menu.addNewChild(menu.topId,9,"copy_url",_("cm_speeddial_cell_copy_url"),false,false)},rebuildAppsCellMenu:function(){var menu=this._appsCellMenu;menu.clearAll();menu.addNewChild(menu.topId,0,"open",_("cm_apps_open"),false,false);menu.addNewChild(menu.topId,1,"remove",_("cm_apps_remove"),false,false)},_createRecentlyClosedGlobalMenu:function(){var menu=new dhtmlXMenuObject;menu.renderAsContextMenu();menu.addNewChild(menu.topId,0,"open_all",_("cm_speeddial_global_open_all"),false,false);menu.addNewChild(menu.topId,1,"style",_("cm_speeddial_global_style"),false,false);menu.addRadioButton("child","style",0,"style_fancy",_("cm_speeddial_global_style_fancy"),"style",false,false);menu.addRadioButton("child","style",1,"style_standard",_("cm_speeddial_global_style_standard"),"style",false,false);function rebuildColumns(){try{menu.removeItem("number_of_columns")}catch(ex){}var columnsAuto=fvdSpeedDial.SpeedDial.cellsInRowMax("auto");var title=null;if(columnsAuto.rows){columnsAuto=columnsAuto.rows;title=_("cm_speeddial_global_number_of_rows")}else if(columnsAuto.cols){columnsAuto=columnsAuto.cols;title=_("cm_speeddial_global_number_of_columns")}menu.addNewChild(menu.topId,1,"number_of_columns",title,false,false);var preValue=fvdSpeedDial.Prefs.get("sd.recentlyclosed_columns");var numOfColumns=columnsAuto;if(preValue!="auto"){if(preValue>columnsAuto||isNaN(numOfColumns)){numOfColumns=preValue}}menu.addRadioButton("child","number_of_columns",0,"columns_auto",_("newtab_columns_auto"),"number_of_columns",false,false);for(var columnNum=1;columnNum<=numOfColumns;columnNum++){menu.addRadioButton("child","number_of_columns",columnNum,"columns_"+columnNum,columnNum,"number_of_columns",false,false)}menu.setRadioChecked("number_of_columns","columns_"+preValue)}menu.attachEvent("onContextMenu",function(){rebuildColumns();if(fvdSpeedDial.PowerOffClient.isHidden()){menu.hide()}var checkId="style_"+fvdSpeedDial.Prefs.get("sd.display_mode");menu.setRadioChecked("style",checkId)});menu.attachEvent("onClick",function(action){if(action.indexOf("columns_")==0){var columns=action.replace("columns_","");fvdSpeedDial.Prefs.set("sd.recentlyclosed_columns",columns);return}else if(action.indexOf("style")==0){var style=action.replace("style_","");fvdSpeedDial.Prefs.set("sd.display_mode",style)}else if(action=="open_all"){fvdSpeedDial.SpeedDial.openAllCurrentRecentlyClosedLinks()}});return menu},_createMostVisitedGlobalMenu:function(){var menu=new dhtmlXMenuObject;menu.renderAsContextMenu();menu.addNewChild(menu.topId,0,"open_all",_("cm_speeddial_global_open_all"),false,false);menu.addNewChild(menu.topId,1,"style",_("cm_speeddial_global_style"),false,false);menu.addNewChild(menu.topId,2,"view",_("cm_speeddial_global_view"),false,false);menu.addRadioButton("child","style",0,"style_fancy",_("cm_speeddial_global_style_fancy"),"style",false,false);menu.addRadioButton("child","style",1,"style_standard",_("cm_speeddial_global_style_standard"),"style",false,false);var currentCellSize=fvdSpeedDial.SpeedDial._currentCellSize();menu.addRadioButton("child","view",0,"view_list",_("cm_speeddial_global_view_list"),"view",false,false);menu.addRadioButton("child","view",1,"view_custom",_("cm_speeddial_global_preview")+" ( "+currentCellSize.width+"x"+currentCellSize.height+" )","view",false,false);menu.addNewChild("view",2,"view_dial_size",_("cm_speeddial_global_change_size"),false,false);menu.addNewChild(menu.topId,3,"scroll_type",_("cm_scrolling_type"),false,false);menu.addRadioButton("child","scroll_type",0,"scroll_type_vertical",_("options_scrolling_vertical"),"scroll_type",false,false);menu.addRadioButton("child","scroll_type",1,"scroll_type_horizontal",_("options_scrolling_horizontal"),"scroll_type",false,false);menu.addNewSeparator("open_all","sep");function rebuildColumns(){try{menu.removeItem("number_of_columns")}catch(ex){}var columnsAuto=fvdSpeedDial.SpeedDial.cellsInRowMax("auto");var title=null;if(columnsAuto.rows){columnsAuto=columnsAuto.rows;title=_("cm_speeddial_global_number_of_rows")}else if(columnsAuto.cols){columnsAuto=columnsAuto.cols;title=_("cm_speeddial_global_number_of_columns")}menu.addNewChild(menu.topId,5,"number_of_columns",title,false,false);var preValue=fvdSpeedDial.Prefs.get("sd.most_visited_columns");var numOfColumns=columnsAuto;if(preValue!="auto"){if(preValue>columnsAuto||isNaN(numOfColumns)){numOfColumns=preValue}}menu.addRadioButton("child","number_of_columns",0,"columns_auto",_("newtab_columns_auto"),"number_of_columns",false,false);for(var columnNum=1;columnNum<=numOfColumns;columnNum++){menu.addRadioButton("child","number_of_columns",columnNum,"columns_"+columnNum,columnNum,"number_of_columns",false,false)}menu.setRadioChecked("number_of_columns","columns_"+preValue)}function onContextMenu(){rebuildColumns();var checkId="view_"+fvdSpeedDial.SpeedDial.currentThumbsMode();menu.setRadioChecked("view",checkId);checkId="style_"+fvdSpeedDial.Prefs.get("sd.display_mode");menu.setRadioChecked("style",checkId);checkId="scroll_type_"+fvdSpeedDial.Prefs.get("sd.scrolling");menu.setRadioChecked("scroll_type",checkId);if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"||fvdSpeedDial.SpeedDial.currentThumbsMode()=="list"){menu.setItemDisabled("scroll_type")}else{menu.setItemEnabled("scroll_type")}if(fvdSpeedDial.PowerOffClient.isHidden()){menu.hide()}}menu.attachEvent("onContextMenu",onContextMenu);menu.attachEvent("onClick",function(action){var callOnContextMenu=true;if(action.indexOf("view")==0){if(action=="view_dial_size"){fvdSpeedDial.SpeedDial.openSizeSetup()}else{var thumbsMode=action.replace("view_","");fvdSpeedDial.SpeedDial.setCurrentThumbsMode(thumbsMode);rebuildColumns()}}else if(action.indexOf("style")==0){var style=action.replace("style_","");fvdSpeedDial.Prefs.set("sd.display_mode",style);menu.setItemDisabled("style_fancy");menu.setItemDisabled("style_standard");setTimeout(function(){menu.setItemEnabled("style_fancy");menu.setItemEnabled("style_standard")},1e3)}else if(action.indexOf("columns_")==0){var columns=action.replace("columns_","");fvdSpeedDial.Prefs.set("sd.most_visited_columns",columns);callOnContextMenu=false}else if(action.indexOf("scroll_type_")==0){var newScrollType=action.replace("scroll_type_","");fvdSpeedDial.Prefs.set("sd.scrolling",newScrollType)}else if(action=="open_all"){fvdSpeedDial.SpeedDial.openAllCurrentMostVisitedLinks()}if(callOnContextMenu){onContextMenu()}});return menu},_createSpeedDialGlobalMenu:function(){var menu=new dhtmlXMenuObject;menu.renderAsContextMenu();menu.addNewChild(menu.topId,0,"add_dial",_("cm_speeddial_global_add_dial"),false,"/images/newtab/contextmenu/plus.png");menu.addNewChild(menu.topId,1,"open_all",_("cm_speeddial_global_open_all"),false,false);menu.addNewChild(menu.topId,2,"style",_("cm_speeddial_global_style"),false,false);var currentCellSize=fvdSpeedDial.SpeedDial._currentCellSize();menu.addNewChild(menu.topId,3,"view",_("cm_speeddial_global_view"),false,false);menu.addRadioButton("child","style",0,"style_fancy",_("cm_speeddial_global_style_fancy"),"style",false,false);menu.addRadioButton("child","style",1,"style_standard",_("cm_speeddial_global_style_standard"),"style",false,false);menu.addRadioButton("child","view",0,"view_list",_("cm_speeddial_global_view_list"),"view",false,false);menu.addRadioButton("child","view",1,"view_custom",_("cm_speeddial_global_preview")+" ( "+currentCellSize.width+"x"+currentCellSize.height+" )","view",false,false);menu.addNewChild("view",2,"view_dial_size",_("cm_speeddial_global_change_size"),false,false);menu.addNewChild(menu.topId,4,"scroll_type",_("cm_scrolling_type"),false,false);menu.addRadioButton("child","scroll_type",0,"scroll_type_vertical",_("options_scrolling_vertical"),"scroll_type",false,false);menu.addRadioButton("child","scroll_type",1,"scroll_type_horizontal",_("options_scrolling_horizontal"),"scroll_type",false,false);menu.addNewChild(menu.topId,5,"refresh_all",_("cm_refresh_all"),false,false);menu.addNewSeparator("add_dial","sep");function rebuildColumns(){try{menu.removeItem("number_of_columns")}catch(ex){}var columnsAuto=fvdSpeedDial.SpeedDial.cellsInRowMax("auto");var title=null;if(columnsAuto.rows){columnsAuto=columnsAuto.rows;title=_("cm_speeddial_global_number_of_rows")}else if(columnsAuto.cols){columnsAuto=columnsAuto.cols;title=_("cm_speeddial_global_number_of_columns")}menu.addNewChild(menu.topId,4,"number_of_columns",title,false,false);var preValue=fvdSpeedDial.Prefs.get("sd.top_sites_columns");var numOfColumns=columnsAuto;if(preValue!="auto"){if(preValue>columnsAuto||isNaN(numOfColumns)){numOfColumns=preValue}}menu.addRadioButton("child","number_of_columns",0,"columns_auto",_("newtab_columns_auto"),"number_of_columns",false,false);for(var columnNum=1;columnNum<=numOfColumns;columnNum++){menu.addRadioButton("child","number_of_columns",columnNum,"columns_"+columnNum,columnNum,"number_of_columns",false,false)}menu.setRadioChecked("number_of_columns","columns_"+preValue)}function onContextMenu(){rebuildColumns();var checkId="view_"+fvdSpeedDial.SpeedDial.currentThumbsMode();menu.setRadioChecked("view",checkId);checkId="style_"+fvdSpeedDial.Prefs.get("sd.display_mode");menu.setRadioChecked("style",checkId);checkId="scroll_type_"+fvdSpeedDial.Prefs.get("sd.scrolling");menu.setRadioChecked("scroll_type",checkId);if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"||fvdSpeedDial.SpeedDial.currentThumbsMode()=="list"){menu.setItemDisabled("scroll_type")}else{menu.setItemEnabled("scroll_type")}if(fvdSpeedDial.PowerOffClient.isHidden()){menu.hide()}}menu.attachEvent("onContextMenu",onContextMenu);menu.attachEvent("onClick",function(action){var callOnContextMenu=true;if(action.indexOf("view")==0){if(action=="view_dial_size"){fvdSpeedDial.SpeedDial.openSizeSetup()}else{var thumbsMode=action.replace("view_","");fvdSpeedDial.SpeedDial.setCurrentThumbsMode(thumbsMode);rebuildColumns()}}else if(action.indexOf("style")==0){menu.setItemDisabled("style_fancy");menu.setItemDisabled("style_standard");setTimeout(function(){menu.setItemEnabled("style_fancy");menu.setItemEnabled("style_standard")},1e3);var style=action.replace("style_","");fvdSpeedDial.Prefs.set("sd.display_mode",style)}else if(action.indexOf("columns_")==0){var columns=action.replace("columns_","");fvdSpeedDial.Prefs.set("sd.top_sites_columns",columns);callOnContextMenu=false}else if(action.indexOf("scroll_type_")==0){var newScrollType=action.replace("scroll_type_","");fvdSpeedDial.Prefs.set("sd.scrolling",newScrollType)}switch(action){case"add_dial":fvdSpeedDial.Dialogs.addDial();break;case"open_all":fvdSpeedDial.SpeedDial.openAllDialsInGrop(fvdSpeedDial.SpeedDial.currentGroupId());break;case"refresh_all":fvdSpeedDial.SpeedDial.refreshAllDialsInGroup(fvdSpeedDial.SpeedDial.currentGroupId());break}if(callOnContextMenu){onContextMenu()}});return menu}};this.ContextMenus=new ContextMenus}).apply(fvdSpeedDial);chrome.runtime.onConnect.addListener(function(port){console.log("Obtained connection",port)});window.addEventListener("load",function(){fvdSpeedDial.Localizer.localizeCurrentPage();fvdSpeedDial.AutoComplete=new fvdSpeedDial.AutoCompletePlus({input:"#q",form:"#cse-search-box"});fvdSpeedDial.AutoComplete.onClickSuggestion.addListener(function(){fvdSpeedDial.SpeedDialMisc.doSearch()});start_drop_down();fvdSpeedDial.SpeedDialMisc.init();fvdSpeedDial.SpeedDial.init();fvdSpeedDial.SpeedDial._cellsRebuildCallback=function(){document.body.setAttribute("loaded",1)};fvdSpeedDial.SpeedDial.sheduleFullRebuild();fvdSpeedDial.ContextMenus.init();function showCorruptedFilesRestore(){var overlay=document.getElementById("restoreCorruptedFilesOverlay");overlay.removeAttribute("hidden");setTimeout(function(){overlay.setAttribute("appear",1)},0)}function hideCorruptedFilesRestore(){var overlay=document.getElementById("restoreCorruptedFilesOverlay");overlay.removeAttribute("appear");overlay.setAttribute("hidden",1)}Broadcaster.onMessage.addListener(function(msg){if(msg.action=="storage:fs:updatestate"){if(msg.state=="restoring"){showCorruptedFilesRestore()}else if(msg.state=="normal"){var overlay=document.getElementById("restoreCorruptedFilesOverlay");if(overlay.hasAttribute("appear")){document.location.reload()}}}});chrome.runtime.sendMessage({action:"storage:fs:getState"},function(state){if(state=="restoring"){showCorruptedFilesRestore()}})},false);(function(){var placeHolderInserted;function Position(x,y){this.X=x;this.Y=y;this.Add=function(val){var newPos=new Position(this.X,this.Y);if(val!=null){if(!isNaN(val.X))newPos.X+=val.X;if(!isNaN(val.Y))newPos.Y+=val.Y}return newPos};this.Subtract=function(val){var newPos=new Position(this.X,this.Y);if(val!=null){if(!isNaN(val.X))newPos.X-=val.X;if(!isNaN(val.Y))newPos.Y-=val.Y}return newPos};this.Min=function(val){var newPos=new Position(this.X,this.Y);if(val==null)return newPos;if(!isNaN(val.X)&&this.X>val.X)newPos.X=val.X;if(!isNaN(val.Y)&&this.Y>val.Y)newPos.Y=val.Y;return newPos};this.Max=function(val){var newPos=new Position(this.X,this.Y);if(val==null)return newPos;if(!isNaN(val.X)&&this.X<val.X)newPos.X=val.X;if(!isNaN(val.Y)&&this.Y<val.Y)newPos.Y=val.Y;return newPos};this.Bound=function(lower,upper){var newPos=this.Max(lower);return newPos.Min(upper)};this.Check=function(){var newPos=new Position(this.X,this.Y);if(isNaN(newPos.X))newPos.X=0;if(isNaN(newPos.Y))newPos.Y=0;return newPos};this.Apply=function(element){if(typeof element=="string")element=document.getElementById(element);if(element==null)return;if(!isNaN(this.X))element.style.left=this.X+"px";if(!isNaN(this.Y))element.style.top=this.Y+"px"}}function hookEvent(element,eventName,callback){if(typeof element=="string")element=document.getElementById(element);if(element==null)return;if(element.addEventListener){element.addEventListener(eventName,callback,false)}else if(element.attachEvent)element.attachEvent("on"+eventName,callback)}function unhookEvent(element,eventName,callback){if(typeof element=="string")element=document.getElementById(element);if(element==null)return;if(element.removeEventListener)element.removeEventListener(eventName,callback,false);else if(element.detachEvent)element.detachEvent("on"+eventName,callback)}function cancelEvent(e){e=e?e:window.event;if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();e.cancelBubble=true;e.cancel=true;e.returnValue=false;return false}function getEventTarget(e){e=e?e:window.event;return e.target?e.target:e.srcElement}function absoluteCursorPostion(eventObj){eventObj=eventObj?eventObj:window.event;if(isNaN(window.scrollX))return new Position(eventObj.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,eventObj.clientY+document.documentElement.scrollTop+document.body.scrollTop);else return new Position(eventObj.clientX+window.scrollX,eventObj.clientY+window.scrollY)}function dragObject(element,attachElement,lowerBound,upperBound,startCallback,moveCallback,endCallback,attachLater){if(typeof element=="string")element=document.getElementById(element);if(element==null)return;if(lowerBound!=null&&upperBound!=null){var temp=lowerBound.Min(upperBound);upperBound=lowerBound.Max(upperBound);lowerBound=temp}var cursorStartPos=null;var elementStartPos=null;var dragging=false;var listening=false;var disposed=false;var scrollTopStart=0;var elemStartPosOrigY=null;function listScroll(eventObj){elementStartPos.Y=List.parentNode.scrollTop-scrollTopStart+elemStartPosOrigY}function dragStart(eventObj){scrollTopStart=List.parentNode.scrollTop;if(dragging||!listening||disposed)return;dragging=true;if(startCallback!=null)startCallback(eventObj,element);cursorStartPos=absoluteCursorPostion(eventObj);

elementStartPos=new Position(parseInt(element.style.left),parseInt(element.style.top));elemStartPosOrigY=elementStartPos.Y;elementStartPos=elementStartPos.Check();hookEvent(document,"mousemove",dragGo);hookEvent(List.parentNode,"scroll",listScroll);hookEvent(document,"mouseup",dragStopHook);return cancelEvent(eventObj)}function dragGo(eventObj){if(!dragging||disposed)return;var newPos=absoluteCursorPostion(eventObj);newPos=newPos.Add(elementStartPos).Subtract(cursorStartPos);newPos=newPos.Bound(lowerBound,upperBound);newPos.Apply(element);if(moveCallback!=null)moveCallback(newPos,element,eventObj);return cancelEvent(eventObj)}function dragStopHook(eventObj){dragStop();return cancelEvent(eventObj)}function dragStop(){if(!dragging||disposed)return;unhookEvent(document,"mousemove",dragGo);unhookEvent(document,"mouseup",dragStopHook);unhookEvent(List.parentNode,"scroll",listScroll);cursorStartPos=null;elementStartPos=null;if(endCallback!=null)endCallback(element);dragging=false}this.Dispose=function(){if(disposed)return;this.StopListening(true);element=null;attachElement=null;lowerBound=null;upperBound=null;startCallback=null;moveCallback=null;endCallback=null;disposed=true};this.StartListening=function(){if(listening||disposed)return;listening=true;hookEvent(attachElement,"mousedown",dragStart)};this.StopListening=function(stopCurrentDragging){if(!listening||disposed)return;unhookEvent(attachElement,"mousedown",dragStart);listening=false;if(stopCurrentDragging&&dragging)dragStop()};this.IsDragging=function(){return dragging};this.IsListening=function(){return listening};this.IsDisposed=function(){return disposed};if(typeof attachElement=="string")attachElement=document.getElementById(attachElement);if(attachElement==null)attachElement=element;if(!attachLater)this.StartListening()}var DragLists=function(){};DragLists.prototype={startDragFor:function(list,items,placeHolderClass,className){placeHolderClass=placeHolderClass||"placeHolder";List=list;needClassName=className;if(PlaceHolder!=null){PlaceHolder=null}if(PlaceHolder==null){PlaceHolder=document.createElement("DIV");PlaceHolder.className=placeHolderClass;PlaceHolder.SourceI=null}for(var i=0;i!=items.length;i++){new dragObject(items[i],null,null,null,itemDragBegin,itemMoved,itemDragEnd,false)}}};this.DragLists=new DragLists;var List=null;var PlaceHolder=null;var needClassName="";function itemDragBegin(eventObj,element){element.style.top=element.offsetTop+"px";element.style.left=element.offsetLeft+"px";element.setAttribute("drag",1);List.insertBefore(PlaceHolder,element);PlaceHolder.SourceI=element;placeHolderInserted=false;itemMoved({X:element.offsetLeft,Y:element.offsetTop},element,eventObj)}function itemMoved(newPos,element,eventObj){var yPos=newPos.Y+element.offsetHeight;var temp;var bestItem="end";var listElements=List.getElementsByClassName(needClassName);for(var i=0;i<listElements.length;i++){temp=parseInt(listElements[i].offsetHeight);if(temp>=yPos){bestItem=listElements[i];break}yPos-=temp}if(bestItem==PlaceHolder||bestItem==PlaceHolder.SourceI)return;PlaceHolder.SourceI=bestItem;if(bestItem!="end")List.insertBefore(PlaceHolder,listElements[i]);else List.appendChild(PlaceHolder)}function itemDragEnd(element){if(PlaceHolder.SourceI!=null){PlaceHolder.SourceI=null;List.replaceChild(element,PlaceHolder)}element.removeAttribute("drag");element.style.top="0px";element.style.left="0px"}}).apply(fvdSpeedDial);(function(){var Background=function(){var self=this;this.currentParallaxScene=null;window.addEventListener("resize",function(){self.adoptParallaxLayer()},false)};Background.prototype={CURRENT_CHROME_THEME_BACKGROUND_URL:"chrome://theme/IDR_THEME_NTP_BACKGROUND",setToElem:function(bgData,elem){var that=this;function _set(){that._setToElem(bgData,elem)}if(bgData.imageUrl&&bgData.imageType!="noimage"){var img=new Image;img.onload=function(){bgData.imgInst=img;_set()};img.onerror=function(){_set()};img.src=bgData.imageUrl}else{_set()}},_setToElem:function(bgData,elem){bgData.parallaxDepth=bgData.parallaxDepth||fvdSpeedDial.Prefs.get("sd.background_parallax_depth");var self=this;elem.style.background="none";var parallaxScene=elem.querySelector(".parallax-bg-scene");if(parallaxScene){parallaxScene.parentNode.removeChild(parallaxScene)}if(this.currentParallaxScene){this.currentParallaxScene.disable();this.currentParallaxScene=null}if(bgData.imgInst){if(bgData.imageType==="parallax"){parallaxScene=document.createElement("div");parallaxScene.classList.add("parallax-bg-scene");var layer=document.createElement("div");layer.classList.add("layer");layer.style.backgroundImage="url("+bgData.imageUrl.replace("(","\\(").replace(")","\\)")+")";layer.style.backgroundSize="cover";layer.setAttribute("data-depth",bgData.parallaxDepth/100);parallaxScene.appendChild(layer);var appendTo=elem==document.documentElement?document.body:elem;appendTo.appendChild(parallaxScene);this.currentParallaxScene=new Parallax(parallaxScene);self.adoptParallaxLayer()}else{var elemWidth,elemHeight;if(elem.clientWidth){elemWidth=elem.clientWidth;elemHeight=elem.clientHeight}else{elemWidth=elem.offsetWidth;elemHeight=elem.offsetHeight}elem.style.backgroundImage="url("+bgData.imageUrl.replace("(","\\(").replace(")","\\)")+")";if(bgData.adaptiveSize){var ratio=elemWidth/bgData.adaptiveSize.width;var bgWidth=Math.round(ratio*bgData.imgInst.width);var bgHeight=Math.round(ratio*bgData.imgInst.height);elem.style.backgroundSize=bgWidth+"px "+bgHeight+"px"}switch(bgData.imageType){case"fill":elem.style.backgroundPosition="center center";elem.style.backgroundSize="cover";elem.style.backgroundRepeat="no-repeat";break;case"fit":elem.style.backgroundPosition="center center";elem.style.backgroundSize="contain";elem.style.backgroundRepeat="no-repeat";break;case"stretch":elem.style.backgroundSize="100% 100%";elem.style.backgroundRepeat="no-repeat";break;case"tile":break;case"center":elem.style.backgroundPosition="center center";elem.style.backgroundRepeat="no-repeat";break}if(!bgData.adaptiveSize){elem.style.backgroundAttachment="fixed"}if(bgData.useColor){elem.style.backgroundColor="#"+bgData.color}}}else{if(bgData.useColor){elem.style.backgroundColor="#"+bgData.color}else{}}if(bgData.callback){bgData.callback(bgData)}},adoptParallaxLayer:function(){var scene=document.querySelector(".parallax-bg-scene");var layer=scene.querySelector(".layer");if(!scene||!this.currentParallaxScene){return}var depth=this.currentParallaxScene.depths[0];var xMotion=scene.offsetWidth*(10/100)*depth;var yMotion=scene.offsetHeight*(10/100)*depth;layer.style.left=-xMotion+"px";layer.style.top=-yMotion+"px";layer.style.width=scene.offsetWidth+xMotion*2+"px";layer.style.height=scene.offsetHeight+yMotion*2+"px"}};this.Background=new Background}).apply(fvdSpeedDial);(function(){const FANCY_BACKGROUND_URL=fvdSpeedDial.Prefs._themeDefaults["fancy"]["sd.background_url"];var CSS=function(){};CSS.prototype={stylesheets:[],getFancyBackgroundUrl:function(){return FANCY_BACKGROUND_URL},setTheme:function(name){document.getElementById("themeCSS").setAttribute("href","/themes/"+name+".css")},refreshTheme:function(){try{this.setTheme(fvdSpeedDial.Prefs.get("sd.display_mode"))}catch(ex){}},refresh:function(){var classesColors={".newtabCell .head":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.cell_title.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.cell_title.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.cell_title.bolder")),display:_b(fvdSpeedDial.Prefs.get("sd.show_icons_and_titles_above_dials"))?"block":"none"},".newtabCell .footer":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.cell_url.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.cell_url.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.cell_url.bolder")),display:_b(fvdSpeedDial.Prefs.get("sd.show_urls_under_dials"))?"block":"none"},".newtabListElem .text":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.list_elem.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.list_elem.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.list_elem.bolder"))},"#listViewTypeSelector":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.list_show_url_title.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.list_show_url_title.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.list_show_url_title.bolder"))},".link":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.list_link.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.list_link.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.list_link.bolder"))},".textother":{color:this._color(fvdSpeedDial.Prefs.get("sd.text.other.color")),"font-size":this._size(fvdSpeedDial.Prefs.get("sd.text.other.size")),"font-weight":this._fontWeight(fvdSpeedDial.Prefs.get("sd.text.other.bolder"))},".newtabCell":{opacity:fvdSpeedDial.Prefs.get("sd.dials_opacity")/100},".newtabListElem":{opacity:fvdSpeedDial.Prefs.get("sd.dials_opacity")/100},"#groupsBox > div":{opacity:fvdSpeedDial.Prefs.get("sd.dials_opacity")/100}};if(!_b(fvdSpeedDial.Prefs.get("sd.display_dial_background"))){classesColors[".newtabCell .body .screenParent"]={"box-shadow":"none !important"};if(!_b(fvdSpeedDial.Prefs.get("sd.display_dial_borders"))){classesColors[".newtabCell .body .screenParent"]["border"]="none !important"}else{classesColors[".newtabCell .body .screenParent"]["border-width"]="1px !important"}classesColors['.newtabCell[type="plus"] .body .preview-image']={background:"none !important"};classesColors["#speedDialContent .newtabCell .body"]={background:"none !important"};classesColors[".newtabCell .menuOverlay .text"]={"margin-right":"5px","margin-left":"5px","margin-bottom":"5px"};classesColors[".newtabCell .speedDialIcons"]={"margin-right":"5px !important"};classesColors[".newtabCell .imgShadow"]={display:"none"};classesColors[".newtabCell .menuOverlay"]={"background-color":"rgba( 62, 125, 179, 0.6 ) !important"};classesColors['#speedDialContent[style="standard"] .newtabCell[type="mostvisited"] .menuOverlay']={left:"-3px",right:"-3px !important",width:"auto",bottom:"7px"};classesColors[".newtabCell .mostVisitedMenu > .views"]={"margin-left":"3px"};classesColors[".newtabCell .mostVisitedMenu > .ingroup"]={"margin-right":"3px"}}if(!_b(fvdSpeedDial.Prefs.get("sd.display_quick_menu_and_clicks"))){classesColors[".newtabCell .speedDialIcons"]={display:"none"};classesColors[".newtabCell .text"]={display:"none"}}for(var si=0;si!=this.stylesheets.length;si++){var stylesheet=this.stylesheets[si];while(stylesheet.cssRules.length>0){stylesheet.deleteRule(0)}for(var selector in classesColors){stylesheet.addRule(selector,"",0);var rule=stylesheet.cssRules[0];var properties=classesColors[selector];for(var properyName in properties){var value=properties[properyName];var important=null;try{if(value.indexOf("!important")!=-1){important="important";value=value.replace("!important","")}}catch(ex){}rule.style.setProperty(properyName,value,important)}}}this.refreshTheme()},_color:function(c){return"#"+c},_size:function(s){return s+"px"},_fontWeight:function(bolder){if(_b(bolder)){return"bold"}return"normal"},_updateThemeActions:function(value){var fancyDefaults=fvdSpeedDial.Prefs._themeDefaults["fancy"];var standardDefaults=fvdSpeedDial.Prefs._themeDefaults["standard"];var prefsToRestore=["sd.text.cell_title.color","sd.text.list_elem.color","sd.text.list_show_url_title.color","sd.text.list_link.color","sd.text.other.color"];if(value=="standard"){if(fvdSpeedDial.Prefs.get("sd.background_color")=="000000"&&_b(fvdSpeedDial.Prefs.get("sd.background_color_enabled"))||fvdSpeedDial.Prefs.get("sd.background_url")==FANCY_BACKGROUND_URL&&fvdSpeedDial.Prefs.get("sd.background_url_type")!="noimage"){if(fvdSpeedDial.Prefs.get("sd.background_url")==FANCY_BACKGROUND_URL){fvdSpeedDial.Prefs.sSet("sd.background_url_type","noimage")}fvdSpeedDial.Prefs.sSet("sd.background_color_enabled",true);fvdSpeedDial.Prefs.sSet("sd.background_color","FFFFFF");prefsToRestore.forEach(function(pref){if(fvdSpeedDial.Prefs.get(pref)==fancyDefaults[pref]){fvdSpeedDial.Prefs.set(pref,standardDefaults[pref])}})}if(!_b(fvdSpeedDial.Prefs.get("sd.display_quick_menu_and_clicks"))){fvdSpeedDial.Prefs.sSet("sd.display_quick_menu_and_clicks",true)}if(!_b(fvdSpeedDial.Prefs.get("sd.show_urls_under_dials"))){fvdSpeedDial.Prefs.sSet("sd.show_urls_under_dials",true)}if(!_b(fvdSpeedDial.Prefs.get("sd.show_icons_and_titles_above_dials"))){fvdSpeedDial.Prefs.sSet("sd.show_icons_and_titles_above_dials",true)}}else if(value=="fancy"){fvdSpeedDial.Prefs.sSet("sd.top_sites_columns","auto");fvdSpeedDial.Prefs.sSet("sd.most_visited_columns","auto");prefsToRestore.forEach(function(pref){if(fvdSpeedDial.Prefs.get(pref)==standardDefaults[pref]){fvdSpeedDial.Prefs.set(pref,fancyDefaults[pref])}});if(!_b(fvdSpeedDial.Prefs.get("sd.display_plus_cells"))){fvdSpeedDial.Prefs.sSet("sd.display_plus_cells",true)}if(_b(fvdSpeedDial.Prefs.get("sd.display_quick_menu_and_clicks"))){fvdSpeedDial.Prefs.sSet("sd.display_quick_menu_and_clicks",false)}if(_b(fvdSpeedDial.Prefs.get("sd.show_urls_under_dials"))){fvdSpeedDial.Prefs.sSet("sd.show_urls_under_dials",false)}if(_b(fvdSpeedDial.Prefs.get("sd.show_icons_and_titles_above_dials"))){fvdSpeedDial.Prefs.sSet("sd.show_icons_and_titles_above_dials",false)}if(fvdSpeedDial.Prefs.get("sd.background_url_type")=="noimage"){var bgUrl=FANCY_BACKGROUND_URL;fvdSpeedDial.Utils.imageUrlToDataUrl(bgUrl,function(dataUrl){if(!dataUrl){dataUrl=""}fvdSpeedDial.Prefs.set("sd.background_url",bgUrl);fvdSpeedDial.Storage.setMisc("sd.background",dataUrl,function(){fvdSpeedDial.Prefs.set("sd.background_url_type",fancyDefaults["sd.background_url_type"]);fvdSpeedDial.SpeedDial.refreshBackground()})})}}fvdSpeedDial.ChromeThemeClient.setPrefsForCurrentAppliedTheme()}};this.CSS=new CSS;function prefListener(name,value){if(name=="sd.display_mode"){setTimeout(function(){fvdSpeedDial.Prefs.set("sd.top_sites_columns","auto");fvdSpeedDial.Prefs.set("sd.most_visited_columns","auto");fvdSpeedDial.CSS._updateThemeActions(value);fvdSpeedDial.CSS.refresh();fvdSpeedDial.CSS.refreshTheme();fvdSpeedDial.SpeedDial.sheduleRebuild();fvdSpeedDial.SpeedDial.refreshBackground()},0)}}Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){prefListener(msg.name,msg.value)}})}).apply(fvdSpeedDial);(function(){this.LiveSearch=new function(){const MIN_LENGTH=3;const URL_TEMPLATE="http://fvdmedia.com/addon_search/?type=instant_search&from=chrome_fvdsd&q=%query%&test=1";var __googlePageLoadedCallback=null;var __loadGoogle=false;var _forceFrameSize=null;function getInput(){return document.getElementById("q")}function getContainer(){return document.getElementById("liveSearchContainer")}function getFrame(){return getContainer().querySelector("iframe")}function resizeListener(){refreshPosWithSuggest()}function refreshPosWithSuggest(){var marginTop=0;var suggest=document.getElementById("suggest");if(suggest&&suggest.style.display!="none"){marginTop=suggest.offsetHeight}document.getElementById("liveSearch").style.marginTop=marginTop+"px";var iframe=document.querySelector("#liveSearch iframe");var currentSpace=window.innerHeight-document.querySelector("#liveSearch").offsetTop;if(_forceFrameSize){var origFrameHeight=_forceFrameSize}else{var origFrameHeight=iframe.contentDocument.body.offsetHeight}var frameHeight=origFrameHeight+70;console.log("Use",frameHeight);if(origFrameHeight>0&&!document.querySelector("#liveSearch .content").hasAttribute("loading")&&frameHeight>0&&frameHeight<currentSpace){document.getElementById("liveSearch").style.marginBottom=currentSpace-frameHeight+"px"}else{document.getElementById("liveSearch").style.marginBottom="0px"}}this.refreshSize=function(){refreshPosWithSuggest()};function show(){var container=getContainer();var query=getInput().value;var frame=getFrame();var newUrl=URL_TEMPLATE.replace("%query%",encodeURIComponent(query));_forceFrameSize=null;if(!__loadGoogle){container.querySelector(".header span").textContent=_("newtab_instant_seach_preview")+" - "+query}else{container.querySelector(".header span").textContent=_("newtab_instant_seach_preview_google")+" - "+query}if(newUrl!=frame.getAttribute("src")){frame.setAttribute("src","");__googlePageLoadedCallback=function(){frame.setAttribute("src",chrome.extension.getURL("/instantsearch.html?q="+encodeURIComponent(query)));__loadGoogle=true;container.querySelector(".header span").textContent=_("newtab_instant_seach_preview_google")+" - "+query};var content=container.querySelector(".content");content.setAttribute("loading",1);frame.style.opacity=0;frame.onload=function(){frame.style.opacity=1;content.removeAttribute("loading");__googlePageLoadedCallback=null};if(__loadGoogle){frame.setAttribute("src",chrome.extension.getURL("/instantsearch.html?q="+encodeURIComponent(query)))}else{frame.setAttribute("src",newUrl)}}if(container.getAttribute("display")==1){return}container.setAttribute("display",1);document.getElementById("searchFormContainer").setAttribute("search",1);refreshPosWithSuggest();window.addEventListener("resize",resizeListener)}function hide(){var container=getContainer();if(container.getAttribute("display")==0){return}container.setAttribute("display",0);document.getElementById("searchFormContainer").removeAttribute("search");window.removeEventListener("resize",resizeListener)}function init(){if(!_b(fvdSpeedDial.Prefs.get("sd.enable_search_preview"))){return}chrome.i18n.getAcceptLanguages(function(languages){if(languages.indexOf("ru")!=-1){return}function _inputListener(event){if(event.keyCode==27){return}setTimeout(function(){if(getInput().value.length>=MIN_LENGTH){show()}else{hide()}},0)}var events=["keyup","input"];events.forEach(function(e){getInput().addEventListener(e,_inputListener,false)});getContainer().querySelector(".header .close").addEventListener("click",function(event){hide()},false);getInput().addEventListener("click",function(event){event.stopPropagation()},false);document.addEventListener("keyup",function(event){if(event.keyCode==27){hide()}},false);document.addEventListener("click",function(event){var liveSearch=getContainer().querySelector("#liveSearch");var p=event.target;while(true){if(p==liveSearch){return}p=p.parentNode;if(!p){break}}hide()},false);getContainer().addEventListener("dblclick",function(event){event.stopPropagation()},false);fvdSpeedDial.AutoComplete.onPopupShow.addListener(function(){refreshPosWithSuggest()});fvdSpeedDial.AutoComplete.onPopupHide.addListener(function(){refreshPosWithSuggest()})})}document.addEventListener("DOMContentLoaded",function(){return;init();chrome.webRequest.onHeadersReceived.addListener(function(data){chrome.tabs.getCurrent(function(tab){if(data.tabId==tab.id){var url=data.url.toLowerCase();if(data.type=="sub_frame"&&(url.indexOf("https://www.google.com")!=-1||url.indexOf("http://www.google.com")!=-1)){if(__googlePageLoadedCallback){__googlePageLoadedCallback()}}}})},{urls:["<all_urls>"]},["responseHeaders"])},false);chrome.extension.onMessage.addListener(function(message,data){if(message.action&&message.action=="setLiveSearchWindowSize"){if(data&&data.tab){chrome.tabs.getCurrent(function(tab){if(tab.id==data.tab.id){_forceFrameSize=message.size;refreshPosWithSuggest();console.log("OK CALLED")}})}}})}}).apply(fvdSpeedDial);(function(){this.PowerOffClient=new function(){var self=this;var powerOffButton=null;var deck=null;var passCodeField=null;var enterPassCodeButton=null;function callback_hiddenChange(){refresh()}function refresh(params){params=params||{};if(typeof params.total=="undefined"){params.total=true}if(self.isHidden()){document.body.setAttribute("poweroff","1");powerOffButton.setAttribute("active","1")}else{document.body.setAttribute("poweroff","0");powerOffButton.setAttribute("active","0")}if(params.total){fvdSpeedDial.SpeedDial.refreshExpandState()}}this.isHidden=function(){return fvdSpeedDial.PowerOff.isHidden()};this.hide=function(){if(!this.isHidden()){fvdSpeedDial.Prefs.set("poweroff.hidden",true)}};this.show=function(password){fvdSpeedDial.Prefs.set("poweroff.hidden",false);if(!fvdSpeedDial.SpeedDial.getExpandState()){fvdSpeedDial.SpeedDial.toggleExpand()}};window.addEventListener("load",function(){function tryEnterPasscode(){var password=passCodeField.value;passCodeField.value="";if(fvdSpeedDial.PowerOff.checkPassword(password)){self.show()}else{fvdSpeedDial.Dialogs.alert(_("newtab_powerof_wrong_passcode_title"),_("newtab_powerof_wrong_passcode_text"))}}powerOffButton=document.querySelector("#searchBar .rightMenu .powerOff");passCodeField=document.getElementById("poweroffPassCode");enterPassCodeButton=document.getElementById("enterPowerOffPassCode");powerOffButton.addEventListener("click",function(){if(fvdSpeedDial.PowerOff.isEnabled()){self.hide()}else{window.open(chrome.extension.getURL("/options.html#poweroff"))}},false);powerOffButton.addEventListener("mouseover",function(){document.querySelector("#speedDialCollapsedContent .collapsedMessagePoweroffForm").setAttribute("notransparency",1)},false);powerOffButton.addEventListener("mouseout",function(){document.querySelector("#speedDialCollapsedContent .collapsedMessagePoweroffForm").removeAttribute("notransparency")},false);passCodeField.addEventListener("click",function(event){event.stopPropagation();event.preventDefault()},false);passCodeField.addEventListener("mousedown",function(event){event.stopPropagation()},false);passCodeField.addEventListener("keypress",function(event){if(event.keyCode==13){tryEnterPasscode()}},false);enterPassCodeButton.addEventListener("click",function(){tryEnterPasscode()},false);enterPassCodeButton.addEventListener("mousedown",function(event){event.stopPropagation()},false);Broadcaster.onMessage.addListener(function(msg){if(msg.action=="poweroff:hiddenchange"){callback_hiddenChange()}else if(msg.action=="poweroff:hide"){self.hide()}});refresh({total:false})},false)}}).apply(fvdSpeedDial);fvdSpeedDial.SpeedDial.Scrolling=new function(){var effectiveMode=null;var self=this;function refresh(params){params=params||{};document.getElementById("cellsContainer").style.height=""}function prefListener(key,value){if(key=="sd.scrolling"||key=="sd.display_mode"){var sdContent=document.getElementById("speedDialContent");sdContent.style.opacity=0;setTimeout(function(){fvdSpeedDial.SpeedDial.sheduleRebuild();refresh();setTimeout(function(){sdContent.style.opacity=1},500)},200)}}this.activeScrollingType=function(){if(fvdSpeedDial.SpeedDial.currentThumbsMode()=="list"){return"vertical"}if(fvdSpeedDial.Prefs.get("sd.display_mode")=="fancy"){return"vertical"}return fvdSpeedDial.Prefs.get("sd.scrolling")};this.refresh=function(){refresh.apply(window,arguments)};document.addEventListener("DOMContentLoaded",function(){refresh();document.addEventListener("mousewheel",function(event){document.body.scrollLeft-=event.wheelDelta*5},false)},false);Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){prefListener(msg.name,msg.value)}})};document.addEventListener("DOMContentLoaded",function(){fvdSpeedDial.PremiumForShare.canDisplay(function(can){if(!can){return}var shareOverlay=document.getElementById("premiumforshareOverflay");var iframe=shareOverlay.querySelector("iframe");shareOverlay.style.display="block";shareOverlay.setAttribute("hidden",1);iframe.setAttribute("src","http://everhelper.me/shareforpremium/");iframe.addEventListener("load",function _frameLoad(){iframe.removeEventListener(_frameLoad);shareOverlay.removeAttribute("hidden");shareOverlay.setAttribute("appear",1)},false);window.addEventListener("message",function(e){if(e.data&&e.data.action=="shareForPremium:close"){shareOverlay.removeAttribute("appear",1);setTimeout(function(){shareOverlay.parentNode.removeChild(shareOverlay)},200);fvdSpeedDial.Prefs.set("premiumforshare.displayed",true)}})})});(function(){fvdSpeedDial.SearchOverlay={autocomplete:null,params:{},show:function(type,params){console.log("show",type,params);this.params=params;this.autocomplete.setSource(type);var overlay=document.querySelector("#searchOverlay");overlay.setAttribute("data-type",type);overlay.style.display="block";setTimeout(function(){overlay.setAttribute("appear",1)},0);var input=document.querySelector("#searchOverlay .searchField input");input.value="";input.focus()},isSearchOpened:function(){var overlay=document.querySelector("#searchOverlay");return overlay.hasAttribute("appear")},hide:function(){var overlay=document.querySelector("#searchOverlay");overlay.style.display="none";overlay.removeAttribute("appear")},doSearch:function(){var query=document.querySelector("#searchOverlayForm .searchField input").value.trim();var url=this.params.url.replace(/{query}/g,encodeURIComponent(query));document.location=url}};document.addEventListener("DOMContentLoaded",function(){document.addEventListener("keydown",function(event){if(event.keyCode==27&&fvdSpeedDial.SearchOverlay.isSearchOpened()){fvdSpeedDial.SearchOverlay.hideSearch()}},false);var overlay=document.querySelector("#searchOverlay");var input=document.querySelector("#searchOverlayForm .searchField input");input.addEventListener("keydown",function(event){if(event.keyCode==13){fvdSpeedDial.SearchOverlay.doSearch();event.preventDefault()}},false);overlay.querySelector(".search-button button").addEventListener("click",function(){fvdSpeedDial.SearchOverlay.doSearch()},false);overlay.addEventListener("click",function(event){if(event.target==overlay){fvdSpeedDial.SearchOverlay.hide()}},false);var autocomplete=new fvdSpeedDial.AutoCompletePlus({input:"#searchOverlayForm .searchField input",form:"#searchOverlayForm"});autocomplete.onClickSuggestion.addListener(function(){fvdSpeedDial.SearchOverlay.doSearch()});fvdSpeedDial.SearchOverlay.autocomplete=autocomplete})})();(function(){function onHiddenCaptureFinished(params,resultData){if(!params.elemId){return}var elem=document.getElementById(params.elemId);var dialData;if(!elem){return}fvdSpeedDial.Utils.Async.chain([function(chainCallback){if(params.type=="speeddial"){fvdSpeedDial.Storage.getDial(params.id,function(dial){dialData=dial;if(dial.title){delete resultData.title}chainCallback()})}else if(params.type=="mostvisited"){fvdSpeedDial.Storage.MostVisited.getById(params.id,params.interval,"host",function(row){fvdSpeedDial.Storage.MostVisited.extendData(row,function(mvData){if(mvData.title){delete resultData.title}chainCallback()})})}},function(){elem.removeAttribute("loadscreen");if(!resultData){return}if(resultData.title){var titleContainer=elem.querySelector(".head span");if(!titleContainer){titleContainer=elem.querySelector(".leftData .text")}if(titleContainer){titleContainer.textContent=resultData.title;elem.removeAttribute("notitle")}elem.setAttribute("title",fvdSpeedDial.SpeedDial.Builder.cellTitle({title:resultData.title,url:dialData.url}))}var screen=elem.querySelector(".body .preview-image");if(screen&&params.saveImage&&resultData.dataUrl){fvdSpeedDial.Utils.setScreenPreview(screen,resultData.dataUrl,true)}else{}}])}Broadcaster.onMessage.addListener(function(msg){if(msg.action=="hiddencapture:done"){onHiddenCaptureFinished(msg.params,msg.result)}});fvdSpeedDial.SpeedDial.ThumbManager={setThumbToElement:function(params){var data=params.data;var elem=params.elem;var screen=elem.querySelector(".body .preview-image");elem.setAttribute("thumb-source-type",data.thumb_source_type);if(data.thumb_source_type=="screen"){if(data.screen_maked!=1){if(data.get_screen_method=="manual"){elem.setAttribute("noscreen",1)}else{this.hiddenCaptureThumb({data:data,type:elem.getAttribute("type"),saveImage:true,resetScreenMaked:false,interval:params.interval,elemId:elem.getAttribute("id"),elem:elem})}}else{if(screen){fvdSpeedDial.Utils.setScreenPreview(screen,data.thumb,params.nocache)}}}else{if(screen){if(data.thumb_source_type=="url"||data.thumb_source_type=="local_file"){fvdSpeedDial.Utils.setUrlPreview({elem:screen,size:params.cellSize},{url:data.thumb,size:{width:data.thumb_width,height:data.thumb_height}},params.nocache)}if(!data.displayTitle){this.hiddenCaptureThumb({data:data,type:elem.getAttribute("type"),saveImage:false,resetScreenMaked:false,interval:params.interval,elemId:elem.getAttribute("id")})}}}},hiddenCaptureThumb:function(params,callback){if(!params.elem&&params.elemId){params.elem=document.getElementById(params.elemId)}if(params.elem){params.elem.setAttribute("loadscreen",1);fvdSpeedDial.Utils.removeScreenPreview(params.elem.querySelector(".preview-image"))}if(params.elem){delete params.elem}chrome.runtime.sendMessage({action:"thumbmanager:hiddenCaptureThumb",params:params,wantResponse:callback?true:false},function(res){if(callback){callback(res)}})}}})();function bindEventHandler(element,eventName,handler){if(element.addEventListener){element.addEventListener(eventName,handler,false)}else if(element.attachEvent){element.attachEvent("on"+eventName,handler)}}function Dialog(options){this.options={width:400,top:120,openOnCreate:true,destroyOnClose:true,escHandler:this.close,enterOnButton:null,buttons:{OK:this.close},leftButtons:{},className:""};for(var option in options){this.options[option]=options[option]}this._makeNodes();if(this.options.openOnCreate){this.open()}}Dialog.prototype={container:null,header:null,body:null,content:null,actions:null,_overlay:null,_wrapper:null,_zIndex:0,_escHandler:null,open:function(){this._makeTop();var ws=this._wrapper.style;ws.left=(document.body.clientWidth-this.options.width)/2+"px";ws.top=(document.body.scrollTop||document.documentElement.scrollTop)+this.options.top+"px";this._overlay.style.display="block";ws.display="block";this._wrapper.focus();this._wrapper.className+=" "+this.options.className;if(this.options.focus){var input=document.getElementById(this.options.focus);if(input){input.focus()}}if(this.options.onShow){this.options.onShow(this)}},close:function(){if(this.options.closeCallback){this.options.closeCallback()}if(this.options.destroyOnClose){this._destroy()}else{this._overlay.style.display="none";this._wrapper.style.display="none"}},addButtons:function(buttons,prepend,specialClasses){var actions=this.actions;var buttonArray=this._makeButtons(buttons,specialClasses);var first=null;if(prepend&&(first=actions.firstChild)!=null){for(var i in buttonArray){actions.insertBefore(buttonArray[i],first)}}else{for(var i in buttonArray){actions.appendChild(buttonArray[i])}}},showActionMessage:function(message){var actionBox=this.actions.getElementsByClassName("dlg-actionbox")[0];actionBox.textContent=message;fvdSpeedDial.Utils.UI.showAndHide(actionBox)},setTitle:function(title){if(!this.header){var header=document.createElement("div");header.className="dialog-header";this.container.insertBefore(header,this.body);this.header=header}this.header.innerHTML=title},getMainButton:function(){return this.container.querySelector("button.main")},_makeNodes:function(){if(this._overlay||this._wrapper){return}this._overlay=document.createElement("div");this._overlay.className="dialog-overlay";document.body.appendChild(this._overlay);var that=this;setTimeout(function(){that._overlay.style.opacity="0.5"},0);if(typeof this.options.title=="string"&&this.options.title!=""){var header=document.createElement("div");header.className="dialog-header";header.innerHTML=this.options.title;this.header=header}var content=document.createElement("div");content.className="dialog-content";content.innerHTML=this.options.content;this.content=content;var actions=document.createElement("div");actions.className="dialog-actions";var buttons=this._makeButtons(this.options.buttons);var leftButtons=this._makeButtons(this.options.leftButtons,"leftButton");buttons=buttons.concat(leftButtons);var first=null;if(buttons.length>0){first=buttons[0];for(var i in buttons){actions.appendChild(buttons[i])}}var actionBox=document.createElement("div");actionBox.className="dlg-actionbox";actions.insertBefore(actionBox,first);this.actions=actions;var body=document.createElement("div");body.className="dialog-body";

body.appendChild(content);body.appendChild(actions);this.body=body;var container=document.createElement("div");container.className="dialog";if(this.header){container.appendChild(header)}container.appendChild(body);this.container=container;var wrapper=document.createElement("div");wrapper.className="dialog-wrapper";var ws=wrapper.style;ws.position="absolute";ws.width=this.options.width+"px";ws.display="none";ws.outline="none";wrapper.appendChild(container);if(this.options.escHandler||this.options.enterOnButton){wrapper.tabIndex=-1;this._onKeydown=this._makeHandler(function(e){if(!e){e=window.event}if(e.keyCode&&e.keyCode==27){if(this.options.escHandler){this.options.escHandler.apply(this)}}else if(e.keyCode&&e.keyCode==13){if(this.options.enterOnButton){this.options.buttons[this.options.enterOnButton]()}}},this);bindEventHandler(wrapper,"keydown",this._onKeydown)}this._wrapper=document.body.appendChild(wrapper);if(Dialog.needIEFix){this._fixIE()}if(this.options.clickCallback){var that=this;this._wrapper.addEventListener("click",function(){that.options.clickCallback()},true)}setTimeout(function(){wrapper.style.webkitTransform="scale(1)";wrapper.style.opacity="1"},0)},_makeButtons:function(buttons,specialClasses){specialClasses=specialClasses||"";var buttonArray=new Array;var countButtons=0;for(var _ in buttons){countButtons++}var btnNum=0;for(var buttonText in buttons){var button=document.createElement("button");button.className="fvdButton dialog-button";bindEventHandler(button,"click",this._makeHandler(buttons[buttonText],this));if(buttonArray.length==0&&countButtons==2&&btnNum==0){button.className+=" main withLoading";button.innerHTML='<span class="text">'+buttonText+'</span><div class="image"></div>'}else{button.innerHTML=buttonText}button.className+=" "+specialClasses;buttonArray.push(button)}return buttonArray},_makeHandler:function(method,obj){return function(e){method.call(obj,e)}},_makeTop:function(){if(this._zIndex<Dialog.Manager.currentZIndex){this._overlay.style.zIndex=Dialog.Manager.newZIndex();this._zIndex=this._wrapper.style.zIndex=Dialog.Manager.newZIndex()}},_fixIE:function(){var width=document.documentElement["scrollWidth"]+"px";var height=document.documentElement["scrollHeight"]+"px";var os=this._overlay.style;os.position="absolute";os.width=width;os.height=height;var iframe=document.createElement("iframe");iframe.className="iefix";iframe.style.width=width;iframe.style.height=height;this._wrapper.appendChild(iframe)},_destroy:function(){this._wrapper.style.opacity=0;this._wrapper.style.webkitTransform="scale(0.9)";this._overlay.style.opacity=0;var that=this;this._wrapper.addEventListener("webkitTransitionEnd",function(event){try{document.body.removeChild(that._wrapper);document.body.removeChild(that._overlay);that.container=null;that.header=null;that.body=null;that.content=null;that.actions=null;that._overlay=null;that._wrapper=null}catch(ex){}},true)}};Dialog.needIEFix=function(){var userAgent=navigator.userAgent.toLowerCase();return/msie/.test(userAgent)&&!/opera/.test(userAgent)&&!window.XMLHttpRequest}();Dialog.Manager={currentZIndex:3e3,newZIndex:function(){return this.currentZIndex}};dhtmlx=function(a){for(var b in a)dhtmlx[b]=a[b];return dhtmlx};dhtmlx.extend_api=function(a,b,c){var d=window[a];if(d)window[a]=function(a){if(a&&typeof a=="object"&&!a.tagName){var c=d.apply(this,b._init?b._init(a):arguments),f;for(f in dhtmlx)if(b[f])this[b[f]](dhtmlx[f]);for(f in a)if(b[f])this[b[f]](a[f]);else f.indexOf("on")==0&&this.attachEvent(f,a[f])}else c=d.apply(this,arguments);b._patch&&b._patch(this);return c||this},window[a].prototype=d.prototype,c&&dhtmlXHeir(window[a].prototype,c)};dhtmlxAjax={get:function(a,b){var c=new dtmlXMLLoaderObject(!0);c.async=arguments.length<3;c.waitCall=b;c.loadXML(a);return c},post:function(a,b,c){var d=new dtmlXMLLoaderObject(!0);d.async=arguments.length<4;d.waitCall=c;d.loadXML(a,!0,b);return d},getSync:function(a){return this.get(a,null,!0)},postSync:function(a,b){return this.post(a,b,null,!0)}};function dtmlXMLLoaderObject(a,b,c,d){this.xmlDoc="";this.async=typeof c!="undefined"?c:!0;this.onloadAction=a||null;this.mainObject=b||null;this.waitCall=null;this.rSeed=d||!1;return this}dtmlXMLLoaderObject.prototype.waitLoadFunction=function(a){var b=!0;return this.check=function(){if(a&&a.onloadAction!=null&&(!a.xmlDoc.readyState||a.xmlDoc.readyState==4)&&b){b=!1;if(typeof a.onloadAction=="function")a.onloadAction(a.mainObject,null,null,null,a);if(a.waitCall)a.waitCall.call(this,a),a.waitCall=null}}};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(a,b){if(this.xmlDoc.responseXML){var c=this.xmlDoc.responseXML.getElementsByTagName(a);c.length==0&&a.indexOf(":")!=-1&&(c=this.xmlDoc.responseXML.getElementsByTagName(a.split(":")[1]));var d=c[0]}else d=this.xmlDoc.documentElement;if(d)return this._retry=!1,d;if(_isIE&&!this._retry){var e=this.xmlDoc.responseText,b=this.xmlDoc;this._retry=!0;this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM");this.xmlDoc.async=!1;this.xmlDoc.loadXML(e);return this.getXMLTopNode(a,b)}dhtmlxError.throwError("LoadXML","Incorrect XML",[b||this.xmlDoc,this.mainObject]);return document.createElement("DIV")};dtmlXMLLoaderObject.prototype.loadXMLString=function(a){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(a);else{var b=new DOMParser;this.xmlDoc=b.parseFromString(a,"text/xml")}if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);if(this.waitCall)this.waitCall(),this.waitCall=null};dtmlXMLLoaderObject.prototype.loadXML=function(a,b,c,d){this.rSeed&&(a+=(a.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=a;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(this.async)this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this);this.xmlDoc.open(b?"POST":"GET",a,this.async);d?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):b&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(c);this.async||new this.waitLoadFunction(this)()};dtmlXMLLoaderObject.prototype.destructor=function(){return this.setXSLParamValue=this.getXMLTopNode=this.xmlNodeToJSON=this.doSerialization=this.loadXMLString=this.loadXML=this.doXSLTransToString=this.doXSLTransToObject=this.doXPathOpera=this.doXPath=this.xmlDoc=this.mainObject=this.onloadAction=this.filePath=this.rSeed=this.async=this._retry=this._getAllNamedChilds=this._filterXPath=null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(a){for(var b={},c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c].value;b._tagvalue=a.firstChild?a.firstChild.nodeValue:"";for(c=0;c<a.childNodes.length;c++){var d=a.childNodes[c].tagName;d&&(b[d]||(b[d]=[]),b[d].push(this.xmlNodeToJSON(a.childNodes[c])))}return b};function callerFunction(a,b){return this.handler=function(c){if(!c)c=window.event;a(c,b);return!0}}function getAbsoluteLeft(a){return getOffset(a).left}function getAbsoluteTop(a){return getOffset(a).top}function getOffsetSum(a){for(var b=0,c=0;a;)b+=parseInt(a.offsetTop),c+=parseInt(a.offsetLeft),a=a.offsetParent;return{top:b,left:c}}function getOffsetRect(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,g=window.pageXOffset||d.scrollLeft||c.scrollLeft,f=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-f,k=b.left+g-h;return{top:Math.round(i),left:Math.round(k)}}function getOffset(a){return a.getBoundingClientRect?getOffsetRect(a):getOffsetSum(a)}function convertStringToBoolean(a){typeof a=="string"&&(a=a.toLowerCase());switch(a){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(a){return a.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop)return window.dhtmlDragAndDrop;this.dragStartObject=this.dragStartNode=this.dragNode=this.lastLanding=0;this.tempDOMM=this.tempDOMU=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if(!((a||window.event)&&(a||event).button==2)){if(window.dhtmlDragAndDrop.waitDrag)return window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1;window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(a);window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=(new Date).valueOf();a&&a.preventDefault&&a.preventDefault();return!1}};dhtmlDragAndDropObject.prototype.callDrag=function(a){if(!a)a=window.event;dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode)if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,a);if(!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else return dragger.stopDrag(a,!0);if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var b=dragger.gldragNode;if(dragger.gldragNode.old)b=dragger.gldragNode.old;b.parentNode.removeChild(b);var c=dragger.dragNode.pWindow;b.pWindow&&b.pWindow.dhtmlDragAndDrop.lastLanding&&b.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(b.pWindow.dhtmlDragAndDrop.lastLanding);if(_isIE){var d=document.createElement("Div");d.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=d.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);c.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=a.clientX+15+(dragger.fx?dragger.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=a.clientY+3+(dragger.fy?dragger.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var e=a.srcElement?a.srcElement:a.target;dragger.checkLanding(e,a)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(a){if(window.name){for(var b=parent.frames[window.name].frameElement.offsetParent,c=0,d=0;b;)c+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;if(parent.dhtmlDragAndDrop){var e=parent.dhtmlDragAndDrop.calculateFramePosition(1);c+=e.split("_")[0]*1;d+=e.split("_")[1]*1}if(a)return c+"_"+d;else this.fx=c;this.fy=d}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(a,b){a&&a.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=a,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,b.clientX,b.clientY,b),this.lastLanding_scr=_isIE?b.srcElement:b.target):a&&a.tagName!="BODY"?this.checkLanding(a.parentNode,b):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,b.clientX,b.clientY,b),this.lastLanding=0,this._onNotFound&&this._onNotFound())};dhtmlDragAndDropObject.prototype.stopDrag=function(a,b){dragger=window.dhtmlDragAndDrop;if(!b){dragger.stopFrameRoute();var c=dragger.lastLanding;dragger.lastLanding=null;c&&c.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,c,_isIE?event.srcElement:a.target)}dragger.lastLanding=null;dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode);dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(a){a&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var b=0;b<window.frames.length;b++)try{window.frames[b]!=a&&window.frames[b].dhtmlDragAndDrop&&window.frames[b].dhtmlDragAndDrop.stopFrameRoute(window)}catch(c){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(d){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(a,b){if(a)window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=a.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=a.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=a.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=a.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&b&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition();try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=a&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(c){}for(var d=0;d<window.frames.length;d++)try{window.frames[d]!=a&&window.frames[d].dhtmlDragAndDrop&&window.frames[d].dhtmlDragAndDrop.initFrameRoute(window,!a||b?1:0)}catch(e){}};_OperaRv=_KHTMLrv=_FFrv=_isChrome=_isMacOS=_isKHTML=_isOpera=_isIE=_isFF=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,navigator.appVersion.indexOf("MSIE 8.0")!=-1&&document.compatMode!="BackCompat"&&(_isIE=8),navigator.appVersion.indexOf("MSIE 9.0")!=-1&&document.compatMode!="BackCompat"&&(_isIE=8)):(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));dtmlXMLLoaderObject.prototype.doXPath=function(a,b,c,d){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(a,b);if(_isIE)return b||(b=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),b||dhtmlxError.throwError("LoadXML","Incorrect XML",[b||this.xmlDoc,this.mainObject]),c!=null&&b.setProperty("SelectionNamespaces","xmlns:xsl='"+c+"'"),d=="single"?b.selectSingleNode(a):b.selectNodes(a)||[];else{var e=b;b||(b=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML);b||dhtmlxError.throwError("LoadXML","Incorrect XML",[b||this.xmlDoc,this.mainObject]);b.nodeName.indexOf("document")!=-1?e=b:(e=b,b=b.ownerDocument);var g=XPathResult.ANY_TYPE;if(d=="single")g=XPathResult.FIRST_ORDERED_NODE_TYPE;var f=[],h=b.evaluate(a,e,function(){return c},g,null);if(g==XPathResult.FIRST_ORDERED_NODE_TYPE)return h.singleNodeValue;for(var i=h.iterateNext();i;)f[f.length]=i,i=h.iterateNext();return f}};function j(){if(!this.catches)this.catches=[];return this}j.prototype.catchError=function(a,b){this.catches[a]=b};j.prototype.throwError=function(a,b,c){if(this.catches[a])return this.catches[a](a,b,c);if(this.catches.ALL)return this.catches.ALL(a,b,c);alert("Error type: "+a+"\nDescription: "+b);return null};window.dhtmlxError=new j;dtmlXMLLoaderObject.prototype.doXPathOpera=function(a,b){var c=a.replace(/[\/]+/gi,"/").split("/"),d=null,e=1;if(!c.length)return[];if(c[0]==".")d=[b];else if(c[0]=="")d=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(c[e].replace(/\[[^\]]*\]/g,"")),e++;else return[];for(;e<c.length;e++)d=this._getAllNamedChilds(d,c[e]);c[e-1].indexOf("[")!=-1&&(d=this._filterXPath(d,c[e-1]));return d};dtmlXMLLoaderObject.prototype._filterXPath=function(a,b){for(var c=[],b=b.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),d=0;d<a.length;d++)a[d].getAttribute(b)&&(c[c.length]=a[d]);return c};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a,b){var c=[];_isKHTML&&(b=b.toUpperCase());for(var d=0;d<a.length;d++)for(var e=0;e<a[d].childNodes.length;e++)_isKHTML?a[d].childNodes[e].tagName&&a[d].childNodes[e].tagName.toUpperCase()==b&&(c[c.length]=a[d].childNodes[e]):a[d].childNodes[e].tagName==b&&(c[c.length]=a[d].childNodes[e]);return c};function dhtmlXHeir(a,b){for(var c in b)typeof b[c]=="function"&&(a[c]=b[c]);return a}function dhtmlxEvent(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(a,b,c){if(!c)c=this.xslDoc;if(c.responseXML)c=c.responseXML;var d=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+a+"']",c,"http://www.w3.org/1999/XSL/Transform","single");if(d!=null)d.firstChild.nodeValue=b};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(a,b){if(!a)a=this.xslDoc;if(a.responseXML)a=a.responseXML;if(!b)b=this.xmlDoc;if(b.responseXML)b=b.responseXML;if(_isIE){d=new ActiveXObject("Msxml2.DOMDocument.3.0");try{b.transformNodeToObject(a,d)}catch(c){d=b.transformNode(a)}}else{if(!this.XSLProcessor)this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(a);var d=this.XSLProcessor.transformToDocument(b)}return d};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(a,b){var c=this.doXSLTransToObject(a,b);return typeof c=="string"?c:this.doSerialization(c)};dtmlXMLLoaderObject.prototype.doSerialization=function(a){if(!a)a=this.xmlDoc;if(a.responseXML)a=a.responseXML;if(_isIE)return a.xml;else{var b=new XMLSerializer;return b.serializeToString(a)}};dhtmlxEventable=function(a){a.attachEvent=function(a,c,d){a="ev_"+a.toLowerCase();this[a]||(this[a]=new this.eventCatcher(d||this));return a+":"+this[a].addEvent(c)};a.callEvent=function(a,c){a="ev_"+a.toLowerCase();return this[a]?this[a].apply(this,c):!0};a.checkEvent=function(a){return!!this["ev_"+a.toLowerCase()]};a.eventCatcher=function(a){var c=[],d=function(){for(var d=!0,g=0;g<c.length;g++)if(c[g]!=null)var f=c[g].apply(a,arguments),d=d&&f;return d};d.addEvent=function(a){typeof a!="function"&&(a=eval(a));return a?c.push(a)-1:!1};d.removeEvent=function(a){c[a]=null};return d};a.detachEvent=function(a){if(a!=!1){var c=a.split(":");this[c[0]].removeEvent(c[1])}};a.detachAllEvents=function(){for(var a in this)a.indexOf("ev_")==0&&delete this[a]}};(function(){var a=dhtmlx.message=function(b,c,d,e){if(!a.area)a.area=document.createElement("DIV"),a.area.style.cssText="position:absolute;right:5px;width:250px;z-index:100;",a.area.className="dhtmlx_message_area",a.area.style[a.defPosition]="5px",document.body.appendChild(a.area);typeof b!="object"&&(b={text:b,type:c,lifetime:d,id:e});b.type=b.type||"info";b.id=b.id||a.uid();b.lifetime=b.lifetime||a.defTimeout;a.hide(b.id);var g=document.createElement("DIV");g.style.cssText="border-radius:4px; padding:4px 4px 4px 20px;background-color:#FFFFCC;font-size:12px;font-family:Tahoma;color:navy;z-index: 10000;margin:5px;border:1px solid lightgrey;";g.innerHTML=b.text;g.className=b.type;a.defPosition=="bottom"&&a.area.firstChild?a.area.insertBefore(g,a.area.firstChild):a.area.appendChild(g);a.timers[b.id]=window.setTimeout(function(){a.hide(b.id)},b.lifetime);a.pull[b.id]=g;return b.id};a.defTimeout=4e3;a.defPosition="top";a.pull={};a.timers={};a.seed=(new Date).valueOf();a.uid=function(){return a.seed++};a.hideAll=function(){for(var b in a.pull)a.hide(b)};a.hide=function(b){var c=a.pull[b];c&&c.parentNode&&(c.parentNode.removeChild(c),window.clearTimeout(a.timers[b]),delete a.pull[b])}})();function dhtmlXMenuObject(b,c){var a=this;this.addBaseIdAsContextZone=null;this.isDhtmlxMenuObject=!0;this.skin=c!=null?c:"dhx_skyblue";this.imagePath="";this._isIE6=!1;if(_isIE)this._isIE6=window.XMLHttpRequest==null?!0:!1;if(b==null)this.base=document.body;else{var d=typeof b=="string"?document.getElementById(b):b;if(d!=null){this.base=d;if(!this.base.id)this.base.id=(new Date).valueOf();for(;this.base.childNodes.length>0;)this.base.removeChild(this.base.childNodes[0]);this.base.className+=" dhtmlxMenu_"+this.skin+"_Middle dir_left";this.base._autoSkinUpdate=!0;if(this.base.oncontextmenu)this.base._oldContextMenuHandler=this.base.oncontextmenu;this.addBaseIdAsContextZone=this.base.id;this.base.onselectstart=function(a){a=a||event;return a.returnValue=!1};this.base.oncontextmenu=function(a){a=a||event;return a.returnValue=!1}}else this.base=document.body}this.topId="dhxWebMenuTopId";if(!this.extendedModule){for(var f=function(){alert(this.i18n.dhxmenuextalert)},e="setItemEnabled,setItemDisabled,isItemEnabled,_changeItemState,getItemText,setItemText,loadFromHTML,hideItem,showItem,isItemHidden,_changeItemVisible,setUserData,getUserData,setOpenMode,setWebModeTimeout,enableDynamicLoading,_updateLoaderIcon,getItemImage,setItemImage,clearItemImage,setAutoShowMode,setAutoHideMode,setContextMenuHideAllMode,getContextMenuHideAllMode,setVisibleArea,setTooltip,getTooltip,setHotKey,getHotKey,setItemSelected,setTopText,setRTL,setAlign,setHref,clearHref,getCircuit,_clearAllSelectedSubItemsInPolygon,_checkArrowsState,_addUpArrow,_addDownArrow,_removeUpArrow,_removeDownArrow,_isArrowExists,_doScrollUp,_doScrollDown,_countPolygonItems,setOverflowHeight,_getRadioImgObj,_setRadioState,_radioOnClickHandler,getRadioChecked,setRadioChecked,addRadioButton,_getCheckboxState,_setCheckboxState,_readLevel,_updateCheckboxImage,_checkboxOnClickHandler,setCheckboxState,getCheckboxState,addCheckbox,serialize".split(","),g=0;g<e.length;g++)this[e[g]]||(this[e[g]]=f);e=null}this.fixedPosition=!1;this.menuLastClicked=this.menuSelected=-1;this.idPrefix="";this.itemTagName="item";this.itemTextTagName="itemtext";this.userDataTagName="userdata";this.itemTipTagName="tooltip";this.itemHotKeyTagName="hotkey";this.itemHrefTagName="href";this.dirTopLevel="bottom";this.dirSubLevel="right";this.menuY2=this.menuY1=this.menuX2=this.menuX1=null;this.menuMode="web";this.menuTimeoutMsec=400;this.menuTimeoutHandler=null;this.idPull={};this.itemPull={};this.userData={};this.radio={};this._rtl=!1;this._align="left";this.menuTouched=!1;this.zInd=this.zIndInit=3001;this.zIndStep=50;this.menuModeTopLevelTimeout=!0;this.menuModeTopLevelTimeoutTime=200;this._topLevelBottomMargin=1;this._topLevelRightMargin=0;this._topLevelOffsetLeft=1;this._arrowFFFix=_isIE?document.compatMode=="BackCompat"?0:-4:-4;this.setSkin=function(a){var b=this.skin;this.skin=a;switch(this.skin){case"dhx_black":case"dhx_blue":case"dhx_skyblue":case"dhx_web":this._topLevelBottomMargin=2;this._topLevelOffsetLeft=this._topLevelRightMargin=1;this._arrowFFFix=_isIE?document.compatMode=="BackCompat"?0:-4:-4;break;case"dhx_web":this._arrowFFFix=0}if(this.base._autoSkinUpdate)this.base.className=this.base.className.replace("dhtmlxMenu_"+b+"_Middle","")+" dhtmlxMenu_"+this.skin+"_Middle";for(var c in this.idPull)this.idPull[c].className=String(this.idPull[c].className).replace(b,this.skin)};this.setSkin(this.skin);this.dLoad=!1;this.dLoadUrl="";this.dLoadSign="?";this.loaderIcon=!1;this.limit=0;this._scrollUpTM=null;this._scrollUpTMTime=20;this._scrollUpTMStep=3;this._scrollDownTM=null;this._scrollDownTMTime=20;this._scrollDownTMStep=3;this.context=!1;this.contextZones={};this.contextMenuZoneId=!1;this.contextHideAllMode=this.contextAutoHide=this.contextAutoShow=!0;this.sxDacProc=null;this.dacSpeed=10;this.dacCycles=[];for(g=0;g<10;g++)this.dacCycles[g]=g;this.dacSpeedIE=10;this.dacCyclesIE=[];for(g=0;g<10;g++)this.dacCyclesIE[g]=g;this._enableDacSupport=function(a){this.sxDacProc=a};this._selectedSubItems=[];this._openedPolygons=[];this._addSubItemToSelected=function(a,b){for(var c=!0,d=0;d<this._selectedSubItems.length;d++)this._selectedSubItems[d][0]==a&&this._selectedSubItems[d][1]==b&&(c=!1);c==!0&&this._selectedSubItems.push([a,b]);return c};this._removeSubItemFromSelected=function(a,b){for(var c=[],d=!1,e=0;e<this._selectedSubItems.length;e++)this._selectedSubItems[e][0]==a&&this._selectedSubItems[e][1]==b?d=!0:c[c.length]=this._selectedSubItems[e];if(d==!0)this._selectedSubItems=c;return d};this._getSubItemToDeselectByPolygon=function(a){for(var b=[],c=0;c<this._selectedSubItems.length;c++)if(this._selectedSubItems[c][1]==a){b[b.length]=this._selectedSubItems[c][0];for(var b=b.concat(this._getSubItemToDeselectByPolygon(this._selectedSubItems[c][0])),d=!0,e=0;e<this._openedPolygons.length;e++)this._openedPolygons[e]==this._selectedSubItems[c][0]&&(d=!1);d==!0&&(this._openedPolygons[this._openedPolygons.length]=this._selectedSubItems[c][0]);this._selectedSubItems[c][0]=-1;this._selectedSubItems[c][1]=-1}return b};this._hidePolygon=function(a){if(this.idPull["polygon_"+a]!=null)if(this.sxDacProc!=null&&this.idPull["sxDac_"+a]!=null)this.idPull["sxDac_"+a]._hide();else if(this.idPull["polygon_"+a].style.display!="none"){this.idPull["polygon_"+a].style.display="none";if(this.idPull["arrowup_"+a]!=null)this.idPull["arrowup_"+a].style.display="none";if(this.idPull["arrowdown_"+a]!=null)this.idPull["arrowdown_"+a].style.display="none";this._updateItemComplexState(a,!0,!1);if(this._isIE6&&this.idPull["polygon_"+a+"_ie6cover"]!=null)this.idPull["polygon_"+a+"_ie6cover"].style.display="none";a=String(a).replace(this.idPrefix,"");a==this.topId&&(a=null);this.callEvent("onHide",[a])}};this._showPolygon=function(a,b){var c=this._countVisiblePolygonItems(a);if(c!=0){var d="polygon_"+a;if(this.idPull[d]!=null&&this.idPull[a]!=null&&(!this.menuModeTopLevelTimeout||this.menuMode!="web"||this.context||this.idPull[a]._mouseOver||b!=this.dirTopLevel)){this.fixedPosition||this._autoDetectVisibleArea();var e=0,g=0,f=null,i=null;if(this.limit>0&&this.limit<c){var n="arrowup_"+a,D="arrowdown_"+a;this.idPull["arrowup_"+a]==null&&this._addUpArrow(String(a).replace(this.idPrefix,""));this.idPull["arrowdown_"+a]==null&&this._addDownArrow(String(a).replace(this.idPrefix,""));f=this.idPull["arrowup_"+a];f.style.visibility="hidden";f.style.display="";f.style.zIndex=this.zInd;e=f.offsetHeight;i=this.idPull["arrowdown_"+a];i.style.visibility="hidden";i.style.display="";i.style.zIndex=this.zInd;g=i.offsetHeight}this.idPull[d].style.visibility="hidden";this.idPull[d].style.left="0px";this.idPull[d].style.top="0px";this.idPull[d].style.display="";this.idPull[d].style.zIndex=this.zInd;if(this.limit>0)this.limit<c?(this.idPull[d].style.height=24*this.limit+"px",this.idPull[d].scrollTop=0):this.idPull[d].style.height="";this.zInd+=this.zIndStep;if(this.itemPull[a]!=null)var C="polygon_"+this.itemPull[a].parent;else this.context&&(C=this.idPull[this.idPrefix+this.topId]);var q=this.idPull[a].tagName!=null?getAbsoluteLeft(this.idPull[a]):this.idPull[a][0],t=this.idPull[a].tagName!=null?getAbsoluteTop(this.idPull[a]):this.idPull[a][1],u=this.idPull[a].tagName!=null?this.idPull[a].offsetWidth:0,B=this.idPull[a].tagName!=null?this.idPull[a].offsetHeight+e+g:0,l=0,o=0,s=this.idPull[d].offsetWidth,x=this.idPull[d].offsetHeight;b=="bottom"&&(l=this._rtl?q+(u!=null?u:0)-s:this._align=="right"?q+u-s:q-1+(b==this.dirTopLevel?this._topLevelRightMargin:0),o=t-1+B-e-g+this._topLevelBottomMargin);b=="right"&&(l=q+u-1,o=t+2);b=="left"&&(l=q-this.idPull[d].offsetWidth+2,o=t+2);b=="top"&&(l=q-1,o=t-x+2);if(this.fixedPosition)var v=65536,y=65536;else if(v=this.menuX2!=null?this.menuX2:0,y=this.menuY2!=null?this.menuY2:0,v==0)window.innerWidth?(v=window.innerWidth,y=window.innerHeight):(v=document.body.offsetWidth,y=document.body.scrollHeight);l+s>v&&!this._rtl&&(l=q-s+2);l<this.menuX1&&this._rtl&&(l=q+u-2);l<0&&(l=0);o+x>y&&this.menuY2!=null&&(o=Math.max(t+B-x+2,2),this.itemPull[a]!=null&&!this.context&&this.itemPull[a].parent==this.idPrefix+this.topId&&(o-=this.base.offsetHeight));this.idPull[d].style.left=l+"px";this.idPull[d].style.top=o+e+"px";if(this.sxDacProc!=null&&this.idPull["sxDac_"+a]!=null)this.idPull["sxDac_"+a]._show();else{this.idPull[d].style.visibility="";if(this.limit>0&&this.limit<c)f.style.left=l+"px",f.style.top=o+"px",f.style.width=s+this._arrowFFFix+"px",f.style.visibility="",i.style.left=l+"px",i.style.top=o+e+x+"px",i.style.width=s+this._arrowFFFix+"px",i.style.visibility="",this._checkArrowsState(a);if(this._isIE6){var r=d+"_ie6cover";if(this.idPull[r]==null){var w=document.createElement("IFRAME");w.className="dhtmlxMenu_IE6CoverFix_"+this.skin;w.frameBorder=0;w.setAttribute("src","javascript:false;");document.body.insertBefore(w,document.body.firstChild);this.idPull[r]=w}this.idPull[r].style.left=this.idPull[d].style.left;this.idPull[r].style.top=this.idPull[d].style.top;this.idPull[r].style.width=this.idPull[d].offsetWidth+"px";this.idPull[r].style.height=this.idPull[d].offsetHeight+"px";this.idPull[r].style.zIndex=this.idPull[d].style.zIndex-1;this.idPull[r].style.display=""}a=String(a).replace(this.idPrefix,"");a==this.topId&&(a=null);this.callEvent("onShow",[a])}}}};this._redistribSubLevelSelection=function(a,b){for(;this._openedPolygons.length>0;)this._openedPolygons.pop();var c=this._getSubItemToDeselectByPolygon(b);this._removeSubItemFromSelected(-1,-1);for(var d=0;d<c.length;d++)if(this.idPull[c[d]]!=null&&c[d]!=a&&this.itemPull[c[d]].state=="enabled")this.idPull[c[d]].className="sub_item";for(d=0;d<this._openedPolygons.length;d++)this._openedPolygons[d]!=b&&this._hidePolygon(this._openedPolygons[d]);if(this.itemPull[a].state=="enabled"){this.idPull[a].className="sub_item_selected";if(this.itemPull[a].complex&&this.dLoad&&this.itemPull[a].loaded=="no"){this.loaderIcon==!0&&this._updateLoaderIcon(a,!0);var e=new dtmlXMLLoaderObject(this._xmlParser,window);this.itemPull[a].loaded="get";this.callEvent("onXLS",[]);e.loadXML(this.dLoadUrl+this.dLoadSign+"action=loadMenu&parentId="+a.replace(this.idPrefix,"")+"&etc="+(new Date).getTime())}if((this.itemPull[a].complex||this.dLoad&&this.itemPull[a].loaded=="yes")&&this.itemPull[a].complex&&this.idPull["polygon_"+a]!=null)this._updateItemComplexState(a,!0,!0),this._showPolygon(a,this.dirSubLevel);this._addSubItemToSelected(a,b);this.menuSelected=a}};this._doOnClick=function(a,b,c){this.menuLastClicked=a;if(this.itemPull[this.idPrefix+a].href_link!=null&&this.itemPull[this.idPrefix+a].state=="enabled"){var d=document.createElement("FORM"),e=String(this.itemPull[this.idPrefix+a].href_link).split("?");d.action=e[0];if(e[1]!=null)for(var f=String(e[1]).split("&"),g=0;g<f.length;g++){var i=String(f[g]).split("="),n=document.createElement("INPUT");n.type="hidden";n.name=i[0]||"";n.value=i[1]||"";d.appendChild(n)}if(this.itemPull[this.idPrefix+a].href_target!=null)d.target=this.itemPull[this.idPrefix+a].href_target;d.style.display="none";document.body.appendChild(d);d.submit();d!=null&&(document.body.removeChild(d),d=null)}else b.charAt(0)!="c"&&b.charAt(1)!="d"&&b.charAt(2)!="s"&&(this.checkEvent("onClick")?(this._clearAndHide(),this._isContextMenuVisible()&&this.contextAutoHide&&this._hideContextMenu(),this.callEvent("onClick",[a,this.contextMenuZoneId,c])):b.charAt(1)=="d"||this.menuMode=="win"&&b.charAt(2)=="t"||(this._clearAndHide(),this._isContextMenuVisible()&&this.contextAutoHide&&this._hideContextMenu()))};this._doOnTouchMenu=function(a){if(this.menuTouched==!1)this.menuTouched=!0,this.checkEvent("onTouch")&&this.callEvent("onTouch",[a])};this._searchMenuNode=function(a,b){for(var c=[],d=0;d<b.length;d++)if(typeof b[d]=="object"){
b[d].length==5&&typeof b[d][0]!="object"&&b[d][0].replace(this.idPrefix,"")==a&&d==0&&(c=b);var e=this._searchMenuNode(a,b[d]);e.length>0&&(c=e)}return c};this._getMenuNodes=function(a){var b=[],c;for(c in this.itemPull)this.itemPull[c].parent==a&&(b[b.length]=c);return b};this._genStr=function(a){for(var b="",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",d=0;d<a;d++)b+=c.charAt(Math.round(Math.random()*(c.length-1)));return b};this.getItemType=function(a){a=this.idPrefix+a;return this.itemPull[a]==null?null:this.itemPull[a].type};this.forEachItem=function(a){for(var b in this.itemPull)a(String(b).replace(this.idPrefix,""))};this._clearAndHide=function(){a.menuSelected=-1;for(a.menuLastClicked=-1;a._openedPolygons.length>0;)a._openedPolygons.pop();for(var b=0;b<a._selectedSubItems.length;b++){var c=a._selectedSubItems[b][0];if(a.idPull[c]!=null&&a.itemPull[c].state=="enabled"){if(a.idPull[c].className=="sub_item_selected")a.idPull[c].className="sub_item";if(a.idPull[c].className=="dhtmlxMenu_"+a.skin+"_TopLevel_Item_Selected")a.idPull[c].className=a.itemPull[c].cssNormal!=null?a.itemPull[c].cssNormal:"dhtmlxMenu_"+a.skin+"_TopLevel_Item_Normal"}a._hidePolygon(c)}a.menuTouched=!1;if(a.context)a.contextHideAllMode?(a._hidePolygon(a.idPrefix+a.topId),a.zInd=a.zIndInit):a.zInd=a.zIndInit+a.zIndStep};this._doOnLoad=function(){};this.loadXML=function(a,b){if(b)this._doOnLoad=function(){b()};this.callEvent("onXLS",[]);this._xmlLoader.loadXML(a)};this.loadXMLString=function(a,b){if(b)this._doOnLoad=function(){b()};this._xmlLoader.loadXMLString(a)};this._buildMenu=function(a,b){for(var c=0,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==this.itemTagName){var e=a.childNodes[d],f={};f.id=this.idPrefix+(e.getAttribute("id")||this._genStr(24));f.title=e.getAttribute("text")||"";f.imgen=e.getAttribute("img")||"";f.imgdis=e.getAttribute("imgdis")||"";f.tip="";f.hotkey="";e.getAttribute("cssNormal")!=null&&(f.cssNormal=e.getAttribute("cssNormal"));f.type=e.getAttribute("type")||"item";if(f.type=="checkbox")f.checked=e.getAttribute("checked")!=null,f.imgen="chbx_"+(f.checked?"1":"0"),f.imgdis=f.imgen;if(f.type=="radio")f.checked=e.getAttribute("checked")!=null,f.imgen="rdbt_"+(f.checked?"1":"0"),f.imgdis=f.imgen,f.group=e.getAttribute("group")||this._genStr(24),this.radio[f.group]==null&&(this.radio[f.group]=[]),this.radio[f.group][this.radio[f.group].length]=f.id;f.state=e.getAttribute("enabled")!=null||e.getAttribute("disabled")!=null?e.getAttribute("enabled")=="false"||e.getAttribute("disabled")=="true"?"disabled":"enabled":"enabled";f.parent=b!=null?b:this.idPrefix+this.topId;f.complex=this.dLoad?e.getAttribute("complex")!=null?!0:!1:this._buildMenu(e,f.id)>0;this.dLoad&&f.complex&&(f.loaded="no");this.itemPull[f.id]=f;for(var g=0;g<e.childNodes.length;g++){var i=e.childNodes[g].tagName;i!=null&&(i=i.toLowerCase());if(i==this.userDataTagName){var n=e.childNodes[g];n.getAttribute("name")!=null&&(this.userData[f.id+"_"+n.getAttribute("name")]=n.firstChild.nodeValue!=null?n.firstChild.nodeValue:"")}if(i==this.itemTextTagName)f.title=e.childNodes[g].firstChild.nodeValue;if(i==this.itemTipTagName)f.tip=e.childNodes[g].firstChild.nodeValue;if(i==this.itemHotKeyTagName)f.hotkey=e.childNodes[g].firstChild.nodeValue;if(i==this.itemHrefTagName&&f.type=="item")f.href_link=e.childNodes[g].firstChild.nodeValue,e.childNodes[g].getAttribute("target")!=null&&(f.href_target=e.childNodes[g].getAttribute("target"))}c++}return c};this._xmlParser=function(){if(a.dLoad){var b=this.getXMLTopNode("menu");parentId=b.getAttribute("parentId")!=null?b.getAttribute("parentId"):null;if(parentId==null)a._buildMenu(b,null),a._initTopLevelMenu();else{a._buildMenu(b,a.idPrefix+parentId);a._addSubMenuPolygon(a.idPrefix+parentId,a.idPrefix+parentId);if(a.menuSelected==a.idPrefix+parentId){var c=a.idPrefix+parentId,d=a.itemPull[a.idPrefix+parentId].parent==a.idPrefix+a.topId,e=d&&!a.context?a.dirTopLevel:a.dirSubLevel,f=!1;if(d&&a.menuModeTopLevelTimeout&&a.menuMode=="web"&&!a.context){var g=a.idPull[a.idPrefix+parentId];if(g._mouseOver==!0){var p=a.menuModeTopLevelTimeoutTime-((new Date).getTime()-g._dynLoadTM);if(p>1)g._menuOpenTM=window.setTimeout(function(){a._showPolygon(c,e)},p),f=!0}}f||a._showPolygon(c,e)}a.itemPull[a.idPrefix+parentId].loaded="yes";a.loaderIcon==!0&&a._updateLoaderIcon(a.idPrefix+parentId,!1)}this.destructor();a.callEvent("onXLE",[])}else b=this.getXMLTopNode("menu"),a._buildMenu(b,null),a.init(),a.callEvent("onXLE",[]),a._doOnLoad()};this._xmlLoader=new dtmlXMLLoaderObject(this._xmlParser,window);this._showSubLevelItem=function(a,b){if(document.getElementById("arrow_"+this.idPrefix+a)!=null)document.getElementById("arrow_"+this.idPrefix+a).style.display=b?"none":"";if(document.getElementById("image_"+this.idPrefix+a)!=null)document.getElementById("image_"+this.idPrefix+a).style.display=b?"none":"";if(document.getElementById(this.idPrefix+a)!=null)document.getElementById(this.idPrefix+a).style.display=b?"":"none"};this._hideSubLevelItem=function(a){this._showSubLevelItem(a,!0)};this.idPrefix=this._genStr(12);this._bodyClick=function(b){b=b||event;b.button==2||_isOpera&&b.ctrlKey==!0||(a.context?a.contextAutoHide&&(!_isOpera||a._isContextMenuVisible()&&_isOpera)&&a._hideContextMenu():a._clearAndHide())};this._bodyContext=function(b){var b=b||event,c=(b.srcElement||b.target).className;if(!(c.search("dhtmlxMenu")!=-1&&c.search("SubLevelArea")!=-1)){var d=!0,e=b.target||b.srcElement;e.id!=null&&a.isContextZone(e.id)&&(d=!1);e==document.body&&(d=!1);d&&a.hideContextMenu()}};_isIE?(document.body.attachEvent("onclick",this._bodyClick),document.body.attachEvent("oncontextmenu",this._bodyContext)):(window.addEventListener("click",this._bodyClick,!1),window.addEventListener("contextmenu",this._bodyContext,!1));this._UID=this._genStr(32);dhtmlxMenuObjectLiveInstances[this._UID]=this;dhtmlxEventable(this);return this}dhtmlXMenuObject.prototype.init=function(){if(this._isInited!=!0)this.dLoad?(this.callEvent("onXLS",[]),this._xmlLoader.loadXML(this.dLoadUrl+this.dLoadSign+"action=loadMenu&etc="+(new Date).getTime())):(this._initTopLevelMenu(),this._isInited=!0)};dhtmlXMenuObject.prototype._countVisiblePolygonItems=function(b){var c=0,a;for(a in this.itemPull){var d=this.itemPull[a].parent,f=this.itemPull[a].type;this.idPull[a]!=null&&d==b&&(f=="item"||f=="radio"||f=="checkbox")&&this.idPull[a].style.display!="none"&&c++}return c};dhtmlXMenuObject.prototype._redefineComplexState=function(b){if(this.idPrefix+this.topId!=b&&this.idPull["polygon_"+b]!=null&&this.idPull[b]!=null){var c=this._countVisiblePolygonItems(b);c>0&&!this.itemPull[b].complex&&this._updateItemComplexState(b,!0,!1);c==0&&this.itemPull[b].complex&&this._updateItemComplexState(b,!1,!1)}};dhtmlXMenuObject.prototype._updateItemComplexState=function(b,c){if(!this.context&&this._getItemLevelType(b.replace(this.idPrefix,""))=="TopLevel")this.itemPull[b].complex=c;else if(!(this.idPull[b]==null||this.itemPull[b]==null))if(this.itemPull[b].complex=c,b!=this.idPrefix+this.topId){var a=null,d=this.idPull[b].childNodes[this._rtl?0:2];d.childNodes[0]&&String(d.childNodes[0].className).search("complex_arrow")===0&&(a=d.childNodes[0]);if(this.itemPull[b].complex){if(a==null){a=document.createElement("DIV");a.className="complex_arrow";for(a.id="arrow_"+b;d.childNodes.length>0;)d.removeChild(d.childNodes[0]);d.appendChild(a)}if(this.dLoad&&this.itemPull[b].loaded=="get"&&this.loaderIcon){if(a.className!="complex_arrow_loading")a.className="complex_arrow_loading"}else a.className="complex_arrow"}else!this.itemPull[b].complex&&a!=null&&(d.removeChild(a),this.itemPull[b].hotkey_backup!=null&&this.setHotKey&&this.setHotKey(b.replace(this.idPrefix,""),this.itemPull[b].hotkey_backup))}};dhtmlXMenuObject.prototype._getItemLevelType=function(b){return this.itemPull[this.idPrefix+b].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea"};dhtmlXMenuObject.prototype._redistribTopLevelSelection=function(b){var c=this._getSubItemToDeselectByPolygon("parent");this._removeSubItemFromSelected(-1,-1);for(var a=0;a<c.length;a++)if(c[a]!=b&&this._hidePolygon(c[a]),this.idPull[c[a]]!=null&&c[a]!=b)this.idPull[c[a]].className=this.idPull[c[a]].className.replace(/Selected/g,"Normal");if(this.itemPull[this.idPrefix+b].state=="enabled")this.idPull[this.idPrefix+b].className="dhtmlxMenu_"+this.skin+"_TopLevel_Item_Selected",this._addSubItemToSelected(this.idPrefix+b,"parent"),this.menuSelected=this.menuMode=="win"?this.menuSelected!=-1?b:this.menuSelected:b,this.itemPull[this.idPrefix+b].complex&&this.menuSelected!=-1&&this._showPolygon(this.idPrefix+b,this.dirTopLevel)};dhtmlXMenuObject.prototype._initTopLevelMenu=function(){this.dirTopLevel="bottom";this.dirSubLevel=this._rtl?"left":"right";if(this.context)this.idPull[this.idPrefix+this.topId]=[0,0],this._addSubMenuPolygon(this.idPrefix+this.topId,this.idPrefix+this.topId);else for(var b=this._getMenuNodes(this.idPrefix+this.topId),c=0;c<b.length;c++)this.itemPull[b[c]].type=="item"&&this._renderToplevelItem(b[c],null),this.itemPull[b[c]].type=="separator"&&this._renderSeparator(b[c],null)};dhtmlXMenuObject.prototype._renderToplevelItem=function(b,c){var a=this,d=document.createElement("DIV");d.id=b;d.className=this.itemPull[b].state=="enabled"&&this.itemPull[b].cssNormal!=null?this.itemPull[b].cssNormal:"dhtmlxMenu_"+this.skin+"_TopLevel_Item_"+(this.itemPull[b].state=="enabled"?"Normal":"Disabled");if(this.itemPull[b].title!=""){var f=document.createElement("DIV");f.className="top_level_text";f.innerHTML=this.itemPull[b].title;d.appendChild(f)}if(this.itemPull[b].tip.length>0)d.title=this.itemPull[b].tip;if(this.itemPull[b].imgen!=""||this.itemPull[b].imgdis!=""){var e=this.itemPull[b][this.itemPull[b].state=="enabled"?"imgen":"imgdis"];if(e){var g=document.createElement("IMG");g.border="0";g.id="image_"+b;g.src=this.imagePath+e;g.className="dhtmlxMenu_TopLevel_Item_Icon";d.childNodes.length>0&&!this._rtl?d.insertBefore(g,d.childNodes[0]):d.appendChild(g)}}d.onselectstart=function(a){a=a||event;return a.returnValue=!1};d.oncontextmenu=function(a){a=a||event;return a.returnValue=!1};if(!this.cont)this.cont=document.createElement("DIV"),this.cont.dir="ltr",this.cont.className=this._align=="right"?"align_right":"align_left",this.base.appendChild(this.cont);c!=null&&(c++,c<0&&(c=0),c>this.cont.childNodes.length-1&&(c=null));c!=null?this.cont.insertBefore(d,this.cont.childNodes[c]):this.cont.appendChild(d);this.idPull[d.id]=d;this.itemPull[b].complex&&!this.dLoad&&this._addSubMenuPolygon(this.itemPull[b].id,this.itemPull[b].id);d.onmouseover=function(){a.menuMode=="web"&&window.clearTimeout(a.menuTimeoutHandler);var b=a._getSubItemToDeselectByPolygon("parent");a._removeSubItemFromSelected(-1,-1);for(var c=0;c<b.length;c++)if(b[c]!=this.id&&a._hidePolygon(b[c]),a.idPull[b[c]]!=null&&b[c]!=this.id)if(a.itemPull[b[c]].cssNormal!=null)a.idPull[b[c]].className=a.itemPull[b[c]].cssNormal;else{if(a.idPull[b[c]].className=="sub_item_selected")a.idPull[b[c]].className="sub_item";a.idPull[b[c]].className=a.idPull[b[c]].className.replace(/Selected/g,"Normal")}if(a.itemPull[this.id].state=="enabled"){this.className="dhtmlxMenu_"+a.skin+"_TopLevel_Item_Selected";a._addSubItemToSelected(this.id,"parent");a.menuSelected=a.menuMode=="win"?a.menuSelected!=-1?this.id:a.menuSelected:this.id;if(a.dLoad&&a.itemPull[this.id].loaded=="no"){if(a.menuModeTopLevelTimeout&&a.menuMode=="web"&&!a.context)this._mouseOver=!0,this._dynLoadTM=(new Date).getTime();var d=new dtmlXMLLoaderObject(a._xmlParser,window);a.itemPull[this.id].loaded="get";a.callEvent("onXLS",[]);d.loadXML(a.dLoadUrl+a.dLoadSign+"action=loadMenu&parentId="+this.id.replace(a.idPrefix,"")+"&etc="+(new Date).getTime())}if((!a.dLoad||a.dLoad&&(!a.itemPull[this.id].loaded||a.itemPull[this.id].loaded=="yes"))&&a.itemPull[this.id].complex&&a.menuSelected!=-1)if(a.menuModeTopLevelTimeout&&a.menuMode=="web"&&!a.context){this._mouseOver=!0;var e=this.id;this._menuOpenTM=window.setTimeout(function(){a._showPolygon(e,a.dirTopLevel)},a.menuModeTopLevelTimeoutTime)}else a._showPolygon(this.id,a.dirTopLevel)}a._doOnTouchMenu(this.id.replace(a.idPrefix,""))};d.onmouseout=function(){if(!(a.itemPull[this.id].complex&&a.menuSelected!=-1)&&a.itemPull[this.id].state=="enabled")d.className=a.itemPull[this.id].cssNormal!=null?a.itemPull[this.id].cssNormal:"dhtmlxMenu_"+a.skin+"_TopLevel_Item_Normal";if(a.menuMode=="web")window.clearTimeout(a.menuTimeoutHandler),a.menuTimeoutHandler=window.setTimeout(function(){a._clearAndHide()},a.menuTimeoutMsec,"JavaScript");if(a.menuModeTopLevelTimeout&&a.menuMode=="web"&&!a.context)this._mouseOver=!1,window.clearTimeout(this._menuOpenTM)};d.onclick=function(b){a.menuMode=="web"&&window.clearTimeout(a.menuTimeoutHandler);if(!(a.menuMode!="web"&&a.itemPull[this.id].state=="disabled")){b=b||event;b.cancelBubble=!0;b.returnValue=!1;if(a.menuMode=="win"&&a.itemPull[this.id].complex){if(a.menuSelected==this.id){a.menuSelected=-1;var c=!1}else a.menuSelected=this.id,c=!0;c?a._showPolygon(this.id,a.dirTopLevel):a._hidePolygon(this.id)}var d=a.itemPull[this.id].complex?"c":"-",e=a.itemPull[this.id].state!="enabled"?"d":"-",f={ctrl:b.ctrlKey,alt:b.altKey,shift:b.shiftKey};a._doOnClick(this.id.replace(a.idPrefix,""),d+e+"t",f);return!1}}};dhtmlXMenuObject.prototype.setImagePath=function(){};dhtmlXMenuObject.prototype.setIconsPath=function(b){this.imagePath=b};dhtmlXMenuObject.prototype.setIconPath=dhtmlXMenuObject.prototype.setIconsPath;dhtmlXMenuObject.prototype._updateItemImage=function(b){var b=this.idPrefix+b,c=this.itemPull[b].parent==this.idPrefix+this.topId&&!this.context,a=null;if(c)for(var d=0;d<this.idPull[b].childNodes.length;d++)try{this.idPull[b].childNodes[d].className=="dhtmlxMenu_TopLevel_Item_Icon"&&(a=this.idPull[b].childNodes[d])}catch(f){}else try{a=this.idPull[b].childNodes[this._rtl?2:0].childNodes[0]}catch(e){}var g=this.itemPull[b].type=="radio"?this.itemPull[b][this.itemPull[b].state=="enabled"?"imgen":"imgdis"]:this.itemPull[b][this.itemPull[b].state=="enabled"?"imgen":"imgdis"];if(g.length>0)if(a!=null)a.src=this.imagePath+g;else if(c)a=document.createElement("IMG"),a.className="dhtmlxMenu_TopLevel_Item_Icon",a.src=this.imagePath+g,a.border="0",a.id="image_"+b,!this._rtl&&this.idPull[b].childNodes.length>0?this.idPull[b].insertBefore(a,this.idPull[b].childNodes[0]):this.idPull[b].appendChild(a);else{a=document.createElement("IMG");a.className="sub_icon";a.src=this.imagePath+g;a.border="0";a.id="image_"+b;for(var h=this.idPull[b].childNodes[this._rtl?2:0];h.childNodes.length>0;)h.removeChild(h.childNodes[0]);h.appendChild(a)}else a!=null&&a.parentNode.removeChild(a)};dhtmlXMenuObject.prototype.removeItem=function(b,c,a){c||(b=this.idPrefix+b);var d=null;if(b!=this.idPrefix+this.topId){if(this.itemPull[b]==null)return;var f=this.itemPull[b].type;if(f=="separator"){var e=this.idPull["separator_"+b];this.itemPull[b].parent==this.idPrefix+this.topId?(e.onclick=null,e.onselectstart=null,e.id=null):(e.childNodes[0].childNodes[0].onclick=null,e.childNodes[0].childNodes[0].onselectstart=null,e.childNodes[0].childNodes[0].id=null,e.childNodes[0].removeChild(e.childNodes[0].childNodes[0]),e.removeChild(e.childNodes[0]));e.parentNode.removeChild(e);this.idPull["separator_"+b]=null;this.itemPull[b]=null;delete this.idPull["separator_"+b]}else{d=this.itemPull[b].parent;e=this.idPull[b];e.onclick=null;e.oncontextmenu=null;e.onmouseover=null;e.onmouseout=null;e.onselectstart=null;for(e.id=null;e.childNodes.length>0;)e.removeChild(e.childNodes[0]);e.parentNode.removeChild(e);this.idPull[b]=null;this.itemPull[b]=null;delete this.idPull[b]}delete this.itemPull[b];f=e=null}for(var g in this.itemPull)this.itemPull[g].parent==b&&this.removeItem(g,!0,!0);var h=Array(b);d!=null&&!a&&this.idPull["polygon_"+d]!=null&&this.idPull["polygon_"+d].tbd.childNodes.length==0&&(h.push(d),this._updateItemComplexState(d,!1,!1));for(var j=0;j<h.length;j++)if(this.idPull["polygon_"+h[j]]){var k=this.idPull["polygon_"+h[j]];k.onclick=null;k.oncontextmenu=null;k.tbl.removeChild(k.tbd);k.tbd=null;k.removeChild(k.tbl);k.tbl=null;k.id=null;k.parentNode.removeChild(k);k=null;if(this._isIE6){var m="polygon_"+h[j]+"_ie6cover";this.idPull[m]!=null&&(document.body.removeChild(this.idPull[m]),delete this.idPull[m])}this.idPull["arrowup_"+b]!=null&&this._removeArrow&&this._removeArrow("arrowup_"+b);this.idPull["arrowdown_"+b]!=null&&this._removeArrow&&this._removeArrow("arrowdown_"+b);this.idPull["polygon_"+h[j]]=null;delete this.idPull["polygon_"+h[j]]}h=null};dhtmlXMenuObject.prototype._getAllParents=function(b){var c=[],a;for(a in this.itemPull)if(this.itemPull[a].parent==b&&(c[c.length]=this.itemPull[a].id,this.itemPull[a].complex))for(var d=this._getAllParents(this.itemPull[a].id),f=0;f<d.length;f++)c[c.length]=d[f];return c};dhtmlXMenuObject.prototype.renderAsContextMenu=function(){this.context=!0;if(this.base._autoSkinUpdate==!0)this.base.className=this.base.className.replace("dhtmlxMenu_"+this.skin+"_Middle",""),this.base._autoSkinUpdate=!1;this.addBaseIdAsContextZone!=null&&this.addContextZone(this.addBaseIdAsContextZone)};dhtmlXMenuObject.prototype.addContextZone=function(b){if(typeof b=="string"){c=document.getElementById(b)}else{c=b;if(b==document.body){b="document.body"}else{b=c.id}}this.contextZones[b]=c;var f=this;if(_isOpera)this.operaContext=function(a){f._doOnContextMenuOpera(a,f)},c.addEventListener("mouseup",this.operaContext,!1);else{if(c.oncontextmenu!=null&&!c._oldContextMenuHandler)c._oldContextMenuHandler=c.oncontextmenu;c.oncontextmenu=function(a){if(a.target.tagName=="INPUT"||a.target.tagName=="textarea"){return}for(var b in dhtmlxMenuObjectLiveInstances)b!=f._UID&&dhtmlxMenuObjectLiveInstances[b].context&&dhtmlxMenuObjectLiveInstances[b]._hideContextMenu();a=a||event;a.cancelBubble=!0;a.returnValue=!1;f._doOnContextBeforeCall(a,this);return!1}}};dhtmlXMenuObject.prototype._doOnContextMenuOpera=function(b,c){for(var a in dhtmlxMenuObjectLiveInstances)a!=c._UID&&dhtmlxMenuObjectLiveInstances[a].context&&dhtmlxMenuObjectLiveInstances[a]._hideContextMenu();b.cancelBubble=!0;b.returnValue=!1;b.button==0&&b.ctrlKey==!0&&c._doOnContextBeforeCall(b,this);return!1};dhtmlXMenuObject.prototype.removeContextZone=function(b){if(!this.isContextZone(b))return!1;b==document.body&&(b="document.body."+this.idPrefix);var c=this.contextZones[b];_isOpera?c.removeEventListener("mouseup",this.operaContext,!1):(c.oncontextmenu=c._oldContextMenuHandler!=null?c._oldContextMenuHandler:null,c._oldContextMenuHandler=null);try{this.contextZones[b]=null,delete this.contextZones[b]}catch(a){}return!0};dhtmlXMenuObject.prototype.isContextZone=function(b){if(b==document.body&&this.contextZones["document.body."+this.idPrefix]!=null)return!0;var c=!1;this.contextZones[b]!=null&&this.contextZones[b]==document.getElementById(b)&&(c=!0);return c};dhtmlXMenuObject.prototype._isContextMenuVisible=function(){return this.idPull["polygon_"+this.idPrefix+this.topId]==null?!1:this.idPull["polygon_"+this.idPrefix+this.topId].style.display==""};dhtmlXMenuObject.prototype._showContextMenu=function(b,c,a){this._clearAndHide();if(this.idPull["polygon_"+this.idPrefix+this.topId]==null)return!1;window.clearTimeout(this.menuTimeoutHandler);this.idPull[this.idPrefix+this.topId]=[b,c];this._showPolygon(this.idPrefix+this.topId,"bottom");this.callEvent("onContextMenu",[a,this.contextMenuZoneId])};dhtmlXMenuObject.prototype._hideContextMenu=function(){if(this.idPull["polygon_"+this.idPrefix+this.topId]==null)return!1;this._clearAndHide();this._hidePolygon(this.idPrefix+this.topId);this.zInd=this.zIndInit};dhtmlXMenuObject.prototype._doOnContextBeforeCall=function(b,c){this.contextMenuZoneId=c.id;this._clearAndHide();this._hideContextMenu();var a=b.srcElement||b.target,d=_isIE||_isOpera||_KHTMLrv?b.offsetX:b.layerX,f=_isIE||_isOpera||_KHTMLrv?b.offsetY:b.layerY,e=getAbsoluteLeft(a)+d,g=getAbsoluteTop(a)+f;this.checkEvent("onBeforeContextMenu")?this.callEvent("onBeforeContextMenu",[c.id,b])&&this.contextAutoShow&&(this._showContextMenu(e,g),this.callEvent("onAfterContextMenu",[c.id,b])):this.contextAutoShow&&(this._showContextMenu(e,g),this.callEvent("onAfterContextMenu",[c.id]))};dhtmlXMenuObject.prototype.showContextMenu=function(b,c){this._showContextMenu(b,c,!1)};dhtmlXMenuObject.prototype.hideContextMenu=function(){this._hideContextMenu()};dhtmlXMenuObject.prototype._autoDetectVisibleArea=function(){if(!this._isVisibleArea)this.menuX1=document.body.scrollLeft,this.menuX2=this.menuX1+(window.innerWidth||document.body.clientWidth),this.menuY1=Math.max((_isIE?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop),this.menuY2=this.menuY1+(_isIE?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0,document.body.clientHeight||0):window.innerHeight)};dhtmlXMenuObject.prototype.getItemPosition=function(b){var b=this.idPrefix+b,c=-1;if(this.itemPull[b]==null)return c;for(var a=this.itemPull[b].parent,d=this.idPull["polygon_"+a]!=null?this.idPull["polygon_"+a].tbd:this.cont,f=0;f<d.childNodes.length;f++)if(d.childNodes[f]==this.idPull["separator_"+b]||d.childNodes[f]==this.idPull[b])c=f;return c};dhtmlXMenuObject.prototype.setItemPosition=function(b,c){b=this.idPrefix+b;if(this.idPull[b]!=null){var a=this.itemPull[b].parent==this.idPrefix+this.topId,d=this.idPull[b],f=this.getItemPosition(b.replace(this.idPrefix,"")),e=this.itemPull[b].parent,g=this.idPull["polygon_"+e]!=null?this.idPull["polygon_"+e].tbd:this.cont;g.removeChild(g.childNodes[f]);c<0&&(c=0);a&&c<1&&(c=1);c<g.childNodes.length?g.insertBefore(d,g.childNodes[c]):g.appendChild(d)}};dhtmlXMenuObject.prototype.getParentId=function(b){b=this.idPrefix+b;return this.itemPull[b]==null?null:(this.itemPull[b].parent!=null?this.itemPull[b].parent:this.topId).replace(this.idPrefix,"")};dhtmlXMenuObject.prototype.addNewSibling=function(b,c,a,d,f,e){var g=this.idPrefix+(c!=null?c:this._genStr(24)),h=this.idPrefix+(b!=null?this.getParentId(b):this.topId);this._addItemIntoGlobalStrorage(g,h,a,"item",d,f,e);h==this.idPrefix+this.topId&&!this.context?this._renderToplevelItem(g,this.getItemPosition(b)):this._renderSublevelItem(g,this.getItemPosition(b))};dhtmlXMenuObject.prototype.addNewChild=function(b,c,a,d,f,e,g){if(b==null)if(this.context)b=this.topId;else{this.addNewSibling(b,a,d,f,e,g);c!=null&&this.setItemPosition(a,c);return}a=this.idPrefix+(a!=null?a:this._genStr(24));this.setHotKey&&this.setHotKey(b,"");b=this.idPrefix+b;this._addItemIntoGlobalStrorage(a,b,d,"item",f,e,g);this.idPull["polygon_"+b]==null&&this._renderSublevelPolygon(b,b);this._renderSublevelItem(a,c-1);this._redefineComplexState(b)};dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage=function(b,c,a,d,f,e,g){var h={id:b,title:a,imgen:e!=null?e:"",imgdis:g!=null?g:"",type:d,state:f==!0?"disabled":"enabled",parent:c,complex:!1,hotkey:"",tip:""};this.itemPull[h.id]=h};dhtmlXMenuObject.prototype._addSubMenuPolygon=function(b,c){for(var a=this._renderSublevelPolygon(b,c),d=this._getMenuNodes(c),f=0;f<d.length;f++)this.itemPull[d[f]].type=="separator"?this._renderSeparator(d[f],null):this._renderSublevelItem(d[f],null);for(var e=b==c?"topLevel":"subLevel",f=0;f<d.length;f++)this.itemPull[d[f]].complex&&this._addSubMenuPolygon(b,this.itemPull[d[f]].id)};dhtmlXMenuObject.prototype._renderSublevelPolygon=function(b,c){var a=document.createElement("DIV");a.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_Polygon "+(this._rtl?"dir_right":"");a.dir="ltr";a.oncontextmenu=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};a.id="polygon_"+c;a.onclick=function(a){a=a||event;a.cancelBubble=!0};a.style.display="none";document.body.insertBefore(a,document.body.firstChild);var d=document.createElement("TABLE");d.className="dhtmlxMebu_SubLevelArea_Tbl";d.cellSpacing=0;d.cellPadding=0;d.border=0;var f=document.createElement("TBODY");d.appendChild(f);a.appendChild(d);a.tbl=d;a.tbd=f;this.idPull[a.id]=a;this.sxDacProc!=null&&(this.idPull["sxDac_"+c]=new this.sxDacProc(a,a.className),_isIE?(this.idPull["sxDac_"+c]._setSpeed(this.dacSpeedIE),this.idPull["sxDac_"+c]._setCustomCycle(this.dacCyclesIE)):(this.idPull["sxDac_"+c]._setSpeed(this.dacSpeed),this.idPull["sxDac_"+c]._setCustomCycle(this.dacCycles)));return a};dhtmlXMenuObject.prototype._renderSublevelItem=function(b,c){var a=this,d=document.createElement("TR");d.className=this.itemPull[b].state=="enabled"?"sub_item":"sub_item_dis";var f=document.createElement("TD");f.className="sub_item_icon";var e=this.itemPull[b][this.itemPull[b].state=="enabled"?"imgen":"imgdis"];if(e!=""){var g=this.itemPull[b].type;if(g=="checkbox"||g=="radio"){var h=document.createElement("DIV");h.id="image_"+this.itemPull[b].id;h.className="sub_icon "+e;f.appendChild(h)}if(!(g=="checkbox"||g=="radio"))h=document.createElement("IMG"),h.id="image_"+this.itemPull[b].id,h.className="sub_icon",h.src=this.imagePath+e,f.appendChild(h)}var j=document.createElement("TD");j.className="sub_item_text";if(this.itemPull[b].title!=""){var k=document.createElement("DIV");k.className="sub_item_text";k.innerHTML=this.itemPull[b].title;j.appendChild(k)}else j.innerHTML="&nbsp;";var m=document.createElement("TD");m.className="sub_item_hk";if(this.itemPull[b].complex){var z=document.createElement("DIV");z.className="complex_arrow";z.id="arrow_"+this.itemPull[b].id;m.appendChild(z)}else if(this.itemPull[b].hotkey.length>0&&!this.itemPull[b].complex){var A=document.createElement("DIV");A.className="sub_item_hk";A.innerHTML=this.itemPull[b].hotkey;m.appendChild(A)}else m.innerHTML="&nbsp;";d.appendChild(this._rtl?m:f);d.appendChild(j);d.appendChild(this._rtl?f:m);d.id=this.itemPull[b].id;d.parent=this.itemPull[b].parent;if(this.itemPull[b].tip.length>0)d.title=this.itemPull[b].tip;d.onselectstart=function(a){a=a||event;return a.returnValue=!1};d.onmouseover=function(){a.menuMode=="web"&&window.clearTimeout(a.menuTimeoutHandler);a._redistribSubLevelSelection(this.id,this.parent)};if(a.menuMode=="web")d.onmouseout=function(){window.clearTimeout(a.menuTimeoutHandler);a.menuTimeoutHandler=window.setTimeout(function(){a._clearAndHide()},a.menuTimeoutMsec,"JavaScript")};d.onclick=function(b){if(a.checkEvent("onClick")||!a.itemPull[this.id].complex){b=b||event;b.cancelBubble=!0;b.returnValue=!1;tc=a.itemPull[this.id].complex?"c":"-";td=a.itemPull[this.id].state=="enabled"?"-":"d";var c={ctrl:b.ctrlKey,alt:b.altKey,shift:b.shiftKey};switch(a.itemPull[this.id].type){case"checkbox":a._checkboxOnClickHandler(this.id.replace(a.idPrefix,""),tc+td+"n",c);a.hide();break;case"radio":a._radioOnClickHandler(this.id.replace(a.idPrefix,""),tc+td+"n",c);break;case"item":a._doOnClick(this.id.replace(a.idPrefix,""),tc+td+"n",c)}return!1}};var p=this.idPull["polygon_"+this.itemPull[b].parent];c!=null&&(c++,c<0&&(c=0),c>p.tbd.childNodes.length-1&&(c=null));c!=null&&p.tbd.childNodes[c]!=null?p.tbd.insertBefore(d,p.tbd.childNodes[c]):p.tbd.appendChild(d);this.idPull[d.id]=d};dhtmlXMenuObject.prototype._renderSeparator=function(b,c){var a=this.context?"SubLevelArea":this.itemPull[b].parent==this.idPrefix+this.topId?"TopLevel":"SubLevelArea";if(!(a=="TopLevel"&&this.context)){var d=this;if(a!="TopLevel"){var f=document.createElement("TR");f.className="sub_sep";var e=document.createElement("TD");e.colSpan="3";f.appendChild(e)}var g=document.createElement("DIV");g.id="separator_"+b;g.className=a=="TopLevel"?"top_sep":"sub_sep";g.onselectstart=function(a){a=a||event;a.returnValue=!1};g.onclick=function(a){a=a||event;a.cancelBubble=!0;var b={ctrl:a.ctrlKey,alt:a.altKey,shift:a.shiftKey};d._doOnClick(this.id.replace("separator_"+d.idPrefix,""),"--s",b)};if(a=="TopLevel"){if(c!=null)c++,c<0&&(c=0),this.cont.childNodes[c]!=null?this.cont.insertBefore(g,this.cont.childNodes[c]):this.cont.appendChild(g);else{var h=this.cont.childNodes[this.cont.childNodes.length-1];String(h).search("TopLevel_Text")==-1?this.cont.appendChild(g):this.cont.insertBefore(g,h)}this.idPull[g.id]=g}else{var j=this.idPull["polygon_"+this.itemPull[b].parent];c!=null&&(c++,c<0&&(c=0),c>j.tbd.childNodes.length-1&&(c=null));c!=null&&j.tbd.childNodes[c]!=null?j.tbd.insertBefore(f,j.tbd.childNodes[c]):j.tbd.appendChild(f);e.appendChild(g);this.idPull[g.id]=f}}};dhtmlXMenuObject.prototype.addNewSeparator=function(b,c){var c=this.idPrefix+(c!=null?c:this._genStr(24)),a=this.idPrefix+this.getParentId(b);this._addItemIntoGlobalStrorage(c,a,"","separator",!1,"","");this._renderSeparator(c,this.getItemPosition(b))};dhtmlXMenuObject.prototype.hide=function(){this._clearAndHide()};dhtmlXMenuObject.prototype.clearAll=function(){this.removeItem(this.idPrefix+this.topId,!0);this._isInited=!1;this.idPrefix=this._genStr(12)};dhtmlXMenuObject.prototype.unload=function(){_isIE?(document.body.detachEvent("onclick",this._bodyClick),document.body.detachEvent("oncontextmenu",this._bodyContext)):(window.removeEventListener("click",this._bodyClick,!1),window.removeEventListener("contextmenu",this._bodyContext,!1));this._bodyContext=this._bodyClick=null;this.removeItem(this.idPrefix+this.topId,!0);this.idPull=this.itemPull=null;if(this.context)for(var b in this.contextZones)this.removeContextZone(b);if(this.cont!=null)this.cont.className="",this.cont.parentNode.removeChild(this.cont),this.cont=null;if(this.base!=null){this.base.className="";if(!this.context)this.base.oncontextmenu=this.base._oldContextMenuHandler||null;this.base=this.base.onselectstart=null}this.setSkin=null;this.detachAllEvents();if(this._xmlLoader)this._xmlLoader.destructor(),this._xmlLoader=null;this.extendedModule=this.serialize=this.addCheckbox=this.getCheckboxState=this.setCheckboxState=this.addRadioButton=this.setRadioChecked=this.getRadioChecked=this.userData=this.setOverflowHeight=this.contextZones=this.getCircuit=this.clearHref=this.setHref=this.setAlign=this.setRTL=this.setTopText=this.setItemSelected=this.getHotKey=this.setHotKey=this.getTooltip=this.setTooltip=this.setVisibleArea=this.getContextMenuHideAllMode=this.setContextMenuHideAllMode=this.setAutoHideMode=this.setAutoShowMode=this.clearItemImage=this.setItemImage=this.getItemImage=this.enableDynamicLoading=this.setWebModeTimeout=this.setOpenMode=this.getUserData=this.setUserData=this.isItemHidden=this.showItem=this.hideItem=this.loadFromHTML=this.setItemText=this.getItemText=this.isItemEnabled=this.setItemDisabled=this.setItemEnabled=this._removeArrow=this._checkboxOnClickHandler=this._updateCheckboxImage=this._readLevel=this._setCheckboxState=this._getCheckboxState=this._radioOnClickHandler=this._setRadioState=this._getRadioImgObj=this._countPolygonItems=this._doScrollDown=this._doScrollUp=this._isArrowExists=this._removeDownArrow=this._removeUpArrow=this._addDownArrow=this._addUpArrow=this._checkArrowsState=this._clearAllSelectedSubItemsInPolygon=this._updateLoaderIcon=this._changeItemVisible=this._changeItemState=this.hideContextMenu=this.showContextMenu=this.hide=this.detachAllEvents=this.radio=this.items=this.unload=this.dhx_Event=this.detachEvent=this.eventCatcher=this.checkEvent=this.callEvent=this.attachEvent=this.addNewSeparator=this.addNewChild=this.addNewSibling=this.getParentId=this.setItemPosition=this.getItemPosition=this.clearAll=this._hideContextMenu=this._renderSeparator=this._renderSublevelItem=this._renderSublevelPolygon=this._addSubMenuPolygon=this._addItemIntoGlobalStrorage=this._autoDetectVisibleArea=this._doOnContextBeforeCall=this._showContextMenu=this._isContextMenuVisible=this.isContextZone=this.removeContextZone=this.addContextZone=this.renderAsContextMenu=this._getAllParents=this.removeItem=this._updateItemImage=this.setIconPath=this.setIconsPath=this.setImagePath=this._renderToplevelItem=this._initTopLevelMenu=this._redistribTopLevelSelection=this._getItemLevelType=this._updateItemComplexState=this._redefineComplexState=this._countVisiblePolygonItems=this._hideSubLevelItem=this._showSubLevelItem=this._xmlParser=this._buildMenu=this.loadXMLString=this.loadXML=this.init=this.forEachItem=this.getItemType=this._doOnLoad=this._clearAndHide=this._genStr=this._getMenuNodes=this._searchMenuNode=this._doOnTouchMenu=this._doOnClick=this._redistribSubLevelSelection=this._showPolygon=this._hidePolygon=this._getSubItemToDeselectByPolygon=this._removeSubItemFromSelected=this._addSubItemToSelected=this._openedPolygons=this._selectedSubItems=this._enableDacSupport=this.zIndStep=this.zIndInit=this.zInd=this.dacSpeedIE=this.dacSpeed=this.dacCyclesIE=this.dacCycles=this.topId=this.skin=this.userDataTagName=this.itemTipTagName=this.itemTextTagName=this.itemTagName=this.itemHrefTagName=this.itemHotKeyTagName=this.isDhtmlxMenuObject=this.menuTouched=this.menuTimeoutMsec=this.menuTimeoutHandler=this.menuModeTopLevelTimeoutTime=this.menuModeTopLevelTimeout=this.menuMode=this.imagePath=this.idPrefix=this.menuLastClicked=this.menuSelected=this.limit=this.dirTopLevel=this.dirSubLevel=this.fixedPosition=this.loaderIcon=this.dLoadUrl=this.dLoadSign=this.dLoad=this.contextMenuZoneId=this.contextHideAllMode=this.contextAutoShow=this.contextAutoHide=this.context=this.addBaseIdAsContextZone=this._topLevelRightMargin=this._topLevelBottomMargin=this._topLevelOffsetLeft=this._topLevelBottomMargin=this._scrollUpTMTime=this._scrollUpTMStep=this._scrollDownTMTime=this._scrollDownTMStep=this._rtl=this._isInited=this._isIE6=this._arrowFFFix=this._align=null;

dhtmlxMenuObjectLiveInstances[this._UID]=null;try{delete dhtmlxMenuObjectLiveInstances[this._UID]}catch(c){}this._UID=null};var dhtmlxMenuObjectLiveInstances={};dhtmlXMenuObject.prototype.i18n={dhxmenuextalert:"dhtmlxmenu_ext.js required"};(function(){dhtmlx.extend_api("dhtmlXMenuObject",{_init:function(b){return[b.parent,b.skin]},align:"setAlign",top_text:"setTopText",context:"renderAsContextMenu",icon_path:"setIconsPath",open_mode:"setOpenMode",rtl:"setRTL",skin:"setSkin",dynamic:"enableDynamicLoading",xml:"loadXML",items:"items",overflow:"setOverflowHeight"},{items:function(b,c){for(var a=1e5,d=null,f=0;f<b.length;f++){var e=b[f];e.type=="separator"?(this.addNewSeparator(d,a,e.id),d=e.id):(this.addNewChild(c,a,e.id,e.text,e.disabled,e.img,e.img_disabled),d=e.id,e.items&&this.items(e.items,e.id))}}})})();dhtmlXMenuObject.prototype.extendedModule="DHXMENUEXT";dhtmlXMenuObject.prototype.setItemEnabled=function(a){this._changeItemState(a,"enabled",this._getItemLevelType(a))};dhtmlXMenuObject.prototype.setItemDisabled=function(a){this._changeItemState(a,"disabled",this._getItemLevelType(a))};dhtmlXMenuObject.prototype.isItemEnabled=function(a){return this.itemPull[this.idPrefix+a]!=null?this.itemPull[this.idPrefix+a].state=="enabled":!1};dhtmlXMenuObject.prototype._changeItemState=function(a,c,b){var d=!1,e=this.idPrefix+a;if(this.itemPull[e]!=null&&this.idPull[e]!=null&&this.itemPull[e].state!=c)this.itemPull[e].state=c,this.idPull[e].className=this.itemPull[e].parent==this.idPrefix+this.topId&&!this.context?"dhtmlxMenu_"+this.skin+"_TopLevel_Item_"+(this.itemPull[e].state=="enabled"?"Normal":"Disabled"):"sub_item"+(this.itemPull[e].state=="enabled"?"":"_dis"),this._updateItemComplexState(this.idPrefix+a,this.itemPull[this.idPrefix+a].complex,!1),this._updateItemImage(a,b),this.idPrefix+this.menuLastClicked==e&&b!="TopLevel"&&this._redistribSubLevelSelection(e,this.itemPull[e].parent);return d};dhtmlXMenuObject.prototype.getItemText=function(a){return this.itemPull[this.idPrefix+a]!=null?this.itemPull[this.idPrefix+a].title:""};dhtmlXMenuObject.prototype.setItemText=function(a,c){a=this.idPrefix+a;if(this.itemPull[a]!=null&&this.idPull[a]!=null)if(this._clearAndHide(),this.itemPull[a].title=c,this.itemPull[a].parent==this.idPrefix+this.topId&&!this.context){for(var b=null,d=0;d<this.idPull[a].childNodes.length;d++)try{this.idPull[a].childNodes[d].className=="top_level_text"&&(b=this.idPull[a].childNodes[d])}catch(e){}if(String(this.itemPull[a].title).length==""||this.itemPull[a].title==null)b!=null&&b.parentNode.removeChild(b);else{if(!b)b=document.createElement("DIV"),b.className="top_level_text",this._rtl&&this.idPull[a].childNodes.length>0?this.idPull[a].insertBefore(b,this.idPull[a].childNodes[0]):this.idPull[a].appendChild(b);b.innerHTML=this.itemPull[a].title}}else{b=null;for(d=0;d<this.idPull[a].childNodes[1].childNodes.length;d++)if(String(this.idPull[a].childNodes[1].childNodes[d].className||"")=="sub_item_text")b=this.idPull[a].childNodes[1].childNodes[d];if(String(this.itemPull[a].title).length==""||this.itemPull[a].title==null){if(b)b.parentNode.removeChild(b),b=null,this.idPull[a].childNodes[1].innerHTML="&nbsp;"}else{if(!b)b=document.createElement("DIV"),b.className="sub_item_text",this.idPull[a].childNodes[1].innerHTML="",this.idPull[a].childNodes[1].appendChild(b);b.innerHTML=this.itemPull[a].title}}};dhtmlXMenuObject.prototype.loadFromHTML=function(a,c,b){this.itemTagName="DIV";typeof a=="string"&&(a=document.getElementById(a));this._buildMenu(a,null);this.init();c&&a.parentNode.removeChild(a);b!=null&&b()};dhtmlXMenuObject.prototype.hideItem=function(a){this._changeItemVisible(a,!1)};dhtmlXMenuObject.prototype.showItem=function(a){this._changeItemVisible(a,!0)};dhtmlXMenuObject.prototype.isItemHidden=function(a){var c=null;this.idPull[this.idPrefix+a]!=null&&(c=this.idPull[this.idPrefix+a].style.display=="none");return c};dhtmlXMenuObject.prototype._changeItemVisible=function(a,c){var b=this.idPrefix+a;if(this.itemPull[b]!=null&&(this.itemPull[b].type=="separator"&&(b="separator_"+b),this.idPull[b]!=null))this.idPull[b].style.display=c?"":"none",this._redefineComplexState(this.itemPull[this.idPrefix+a].parent)};dhtmlXMenuObject.prototype.setUserData=function(a,c,b){this.userData[this.idPrefix+a+"_"+c]=b};dhtmlXMenuObject.prototype.getUserData=function(a,c){return this.userData[this.idPrefix+a+"_"+c]!=null?this.userData[this.idPrefix+a+"_"+c]:null};dhtmlXMenuObject.prototype.setOpenMode=function(a){if(a=="win"||a=="web")this.menuMode=a};dhtmlXMenuObject.prototype.setWebModeTimeout=function(a){this.menuTimeoutMsec=!isNaN(a)?a:400};dhtmlXMenuObject.prototype.enableDynamicLoading=function(a,c){this.dLoad=!0;this.dLoadUrl=a;this.dLoadSign=String(this.dLoadUrl).search(/\?/)==-1?"?":"&";this.loaderIcon=c;this.init()};dhtmlXMenuObject.prototype._updateLoaderIcon=function(a,c){if(this.idPull[a]!=null&&!(String(this.idPull[a].className).search("TopLevel_Item")>=0)){var b=this._rtl?0:2;if(this.idPull[a].childNodes[b]&&this.idPull[a].childNodes[b].childNodes[0]){var d=this.idPull[a].childNodes[b].childNodes[0];if(String(d.className).search("complex_arrow")===0)d.className="complex_arrow"+(c?"_loading":"")}}};dhtmlXMenuObject.prototype.getItemImage=function(a){var c=[null,null],a=this.idPrefix+a;if(this.itemPull[a].type=="item")c[0]=this.itemPull[a].imgen,c[1]=this.itemPull[a].imgdis;return c};dhtmlXMenuObject.prototype.setItemImage=function(a,c,b){if(this.itemPull[this.idPrefix+a].type=="item")this.itemPull[this.idPrefix+a].imgen=c,this.itemPull[this.idPrefix+a].imgdis=b,this._updateItemImage(a,this._getItemLevelType(a))};dhtmlXMenuObject.prototype.clearItemImage=function(a){this.setItemImage(a,"","")};dhtmlXMenuObject.prototype.setAutoShowMode=function(a){this.contextAutoShow=a==!0?!0:!1};dhtmlXMenuObject.prototype.setAutoHideMode=function(a){this.contextAutoHide=a==!0?!0:!1};dhtmlXMenuObject.prototype.setContextMenuHideAllMode=function(a){this.contextHideAllMode=a==!0?!0:!1};dhtmlXMenuObject.prototype.getContextMenuHideAllMode=function(){return this.contextHideAllMode};dhtmlXMenuObject.prototype.setVisibleArea=function(a,c,b,d){this._isVisibleArea=!0;this.menuX1=a;this.menuX2=c;this.menuY1=b;this.menuY2=d};dhtmlXMenuObject.prototype.setTooltip=function(a,c){a=this.idPrefix+a;if(this.itemPull[a]!=null&&this.idPull[a]!=null)this.idPull[a].title=c.length>0?c:null,this.itemPull[a].tip=c};dhtmlXMenuObject.prototype.getTooltip=function(a){return this.itemPull[this.idPrefix+a]==null?null:this.itemPull[this.idPrefix+a].tip};dhtmlXMenuObject.prototype.setHotKey=function(a,c){a=this.idPrefix+a;if(this.itemPull[a]!=null&&this.idPull[a]!=null&&(this.itemPull[a].parent!=this.idPrefix+this.topId||this.context)&&!this.itemPull[a].complex){var b=this.itemPull[a].type;if(b=="item"||b=="checkbox"||b=="radio"){var d=null;try{if(this.idPull[a].childNodes[this._rtl?0:2].childNodes[0].className=="sub_item_hk")d=this.idPull[a].childNodes[this._rtl?0:2].childNodes[0]}catch(e){}if(c.length==0)this.itemPull[a].hotkey_backup=this.itemPull[a].hotkey,this.itemPull[a].hotkey="",d!=null&&d.parentNode.removeChild(d);else{this.itemPull[a].hotkey=c;this.itemPull[a].hotkey_backup=null;if(d==null){d=document.createElement("DIV");d.className="sub_item_hk";for(var f=this.idPull[a].childNodes[this._rtl?0:2];f.childNodes.length>0;)f.removeChild(f.childNodes[0]);f.appendChild(d)}d.innerHTML=c}}}};dhtmlXMenuObject.prototype.getHotKey=function(a){return this.itemPull[this.idPrefix+a]==null?null:this.itemPull[this.idPrefix+a].hotkey};dhtmlXMenuObject.prototype.setItemSelected=function(a){if(this.itemPull[this.idPrefix+a]==null)return null};dhtmlXMenuObject.prototype.setTopText=function(a){if(!this.context){if(this._topText==null)this._topText=document.createElement("DIV"),this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this._rtl?"left":this._align=="left"?"right":"left"),this.base.appendChild(this._topText);this._topText.innerHTML=a}};dhtmlXMenuObject.prototype.setAlign=function(a){if(this._align!=a&&(a=="left"||a=="right")){this._align=a;if(this.cont)this.cont.className=this._align=="right"?"align_right":"align_left";if(this._topText!=null)this._topText.className="dhtmlxMenu_TopLevel_Text_"+(this._align=="left"?"right":"left")}};dhtmlXMenuObject.prototype.setHref=function(a,c,b){if(this.itemPull[this.idPrefix+a]!=null)this.itemPull[this.idPrefix+a].href_link=c,b!=null&&(this.itemPull[this.idPrefix+a].href_target=b)};dhtmlXMenuObject.prototype.clearHref=function(a){this.itemPull[this.idPrefix+a]!=null&&(delete this.itemPull[this.idPrefix+a].href_link,delete this.itemPull[this.idPrefix+a].href_target)};dhtmlXMenuObject.prototype.getCircuit=function(a){for(var c=Array(a);this.getParentId(a)!=this.topId;)a=this.getParentId(a),c[c.length]=a;return c.reverse()};dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon=function(a){for(var c=this._getSubItemToDeselectByPolygon(a),b=0;b<this._openedPolygons.length;b++)this._openedPolygons[b]!=a&&this._hidePolygon(this._openedPolygons[b]);for(b=0;b<c.length;b++)if(this.idPull[c[b]]!=null&&this.itemPull[c[b]].state=="enabled")this.idPull[c[b]].className="dhtmlxMenu_"+this.skin+"_SubLevelArea_Item_Normal"};dhtmlXMenuObject.prototype._checkArrowsState=function(a){var c=this.idPull["polygon_"+a],b=this.idPull["arrowup_"+a],d=this.idPull["arrowdown_"+a];b.className=c.scrollTop==0?"dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp_Disabled":"dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp"+(b.over?"_Over":"");d.className=c.scrollTop+c.offsetHeight<c.scrollHeight?"dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown"+(d.over?"_Over":""):"dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown_Disabled"};dhtmlXMenuObject.prototype._addUpArrow=function(a){var c=this,b=document.createElement("DIV");b.pId=this.idPrefix+a;b.id="arrowup_"+this.idPrefix+a;b.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowUp";b.innerHTML="<div class='dhtmlxMenu_"+this.skin+"_SubLevelArea_Arrow'><div class='dhtmlxMenu_SubLevelArea_Arrow_Icon'></div></div>";b.style.display="none";b.over=!1;b.onselectstart=function(a){a=a||event;return a.returnValue=!1};b.oncontextmenu=function(a){a=a||event;return a.returnValue=!1};b.onmouseover=function(){c.menuMode=="web"&&window.clearTimeout(c.menuTimeoutHandler);c._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className!="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowUp_Disabled")this.className="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowUp_Over",this.over=!0,c._canScrollUp=!0,c._doScrollUp(this.pId,!0)};b.onmouseout=function(){if(c.menuMode=="web")window.clearTimeout(c.menuTimeoutHandler),c.menuTimeoutHandler=window.setTimeout(function(){c._clearAndHide()},c.menuTimeoutMsec,"JavaScript");this.over=!1;c._canScrollUp=!1;if(this.className!="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowUp_Disabled")this.className="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowUp",window.clearTimeout(c._scrollUpTM)};b.onclick=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};document.body.insertBefore(b,document.body.firstChild);this.idPull[b.id]=b};dhtmlXMenuObject.prototype._addDownArrow=function(a){var c=this,b=document.createElement("DIV");b.pId=this.idPrefix+a;b.id="arrowdown_"+this.idPrefix+a;b.className="dhtmlxMenu_"+this.skin+"_SubLevelArea_ArrowDown";b.innerHTML="<div class='dhtmlxMenu_"+this.skin+"_SubLevelArea_Arrow'><div class='dhtmlxMenu_SubLevelArea_Arrow_Icon'></div></div>";b.style.display="none";b.over=!1;b.onselectstart=function(a){a=a||event;return a.returnValue=!1};b.oncontextmenu=function(a){a=a||event;return a.returnValue=!1};b.onmouseover=function(){c.menuMode=="web"&&window.clearTimeout(c.menuTimeoutHandler);c._clearAllSelectedSubItemsInPolygon(this.pId);if(this.className!="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowDown_Disabled")this.className="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowDown_Over",this.over=!0,c._canScrollDown=!0,c._doScrollDown(this.pId,!0)};b.onmouseout=function(){if(c.menuMode=="web")window.clearTimeout(c.menuTimeoutHandler),c.menuTimeoutHandler=window.setTimeout(function(){c._clearAndHide()},c.menuTimeoutMsec,"JavaScript");this.over=!1;c._canScrollDown=!1;if(this.className!="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowDown_Disabled")this.className="dhtmlxMenu_"+c.skin+"_SubLevelArea_ArrowDown",window.clearTimeout(c._scrollDownTM)};b.onclick=function(a){a=a||event;a.returnValue=!1;a.cancelBubble=!0;return!1};document.body.insertBefore(b,document.body.firstChild);this.idPull[b.id]=b};dhtmlXMenuObject.prototype._removeUpArrow=function(a){var c="arrowup_"+this.idPrefix+a;this._removeArrow(c)};dhtmlXMenuObject.prototype._removeDownArrow=function(a){var c="arrowdown_"+this.idPrefix+a;this._removeArrow(c)};dhtmlXMenuObject.prototype._removeArrow=function(a){var c=this.idPull[a];c.onselectstart=null;c.oncontextmenu=null;c.onmouseover=null;c.onmouseout=null;c.onclick=null;c.parentNode&&c.parentNode.removeChild(c);c=null;this.idPull[a]=null;try{delete this.idPull[a]}catch(b){}};dhtmlXMenuObject.prototype._isArrowExists=function(a){return this.idPull["arrowup_"+a]!=null&&this.idPull["arrowdown_"+a]!=null?!0:!1};dhtmlXMenuObject.prototype._doScrollUp=function(a,c){var b=this.idPull["polygon_"+a];if(this._canScrollUp&&b.scrollTop>0){var d=!1,e=b.scrollTop-this._scrollUpTMStep;e<0&&(d=!0,e=0);b.scrollTop=e;if(!d){var f=this;this._scrollUpTM=window.setTimeout(function(){f._doScrollUp(a,!1)},this._scrollUpTMTime)}}else this._canScrollUp=!1,this._checkArrowsState(a);c&&this._checkArrowsState(a)};dhtmlXMenuObject.prototype._doScrollDown=function(a,c){var b=this.idPull["polygon_"+a];if(this._canScrollDown&&b.scrollTop+b.offsetHeight<=b.scrollHeight){var d=!1,e=b.scrollTop+this._scrollDownTMStep;e+b.offsetHeight>b.scollHeight&&(d=!0,e=b.scollHeight-b.offsetHeight);b.scrollTop=e;if(!d){var f=this;this._scrollDownTM=window.setTimeout(function(){f._doScrollDown(a,!1)},this._scrollDownTMTime)}}else this._checkArrowsState(a);c&&this._checkArrowsState(a)};dhtmlXMenuObject.prototype._countPolygonItems=function(a){var c=0,b;for(b in this.itemPull){var d=this.itemPull[b].parent,e=this.itemPull[b].type;d==this.idPrefix+a&&(e=="item"||e=="radio"||e=="checkbox")&&c++}return c};dhtmlXMenuObject.prototype.setOverflowHeight=function(a){if(!(this.limit==0&&a<=0))if(this._clearAndHide(),this.limit>=0&&a>0)this.limit=a;else if(this.limit>0&&a<=0){for(var c in this.itemPull)if(this._isArrowExists(c)){var b=String(c).replace(this.idPrefix,"");this._removeUpArrow(b);this._removeDownArrow(b);this.idPull["polygon_"+c].style.height=""}this.limit=0}};dhtmlXMenuObject.prototype._getRadioImgObj=function(a){try{var c=this.idPull[this.idPrefix+a].childNodes[this._rtl?2:0].childNodes[0]}catch(b){c=null}return c};dhtmlXMenuObject.prototype._setRadioState=function(a,c){var b=this._getRadioImgObj(a);if(b!=null){var d=this.itemPull[this.idPrefix+a];d.checked=c;d.imgen="rdbt_"+(d.checked?"1":"0");d.imgdis=d.imgen;b.className="sub_icon "+d.imgen}};dhtmlXMenuObject.prototype._radioOnClickHandler=function(a,c,b){if(!(c.charAt(1)=="d"||this.itemPull[this.idPrefix+a].group==null)){var d=this.itemPull[this.idPrefix+a].group;this.checkEvent("onRadioClick")?this.callEvent("onRadioClick",[d,this.getRadioChecked(d),a,this.contextMenuZoneId,b])&&this.setRadioChecked(d,a):this.setRadioChecked(d,a);this.checkEvent("onClick")&&this.callEvent("onClick",[a])}};dhtmlXMenuObject.prototype.getRadioChecked=function(a){for(var c=null,b=0;b<this.radio[a].length;b++){var d=this.radio[a][b].replace(this.idPrefix,""),e=this._getRadioImgObj(d);if(e!=null){var f=e.className.match(/rdbt_1$/gi);f!=null&&(c=d)}}return c};dhtmlXMenuObject.prototype.setRadioChecked=function(a,c){if(this.radio[a]!=null)for(var b=0;b<this.radio[a].length;b++){var d=this.radio[a][b].replace(this.idPrefix,"");this._setRadioState(d,d==c)}};dhtmlXMenuObject.prototype.addRadioButton=function(a,c,b,d,e,f,k,i){if(!(this.context&&c==this.topId)){if(this.itemPull[this.idPrefix+c]==null)return;if(a=="child"&&this.itemPull[this.idPrefix+c].type!="item")return}var h=this.idPrefix+(d!=null?d:this._genStr(24)),g="rdbt_"+(k?"1":"0"),j=g;if(a=="sibling"){var l=this.idPrefix+this.getParentId(c);this._addItemIntoGlobalStrorage(h,l,e,"radio",i,g,j);this._renderSublevelItem(h,this.getItemPosition(c))}else l=this.idPrefix+c,this._addItemIntoGlobalStrorage(h,l,e,"radio",i,g,j),this.idPull["polygon_"+l]==null&&this._renderSublevelPolygon(l,l),this._renderSublevelItem(h,b-1),this._redefineComplexState(l);var m=f!=null?f:this._genStr(24);this.itemPull[h].group=m;this.radio[m]==null&&(this.radio[m]=[]);this.radio[m][this.radio[m].length]=h;k==!0&&this.setRadioChecked(m,String(h).replace(this.idPrefix,""))};dhtmlXMenuObject.prototype._getCheckboxState=function(a){return this.itemPull[this.idPrefix+a]==null?null:this.itemPull[this.idPrefix+a].checked};dhtmlXMenuObject.prototype._setCheckboxState=function(a,c){this.itemPull[this.idPrefix+a]!=null&&(this.itemPull[this.idPrefix+a].checked=c)};dhtmlXMenuObject.prototype._updateCheckboxImage=function(a){if(this.idPull[this.idPrefix+a]!=null){this.itemPull[this.idPrefix+a].imgen="chbx_"+(this._getCheckboxState(a)?"1":"0");this.itemPull[this.idPrefix+a].imgdis=this.itemPull[this.idPrefix+a].imgen;try{this.idPull[this.idPrefix+a].childNodes[this._rtl?2:0].childNodes[0].className="sub_icon "+this.itemPull[this.idPrefix+a].imgen}catch(c){}}};dhtmlXMenuObject.prototype._checkboxOnClickHandler=function(a,c,b){if(c.charAt(1)!="d"&&this.itemPull[this.idPrefix+a]!=null){var d=this._getCheckboxState(a);this.checkEvent("onCheckboxClick")?this.callEvent("onCheckboxClick",[a,d,this.contextMenuZoneId,b])&&this.setCheckboxState(a,!d):this.setCheckboxState(a,!d);this.checkEvent("onClick")&&this.callEvent("onClick",[a,this.contextMenuZoneId])}};dhtmlXMenuObject.prototype.setCheckboxState=function(a,c){this._setCheckboxState(a,c);this._updateCheckboxImage(a)};dhtmlXMenuObject.prototype.getCheckboxState=function(a){return this._getCheckboxState(a)};dhtmlXMenuObject.prototype.addCheckbox=function(a,c,b,d,e,f,k){if(!(this.context&&c==this.topId)){if(this.itemPull[this.idPrefix+c]==null)return;if(a=="child"&&this.itemPull[this.idPrefix+c].type!="item")return}var i="chbx_"+(f?"1":"0"),h=i;if(a=="sibling"){var g=this.idPrefix+(d!=null?d:this._genStr(24)),j=this.idPrefix+this.getParentId(c);this._addItemIntoGlobalStrorage(g,j,e,"checkbox",k,i,h);this.itemPull[g].checked=f;this._renderSublevelItem(g,this.getItemPosition(c))}else g=this.idPrefix+(d!=null?d:this._genStr(24)),j=this.idPrefix+c,this._addItemIntoGlobalStrorage(g,j,e,"checkbox",k,i,h),this.itemPull[g].checked=f,this.idPull["polygon_"+j]==null&&this._renderSublevelPolygon(j,j),this._renderSublevelItem(g,b-1),this._redefineComplexState(j)};dhtmlXMenuObject.prototype._readLevel=function(a){var c="",b;for(b in this.itemPull)if(this.itemPull[b].parent==a){var d="",e="",f="",k=String(this.itemPull[b].id).replace(this.idPrefix,""),i="",h=this.itemPull[b].title!=""?' text="'+this.itemPull[b].title+'"':"",g="";this.itemPull[b].type=="item"&&(this.itemPull[b].imgen!=""&&(d=' img="'+this.itemPull[b].imgen+'"'),this.itemPull[b].imgdis!=""&&(e=' imgdis="'+this.itemPull[b].imgdis+'"'),this.itemPull[b].hotkey!=""&&(f="<hotkey>"+this.itemPull[b].hotkey+"</hotkey>"));this.itemPull[b].type=="separator"?i=' type="separator"':this.itemPull[b].state=="disabled"&&(g=' enabled="false"');this.itemPull[b].type=="checkbox"&&(i=' type="checkbox"'+(this.itemPull[b].checked?' checked="true"':""));this.itemPull[b].type=="radio"&&(i=' type="radio" group="'+this.itemPull[b].group+'" '+(this.itemPull[b].checked?' checked="true"':""));c+="<item id='"+k+"'"+h+i+d+e+g+">";c+=f;this.itemPull[b].complex&&(c+=this._readLevel(b));c+="</item>"}return c};dhtmlXMenuObject.prototype.serialize=function(){var a="<menu>"+this._readLevel(this.idPrefix+this.topId)+"</menu>";return a};fvdSpeedDial.Controls={};fvdSpeedDial.Controls.Scroll=new function(){var ScrollInstance=function(elem,params){var self=this;params.margins=params.margins||{horiz:6};params.wheelScrollSpeed=params.wheelScrollSpeed||9;elem.style.overflow="hidden";elem.style.position="relative";var scrollElem=null;var thumbWidth=null;var nowIsScrolling=false;this.AutoScroll=new function(){var interval=null;var speed=1;var axis="x";var direction=1;var pause=false;this.setSpeed=function(_speed){speed=_speed};this.start=function(){restartInterval()};this.stop=function(){stopInterval()};this.setPause=function(_pause){pause=_pause};function doScroll(){if(pause||nowIsScrolling){return}if(axis=="x"){var maxScrollLeft=elem.scrollWidth-elem.offsetWidth;var delta=speed;if(direction>0){if(elem.scrollLeft>=maxScrollLeft){direction=-1}else{elem.scrollLeft+=delta;refreshScrollBarAfterScroll()}}else{if(elem.scrollLeft<=0){direction=1}else{elem.scrollLeft-=delta;refreshScrollBarAfterScroll()}}}}function stopInterval(){if(interval){try{clearInterval(interval)}catch(ex){}}}function restartInterval(){var time=50;stopInterval();interval=setInterval(doScroll,time)}};this.refresh=function(){refreshScrollBarVisibility()};this.refreshScrollManyTimes=function(count){count=count||5;var maked=0;function _r(){self.refresh();maked++;if(maked<count){setTimeout(function(){_r()},100)}}_r()};function l_windowResize(){self.refreshScrollManyTimes()}function l_sdBuildCompleted(){self.refreshScrollManyTimes()}function _getScrollWidth(){return elem.offsetWidth-2*params.margins.horiz}function _getMaxScrollDistance(){if(params.type=="horizontal"){return elem.scrollWidth-elem.offsetWidth}}function prepareScrollValue(v){if(v<0){return 0}var maxScrollDistance=_getMaxScrollDistance();if(v>maxScrollDistance){return maxScrollDistance}return v}function refreshThumbSize(){var thumb=scrollElem.querySelector(".scrollThumb");if(params.type=="horizontal"){var maxScrollDistance=_getMaxScrollDistance();var size=_getScrollWidth()-maxScrollDistance;thumbWidth=size;thumb.style.width=size+"px"}}function refreshThumbPosition(){var thumb=scrollElem.querySelector(".scrollThumb");var zone=scrollElem.querySelector(".scrollZone");if(params.type=="horizontal"){var left=elem.scrollLeft;var maxLeft=zone.offsetWidth-thumb.offsetWidth;if(left>maxLeft){console.log("MAX!",left,maxLeft);left=maxLeft}thumb.style.marginLeft=left+"px"}}function refreshScrollZone(){var zone=scrollElem.querySelector(".scrollZone");if(params.type=="horizontal"){var width=_getScrollWidth();scrollElem.style.width=width+"px"}}function refreshScrollBarVisibility(){if(elem.offsetWidth>=elem.scrollWidth){scrollElem.style.display="none"}else{scrollElem.style.display="none";refreshScrollZone();refreshThumbPosition();refreshThumbSize();scrollElem.style.display="block";refreshThumbPosition();refreshThumbSize()}}function refreshScrollBarAfterScroll(){refreshScrollZone();refreshThumbPosition()}function setThumbEventListeners(thumb){var _helperOverlay=null;var _downPos={left:0,top:0};var _storedScrollLeft=0;function _docMouseMoveListener(event){if(params.type=="horizontal"){var delta=event.clientX-_downPos.left;elem.scrollLeft=_storedScrollLeft+delta;refreshScrollBarAfterScroll()}}function _docMouseUpListener(){thumb.removeAttribute("down");document.removeEventListener("mousemove",_docMouseMoveListener);document.removeEventListener("mouseup",_docMouseUpListener);_helperOverlay.parentNode.removeChild(_helperOverlay);nowIsScrolling=false}thumb.addEventListener("mousedown",function(event){_storedScrollLeft=elem.scrollLeft;_downPos.left=event.clientX;_downPos.top=event.clientY;thumb.setAttribute("down",1);document.addEventListener("mousemove",_docMouseMoveListener,false);document.addEventListener("mouseup",_docMouseUpListener,false);_helperOverlay=document.createElement("div");_helperOverlay.className="controlScrollHelperOverlay";document.body.appendChild(_helperOverlay);nowIsScrolling=true},false)}function buildScroll(){var parentEl=elem.parentNode;var oldScroll=parentEl.querySelector(".controlScroll");if(oldScroll){parentEl.removeChild(oldScroll)}scrollElem=fvdSpeedDial.Templates.clone("prototype_controlScroll");scrollElem.removeAttribute("id");scrollElem.className+=" scrollType_"+params.type+" scrollPosition_"+params.position;var thumb=scrollElem.querySelector(".scrollThumb");setThumbEventListeners(thumb);document.addEventListener("mousewheel",function(event){if(fvdSpeedDial.Utils.isChildOf(event.target,elem)){if(params.type=="horizontal"){var v=event.wheelDelta>0?-1:1;v*=params.wheelScrollSpeed;elem.scrollLeft=prepareScrollValue(elem.scrollLeft+v);refreshScrollBarAfterScroll()}event.stopPropagation();event.preventDefault()}},false);parentEl.appendChild(scrollElem);refreshScrollBarVisibility();window.addEventListener("resize",l_windowResize,false);fvdSpeedDial.SpeedDial.onBuildCompleted.addListener(l_sdBuildCompleted)}buildScroll()};var instances=[];this.setToElem=function(elem,params){var inst=new ScrollInstance(elem,params);instances.push(inst);return inst}};var Shortcut={all_shortcuts:{},add:function(shortcut_combination,callback,opt){var default_options={type:"keydown",propagate:false,disable_in_input:true,target:document,keycode:false};if(!opt)opt=default_options;else{for(var dfo in default_options){if(typeof opt[dfo]=="undefined")opt[dfo]=default_options[dfo]}}var ele=opt.target;if(typeof opt.target=="string")ele=document.getElementById(opt.target);var ths=this;shortcut_combination=shortcut_combination.toLowerCase();var func=function(e){e=e||window.event;if(opt["disable_in_input"]){var element;if(e.target)element=e.target;else if(e.srcElement)element=e.srcElement;if(element.nodeType==3)element=element.parentNode;if(element.tagName=="INPUT"||element.tagName=="TEXTAREA"||element.tagName=="BUTTON"){return}}if(e.keyCode)code=e.keyCode;else if(e.which)code=e.which;var character=String.fromCharCode(code).toLowerCase();if(code==188)character=",";if(code==190)character=".";var keys=shortcut_combination.split("+");var kp=0;var shift_nums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};var special_keys={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123};var modifiers={shift:{wanted:false,pressed:false},ctrl:{wanted:false,pressed:false},alt:{wanted:false,pressed:false},meta:{wanted:false,pressed:false}};if(e.ctrlKey)modifiers.ctrl.pressed=true;if(e.shiftKey)modifiers.shift.pressed=true;if(e.altKey)modifiers.alt.pressed=true;if(e.metaKey)modifiers.meta.pressed=true;for(var i=0;k=keys[i],i<keys.length;i++){if(k=="ctrl"||k=="control"){kp++;modifiers.ctrl.wanted=true}else if(k=="shift"){kp++;modifiers.shift.wanted=true}else if(k=="alt"){kp++;modifiers.alt.wanted=true}else if(k=="meta"){kp++;modifiers.meta.wanted=true}else if(k.length>1){if(special_keys[k]==code)kp++}else if(opt["keycode"]){if(opt["keycode"]==code)kp++}else{if(character==k)kp++;else{if(shift_nums[character]&&e.shiftKey){character=shift_nums[character];if(character==k)kp++}}}}if(kp==keys.length&&modifiers.ctrl.pressed==modifiers.ctrl.wanted&&modifiers.shift.pressed==modifiers.shift.wanted&&modifiers.alt.pressed==modifiers.alt.wanted&&modifiers.meta.pressed==modifiers.meta.wanted){if(callback(e)===false){e.cancelBubble=true;e.returnValue=false;if(e.stopPropagation){e.stopPropagation();e.preventDefault()}return false}}};this.all_shortcuts[shortcut_combination]={callback:func,target:ele,event:opt["type"]};if(ele.addEventListener)ele.addEventListener(opt["type"],func,false);else if(ele.attachEvent)ele.attachEvent("on"+opt["type"],func);else ele["on"+opt["type"]]=func},remove:function(shortcut_combination){shortcut_combination=shortcut_combination.toLowerCase();var binding=this.all_shortcuts[shortcut_combination];delete this.all_shortcuts[shortcut_combination];if(!binding)return;var type=binding["event"];var ele=binding["target"];var callback=binding["callback"];if(ele.removeEventListener){ele.removeEventListener(type,callback,false)}else if(ele.detachEvent){ele.detachEvent("on"+type,callback)}else{ele["on"+type]=false}}};window.addEventListener("load",function(){var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-38382010-1"]);_gaq.push(["_trackPageview"]);(function(){var ga=document.createElement("script");ga.type="text/javascript";ga.async=true;ga.src="https://ssl.google-analytics.com/ga.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga,s)})()},false);(function(){var AD=function(label){if(_b(fvdSpeedDial.Prefs.get("ad_dontDisplay_"+label))){return}var containerId="ad_"+label+"Message";var interval=null;document.querySelector("#"+containerId+" .ad_dontShow").addEventListener("click",function(e){fvdSpeedDial.Prefs.set("ad_dontDisplay_"+label,e.target.checked)},false);function setRandomShowInFuture(now){now=now||(new Date).getTime();var randomMinutesToShow=fvdSpeedDial.Utils.getRandomInt(60,1e3);fvdSpeedDial.Prefs.set("ad_lastShow_"+label,now+randomMinutesToShow*60*1e3)}function show(){var lastShowTime=parseInt(fvdSpeedDial.Prefs.get("ad_lastShow_"+label));var now=(new Date).getTime();if(_b(fvdSpeedDial.Prefs.get("ad_dontDisplay_"+label))){return}if(!lastShowTime){setRandomShowInFuture();return}if(now-lastShowTime>=fvdSpeedDial.Config.DISPLAY_AD_EVERY){fvdSpeedDial.SpeedDialMisc.showOptions(containerId,document.getElementById("searchBar"),null,null,function(){setRandomShowInFuture(lastShowTime)},function(){fvdSpeedDial.Prefs.set("ad_lastShow_"+label,now)})}}interval=setInterval(show,1e3)};fvdSpeedDial.newTabAD=new function(){var ads=[];document.addEventListener("DOMContentLoaded",function(){var popups=document.getElementsByClassName("sdAdPopup");for(var i=0;i!=popups.length;i++){var tmp=popups[i].getAttribute("id").match(/^ad_(.+)Message$/i);ads.push(new AD(tmp[1]))}},false)}})();(function(){function isEbayUrl(url){var host=fvdSpeedDial.Utils.parseUrl(url,"host");if(!host){return false}if(/(?:^|\.)ebay\.[^\.]+$/.test(host)){return true}return false}fvdSpeedDial.SpeedDial.onBuildCompleted.addListener(function(){var dials=document.querySelectorAll("#cellsContainer .newtabCell");dials=[].slice.call(dials);dials.forEach(function(dialElem){var url=dialElem.getAttribute("data-url");if(!url){return}if(isEbayUrl(url)){if(!dialElem.querySelector(".dial-search-magnifier")){dialElem.classList.add("with-ebay-search");var magnifier=document.createElement("button");magnifier.className="btn-no-style dial-search-magnifier";dialElem.appendChild(magnifier);magnifier.setAttribute("title",_("newtab_search_on_ebay"));magnifier.addEventListener("mousedown",function(event){event.stopPropagation();event.preventDefault()});magnifier.addEventListener("click",function(event){event.stopPropagation();event.preventDefault();var installTime=parseInt(fvdSpeedDial.Prefs.get("sd.install_time"));var url="http://fvdmedia.com/addon_search/ebay_new.php?q={query}";fvdSpeedDial.SearchOverlay.show("ebay",{url:url})})}}else{}})})})();(function(){function isAmazonUrl(url){var host=fvdSpeedDial.Utils.parseUrl(url,"host");if(!host){return false}if(/(?:^|\.)amazon\.([^\.]+|co\.uk)$/.test(host)){return true}return false}fvdSpeedDial.SpeedDial.onBuildCompleted.addListener(function(){var installTime=parseInt(fvdSpeedDial.Prefs.get("sd.install_time"));var dials=document.querySelectorAll("#cellsContainer .newtabCell");dials=[].slice.call(dials);dials.forEach(function(dialElem){var url=dialElem.getAttribute("data-url");if(!url){return}if(isAmazonUrl(url)){if(!dialElem.querySelector(".dial-search-magnifier")){dialElem.classList.add("with-amazon-search");var magnifier=document.createElement("button");magnifier.className="btn-no-style dial-search-magnifier";dialElem.appendChild(magnifier);magnifier.setAttribute("title",_("newtab_search_on_amazon"));magnifier.addEventListener("mousedown",function(event){event.stopPropagation();event.preventDefault();

});magnifier.addEventListener("click",function(event){event.stopPropagation();event.preventDefault();fvdSpeedDial.SearchOverlay.show("amazon",{url:"http://fvdmedia.com/addon_search/amazon.php?q={query}"})})}}else{}})})})();(function(){function _setNoNeedToOffer(){fvdSpeedDial.Prefs.set("sd.need_to_offer_parallax",false)}document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){if(!_b(fvdSpeedDial.Prefs.get("sd.need_to_offer_parallax"))){return}if(fvdSpeedDial.Prefs.get("sd.background_url_type")==="parallax"){return _setNoNeedToOffer()}if(fvdSpeedDial.Prefs.get("sd.background_url_type")==="noimage"){return}fvdSpeedDial.Templates.get("parallax-offer",{fragment:true},function(err,el){if(err){return console.error(err)}if(document.querySelector('.bigInfoDialogOverlay[appear="1"]')){return}function _close(){_setNoNeedToOffer();parallaxOverlay.removeAttribute("appear");setTimeout(function(){parallaxOverlay.parentNode.removeChild(parallaxOverlay)},300)}fvdSpeedDial.Localizer.localizeElem(el);document.body.appendChild(el);var parallaxOverlay=document.querySelector("#parallaxOfferOverlay");parallaxOverlay.querySelector(".close").addEventListener("click",_close,false);parallaxOverlay.querySelector(".btnClose").addEventListener("click",_close,false);parallaxOverlay.querySelector(".btnParallax").addEventListener("click",function(){fvdSpeedDial.Prefs.set("sd.background_url_type","parallax");_close()},false);setTimeout(function(){parallaxOverlay.setAttribute("appear",1)},0)})},1e3)},false)})();(function(){var queryInput;var searchInputParent;var resetButton;var container;var activeSearchRequest=null;const CORRECT_CONTAINER_WIDTH_INCREASE=11;function SearchRequest(query,cb){var cancelled=false;this.cancel=function(){cancelled=true};fvdSpeedDial.Storage.searchDials(query,function(err,dials){if(cancelled){return}cb(err,dials)})}fvdSpeedDial.DialSearch={resetHelperAttributes:function(){document.body.removeAttribute("dial-search-show-results");document.body.removeAttribute("dial-search-not-found");queryInput.removeAttribute("user-clicked")},doSearch:function(query){var self=this;if(activeSearchRequest){try{activeSearchRequest.cancel()}catch(ex){}activeSearchRequest=null}query=query||"";query=query.trim();if(query.length===0){this.resetHelperAttributes();fvdSpeedDial.SpeedDial.rebuildCells({isSearch:true});return}if(query.length<fvdSpeedDial.Config.MIN_DIALS_SEARCH_QUERY_LENGTH){this.resetHelperAttributes();return}activeSearchRequest=new SearchRequest(query,function(err,dials){self.resetHelperAttributes();if(!err){document.body.setAttribute("dial-search-show-results",1);if(dials.length===0){self.setNotFound()}else{fvdSpeedDial.SpeedDial.rebuildCells({dials:dials,isSearch:true})}}})},setNotFound:function(){var query=queryInput.value;document.body.setAttribute("dial-search-not-found",1);var message=_("newtab_dials_search_no_match_query");var messageContainer=document.querySelector("#dial-search-container .dial-search-no-match-message");messageContainer.innerHTML=message;messageContainer.querySelector("strong").textContent=query},isInNotFoundState:function(){return document.body.hasAttribute("dial-search-not-found")},doWebSearch:function(query){query=query||queryInput.value;query=query.trim();if(!query.length){return}fvdSpeedDial.SpeedDialMisc.doSearch(query)},show:function(){searchInputParent.setAttribute("expanded",1)},hide:function(){var val=queryInput.value.trim();if(!val&&!queryInput.hasAttribute("user-clicked")){queryInput.blur()}if(document.activeElement===queryInput||val){return}searchInputParent.setAttribute("expanded",0);queryInput.removeAttribute("user-clicked");this.refreshResetButtonState()},reset:function(){this.resetHelperAttributes();queryInput.value="";queryInput.blur();this.refreshResetButtonState()},empty:function(){queryInput.value="";this.doSearch();this.refreshResetButtonState()},refreshResetButtonState:function(){var text=queryInput.value;if(text.length){searchInputParent.setAttribute("with-text",1)}else{searchInputParent.removeAttribute("with-text")}},refreshEnableState:function(){if(_b(fvdSpeedDial.Prefs.get("sd.enable_dials_search"))){document.body.setAttribute("dialsearchenabled",1)}else{document.body.removeAttribute("dialsearchenabled")}}};document.addEventListener("DOMContentLoaded",function(){container=document.getElementById("dial-search-container");queryInput=document.getElementById("dial-search-query");searchInputParent=document.querySelector("#dial-search-container .dial-search-input");resetButton=document.querySelector("#dial-search-container .dial-search-reset-icon");queryInput.addEventListener("input",function(){var q=queryInput.value;fvdSpeedDial.DialSearch.doSearch(q);fvdSpeedDial.DialSearch.refreshResetButtonState()},false);searchInputParent.addEventListener("mouseover",function(){fvdSpeedDial.DialSearch.show();queryInput.focus()},false);searchInputParent.addEventListener("mouseout",function(){fvdSpeedDial.DialSearch.hide()},false);queryInput.addEventListener("blur",function(){fvdSpeedDial.DialSearch.hide()},false);queryInput.addEventListener("keydown",function(event){if(event.keyCode===27){fvdSpeedDial.DialSearch.reset();fvdSpeedDial.DialSearch.doSearch()}if(event.keyCode===13){if(fvdSpeedDial.DialSearch.isInNotFoundState()){fvdSpeedDial.DialSearch.doWebSearch()}}},false);queryInput.addEventListener("mousedown",function(){queryInput.setAttribute("user-clicked",1)},false);resetButton.addEventListener("mousedown",function(event){fvdSpeedDial.DialSearch.empty();event.preventDefault()},false);document.querySelector(".dial-search-not-found-block a").addEventListener("click",function(event){fvdSpeedDial.DialSearch.doWebSearch();event.preventDefault()},false);document.querySelector("#dial-search-container .dial-search-icon").addEventListener("mousedown",function(event){queryInput.focus();event.preventDefault()},false);fvdSpeedDial.SpeedDial.onBuildCompleted.addListener(function(params){if(!params||!params.isSearch){fvdSpeedDial.DialSearch.reset();fvdSpeedDial.DialSearch.hide()}});Broadcaster.onMessage.addListener(function(msg){if(msg.action=="pref:changed"){if(msg.name==="sd.enable_dials_search"){fvdSpeedDial.DialSearch.refreshEnableState()}}});fvdSpeedDial.DialSearch.refreshEnableState()},false)})();(function(){function isAmazonUrl(url){var host=fvdSpeedDial.Utils.parseUrl(url,"host");if(!host){return false}if(/(?:^|\.)aliexpress\.([^\.]+|co\.uk)$/.test(host)){return true}return false}fvdSpeedDial.SpeedDial.onBuildCompleted.addListener(function(){if(!fvdSpeedDial.Config.MOD_SEARCH_ALIEXPRESS){return}var installTime=parseInt(fvdSpeedDial.Prefs.get("sd.install_time"));var dials=document.querySelectorAll("#cellsContainer .newtabCell");dials=[].slice.call(dials);dials.forEach(function(dialElem){var url=dialElem.getAttribute("data-url");if(!url){return}if(isAmazonUrl(url)){if(!dialElem.querySelector(".dial-search-magnifier")){dialElem.classList.add("with-amazon-search");var magnifier=document.createElement("button");magnifier.className="btn-no-style dial-search-magnifier";dialElem.appendChild(magnifier);magnifier.setAttribute("title",_("newtab_search_on_aliexpress"));magnifier.addEventListener("mousedown",function(event){event.stopPropagation();event.preventDefault()});magnifier.addEventListener("click",function(event){event.stopPropagation();event.preventDefault();fvdSpeedDial.SearchOverlay.show("aliexpress",{url:"http://fvdmedia.com/addon_search/aliexpress.php?q={query}"})})}}else{}})})})();(function(){var timeout=null;function elem(){return document.querySelector("#lightCollapsedMessage")}function reposition(){var msg=elem();if(msg.hasAttribute("top")){return}var windowWidth=document.documentElement.clientWidth;var windowHeight=document.documentElement.clientHeight;var elemWidth=msg.offsetWidth;var elemHeight=msg.offsetHeight;var pos={left:windowWidth/2-elemWidth/2,top:windowHeight/2-elemHeight/2};msg.style.left=pos.left+"px";msg.style.top=pos.top+"px"}fvdSpeedDial.lightCollapsedMessage={show:function(){if(!_b(fvdSpeedDial.Prefs.get("sd.light_collapsed_message_show"))){return}var self=this;var msg=elem();msg.style.display="block";reposition();setTimeout(function(){msg.setAttribute("appear",1);try{clearTimeout(timeout)}catch(ex){}timeout=setTimeout(function(){self.hideAnimate()},3e3)},100)},hide:function(){var msg=elem();if(msg.style.display==="none"){return}msg.style.display="none";msg.removeAttribute("appear");msg.removeAttribute("top")},hideAnimate:function(){var self=this;elem().removeAttribute("appear");setTimeout(function(){self.hide()},300)},doNotShowMore:function(){fvdSpeedDial.Prefs.set("sd.light_collapsed_message_show",false)}};window.addEventListener("resize",function(){if(elem().style.display==="block"){reposition()}},false);document.addEventListener("DOMContentLoaded",function(){var closeButton=elem().querySelector(".close-button");closeButton.addEventListener("click",function(){fvdSpeedDial.lightCollapsedMessage.doNotShowMore();fvdSpeedDial.lightCollapsedMessage.hideAnimate()},false)},false)})();(function(){const DEFAULT_CSS={border:"none"};const CONTAINER_STYLES=["top","left","right","bottom"];var RemoteAD=function(){var self=this;this.hideAD=function(){var overlay=document.querySelector(".remoteADContainerOverlay");if(overlay){overlay.querySelector(".remoteADContainer").style.opacity=0;setTimeout(function(){overlay.parentNode.removeChild(overlay)},500)}};function checkADShow(){chrome.runtime.getBackgroundPage(function(bg){bg.RemoteAD.getADToShow({nohosts:true},function(ad){if(document.querySelector(".dialog-overlay")||document.querySelector('.popupOptions[active="1"]')){return}if(ad){Broadcaster.onMessage.addListener(function(msg){if(msg.a=="remoteAD:close"&&msg.id==ad.id){self.hideAD()}});var adContainer=bg.document.getElementById("prototype_remoteADContainer").cloneNode(true);adContainer.setAttribute("active",1);var iframe=adContainer.querySelector("iframe");for(var k in DEFAULT_CSS){if(!(k in ad.css)){ad.css[k]=DEFAULT_CSS[k]}}if(ad.css){var containerStyles=[];var frameStyles=[];for(var k in ad.css){if(CONTAINER_STYLES.indexOf(k)!=-1){containerStyles.push(k+":"+ad.css[k])}else{frameStyles.push(k+":"+ad.css[k])}}adContainer.setAttribute("style",containerStyles.join(";"));iframe.setAttribute("style",frameStyles.join(";"))}iframe.setAttribute("src",ad.frameUrl);var overlay=document.createElement("div");overlay.className="remoteADContainerOverlay";overlay.appendChild(adContainer);overlay.addEventListener("click",function(){self.hideAD()},false);adContainer.addEventListener("click",function(event){event.stopPropagation()},false);adContainer.style.opacity=0;setTimeout(function(){adContainer.style.opacity=1},0);document.body.appendChild(overlay)}})})}window.addEventListener("load",function(){setTimeout(function(){checkADShow()},3e3)},false)};fvdSpeedDial.RemoteAD=new RemoteAD})();var Aes={};Aes.cipher=function(input,w){var Nb=4;var Nr=w.length/Nb-1;var state=[[],[],[],[]];for(var i=0;i<4*Nb;i++)state[i%4][Math.floor(i/4)]=input[i];state=Aes.addRoundKey(state,w,0,Nb);for(var round=1;round<Nr;round++){state=Aes.subBytes(state,Nb);state=Aes.shiftRows(state,Nb);state=Aes.mixColumns(state,Nb);state=Aes.addRoundKey(state,w,round,Nb)}state=Aes.subBytes(state,Nb);state=Aes.shiftRows(state,Nb);state=Aes.addRoundKey(state,w,Nr,Nb);var output=new Array(4*Nb);for(var i=0;i<4*Nb;i++)output[i]=state[i%4][Math.floor(i/4)];return output};Aes.keyExpansion=function(key){var Nb=4;var Nk=key.length/4;var Nr=Nk+6;var w=new Array(Nb*(Nr+1));var temp=new Array(4);for(var i=0;i<Nk;i++){var r=[key[4*i],key[4*i+1],key[4*i+2],key[4*i+3]];w[i]=r}for(var i=Nk;i<Nb*(Nr+1);i++){w[i]=new Array(4);for(var t=0;t<4;t++)temp[t]=w[i-1][t];if(i%Nk==0){temp=Aes.subWord(Aes.rotWord(temp));for(var t=0;t<4;t++)temp[t]^=Aes.rCon[i/Nk][t]}else if(Nk>6&&i%Nk==4){temp=Aes.subWord(temp)}for(var t=0;t<4;t++)w[i][t]=w[i-Nk][t]^temp[t]}return w};Aes.subBytes=function(s,Nb){for(var r=0;r<4;r++){for(var c=0;c<Nb;c++)s[r][c]=Aes.sBox[s[r][c]]}return s};Aes.shiftRows=function(s,Nb){var t=new Array(4);for(var r=1;r<4;r++){for(var c=0;c<4;c++)t[c]=s[r][(c+r)%Nb];for(var c=0;c<4;c++)s[r][c]=t[c]}return s};Aes.mixColumns=function(s,Nb){for(var c=0;c<4;c++){var a=new Array(4);var b=new Array(4);for(var i=0;i<4;i++){a[i]=s[i][c];b[i]=s[i][c]&128?s[i][c]<<1^283:s[i][c]<<1}s[0][c]=b[0]^a[1]^b[1]^a[2]^a[3];s[1][c]=a[0]^b[1]^a[2]^b[2]^a[3];s[2][c]=a[0]^a[1]^b[2]^a[3]^b[3];s[3][c]=a[0]^b[0]^a[1]^a[2]^b[3]}return s};Aes.addRoundKey=function(state,w,rnd,Nb){for(var r=0;r<4;r++){for(var c=0;c<Nb;c++)state[r][c]^=w[rnd*4+c][r]}return state};Aes.subWord=function(w){for(var i=0;i<4;i++)w[i]=Aes.sBox[w[i]];return w};Aes.rotWord=function(w){var tmp=w[0];for(var i=0;i<3;i++)w[i]=w[i+1];w[3]=tmp;return w};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(plaintext,password,nBits){var blockSize=16;if(!(nBits==128||nBits==192||nBits==256))return"";plaintext=Utf8.encode(plaintext);password=Utf8.encode(password);var nBytes=nBits/8;var pwBytes=new Array(nBytes);for(var i=0;i<nBytes;i++){pwBytes[i]=isNaN(password.charCodeAt(i))?0:password.charCodeAt(i)}var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Array(blockSize);var nonce=(new Date).getTime();var nonceMs=nonce%1e3;var nonceSec=Math.floor(nonce/1e3);var nonceRnd=Math.floor(Math.random()*65535);for(var i=0;i<2;i++)counterBlock[i]=nonceMs>>>i*8&255;for(var i=0;i<2;i++)counterBlock[i+2]=nonceRnd>>>i*8&255;for(var i=0;i<4;i++)counterBlock[i+4]=nonceSec>>>i*8&255;var ctrTxt="";for(var i=0;i<8;i++)ctrTxt+=String.fromCharCode(counterBlock[i]);var keySchedule=Aes.keyExpansion(key);var blockCount=Math.ceil(plaintext.length/blockSize);var ciphertxt=new Array(blockCount);for(var b=0;b<blockCount;b++){for(var c=0;c<4;c++)counterBlock[15-c]=b>>>c*8&255;for(var c=0;c<4;c++)counterBlock[15-c-4]=b/4294967296>>>c*8;var cipherCntr=Aes.cipher(counterBlock,keySchedule);var blockLength=b<blockCount-1?blockSize:(plaintext.length-1)%blockSize+1;var cipherChar=new Array(blockLength);for(var i=0;i<blockLength;i++){cipherChar[i]=cipherCntr[i]^plaintext.charCodeAt(b*blockSize+i);cipherChar[i]=String.fromCharCode(cipherChar[i])}ciphertxt[b]=cipherChar.join("")}var ciphertext=ctrTxt+ciphertxt.join("");ciphertext=Base64.encode(ciphertext);return ciphertext};Aes.Ctr.decrypt=function(ciphertext,password,nBits){var blockSize=16;if(!(nBits==128||nBits==192||nBits==256))return"";ciphertext=Base64.decode(ciphertext);password=Utf8.encode(password);var nBytes=nBits/8;var pwBytes=new Array(nBytes);for(var i=0;i<nBytes;i++){pwBytes[i]=isNaN(password.charCodeAt(i))?0:password.charCodeAt(i)}var key=Aes.cipher(pwBytes,Aes.keyExpansion(pwBytes));key=key.concat(key.slice(0,nBytes-16));var counterBlock=new Array(8);ctrTxt=ciphertext.slice(0,8);for(var i=0;i<8;i++)counterBlock[i]=ctrTxt.charCodeAt(i);var keySchedule=Aes.keyExpansion(key);var nBlocks=Math.ceil((ciphertext.length-8)/blockSize);var ct=new Array(nBlocks);for(var b=0;b<nBlocks;b++)ct[b]=ciphertext.slice(8+b*blockSize,8+b*blockSize+blockSize);ciphertext=ct;var plaintxt=new Array(ciphertext.length);for(var b=0;b<nBlocks;b++){for(var c=0;c<4;c++)counterBlock[15-c]=b>>>c*8&255;for(var c=0;c<4;c++)counterBlock[15-c-4]=(b+1)/4294967296-1>>>c*8&255;var cipherCntr=Aes.cipher(counterBlock,keySchedule);var plaintxtByte=new Array(ciphertext[b].length);for(var i=0;i<ciphertext[b].length;i++){plaintxtByte[i]=cipherCntr[i]^ciphertext[b].charCodeAt(i);plaintxtByte[i]=String.fromCharCode(plaintxtByte[i])}plaintxt[b]=plaintxtByte.join("")}var plaintext=plaintxt.join("");plaintext=Utf8.decode(plaintext);return plaintext};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(str,utf8encode){utf8encode=typeof utf8encode=="undefined"?false:utf8encode;var o1,o2,o3,bits,h1,h2,h3,h4,e=[],pad="",c,plain,coded;var b64=Base64.code;plain=utf8encode?str.encodeUTF8():str;c=plain.length%3;if(c>0){while(c++<3){pad+="=";plain+="\x00"}}for(c=0;c<plain.length;c+=3){o1=plain.charCodeAt(c);o2=plain.charCodeAt(c+1);o3=plain.charCodeAt(c+2);bits=o1<<16|o2<<8|o3;h1=bits>>18&63;h2=bits>>12&63;h3=bits>>6&63;h4=bits&63;e[c/3]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}coded=e.join("");coded=coded.slice(0,coded.length-pad.length)+pad;return coded};Base64.decode=function(str,utf8decode){utf8decode=typeof utf8decode=="undefined"?false:utf8decode;var o1,o2,o3,h1,h2,h3,h4,bits,d=[],plain,coded;var b64=Base64.code;coded=utf8decode?str.decodeUTF8():str;for(var c=0;c<coded.length;c+=4){h1=b64.indexOf(coded.charAt(c));h2=b64.indexOf(coded.charAt(c+1));h3=b64.indexOf(coded.charAt(c+2));h4=b64.indexOf(coded.charAt(c+3));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>>16&255;o2=bits>>>8&255;o3=bits&255;d[c/4]=String.fromCharCode(o1,o2,o3);if(h4==64)d[c/4]=String.fromCharCode(o1,o2);if(h3==64)d[c/4]=String.fromCharCode(o1)}plain=d.join("");return utf8decode?plain.decodeUTF8():plain};var Utf8={};Utf8.encode=function(strUni){var strUtf=strUni.replace(/[\u0080-\u07ff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(192|cc>>6,128|cc&63)});strUtf=strUtf.replace(/[\u0800-\uffff]/g,function(c){var cc=c.charCodeAt(0);return String.fromCharCode(224|cc>>12,128|cc>>6&63,128|cc&63)});return strUtf};Utf8.decode=function(strUtf){var strUni=strUtf.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&15)<<12|(c.charCodeAt(1)&63)<<6|c.charCodeAt(2)&63;return String.fromCharCode(cc)});strUni=strUni.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(c){var cc=(c.charCodeAt(0)&31)<<6|c.charCodeAt(1)&63;return String.fromCharCode(cc)});return strUni};(function($){var SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;function startAnimateSpeechProgress($el){var properties={"border-color":"#F58F6F"};$el.pulse(properties,{pulses:-1,duration:900})}function stopAnimateSpeechProgress($el){$el.pulse("destroy")}$.fn.speechify=function(options){if(!SpeechRecognition){return}options=options||{};$.extend(options,{lang:"en-US"});var recognizer=new SpeechRecognition;var $input=$(this);var $container=$("<div>").addClass("speechify-container");var $icon=$("<div>").addClass("speechify-icon");$container.insertBefore($input);$container.append($input);$container.append($icon);if(options.build){options.build({icon:$icon})}var isSpeaking=false;recognizer.continuous=false;recognizer.lang=options.lang;recognizer.maxAlternatives=1;$icon.click(function(){if(isSpeaking){stopSpeaking()}else{startSpeaking()}});function startSpeaking(){if(isSpeaking){return}isSpeaking=true;if(options.onSpeakStart){options.onSpeakStart()}recognizer.start();$input.val("");$container.addClass("speaking");startAnimateSpeechProgress()}function stopSpeaking(){if(!isSpeaking){return}isSpeaking=false;recognizer.stop();$container.removeClass("speaking");stopAnimateSpeechProgress()}function stopAnimateSpeechProgress(){console.log("start animate")}function startAnimateSpeechProgress(){console.log("stop animate")}recognizer.onresult=function(event){$input.val("");for(var i=event.resultIndex;i<event.results.length;i++){var result;if(event.results[i].isFinal){result=event.results[i][0].transcript;if(result){$input.val(result);if(options.onResult){options.onResult(result)}else{var $form=$input.parents("form");if($form.length){$form.submit()}}stopSpeaking();break}else{$input.val("")}}else{result=$input.val()+event.results[i][0].transcript;if(result){$input.val(result)}}}};recognizer.onerror=stopSpeaking;recognizer.onend=stopSpeaking}})(jQuery);(function(){document.addEventListener("DOMContentLoaded",function(){document.body.addEventListener("blur",function(event){var target=event.target;if(target.matches("input[type=number][min]")){var min=parseInt(target.getAttribute("min"));var val=parseInt(target.value);if(val<min){target.value=min}}},true)},false)})();(function(){var el=document.createElement("div");var xhr=new XMLHttpRequest;xhr.open("GET",chrome.runtime.getURL("/templates.html"),false);xhr.send(null);el.innerHTML=xhr.responseText;fvdSpeedDial.Localizer.localizeElem(el);fvdSpeedDial.Templates={getHTML:function(id){return el.querySelector("#"+id).innerHTML},clone:function(id){return el.querySelector("#"+id).cloneNode(true)},get:function(templateName,options,cb){if(typeof options==="function"){cb=options;options={}}options=options||{};var xhr=new XMLHttpRequest;xhr.open("GET",chrome.runtime.getURL("/templates/"+templateName+".html"));xhr.onload=function(){var res=xhr.responseText;if(options.fragment){var tmp=document.createElement("template");tmp.innerHTML=res;res=tmp.content}cb(null,res)};xhr.onerror=function(err){cb(err)};xhr.send(null)},loadStyleSheet:function(location,cb){cb=cb||function(){};var link=document.createElement("link");link.setAttribute("href",location);link.setAttribute("rel","stylesheet");link.addEventListener("load",function(){cb()},false);document.head.appendChild(link)}}})();